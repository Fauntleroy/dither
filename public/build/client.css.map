{
  "version": 3,
  "file": "client.css",
  "sources": [
    "../../[id].svelte",
    "../../nav.svelte",
    "../../new-message.svelte",
    "../../message.svelte",
    "../../stylized-webcam-feed.svelte",
    "../../filmstrip.svelte"
  ],
  "sourcesContent": [
    "<script>\n  import { onMount } from 'svelte';\n  import { quintOut } from 'svelte/easing';\n  import { crossfade } from 'svelte/transition';\n  import { flip } from 'svelte/animate';\n  \n  import { firestore, firestoreDb } from '../../firebase.js';\n\n  import Message from '../../components/message.svelte';\n  import NewMessage from '../../components/new-message.svelte';\n\n  export let currentRoute;\n  const { namedParams } = currentRoute;\n  const { id } = namedParams;\n\n  let messages = [];\n\n  const [send, receive] = crossfade({\n\t\tduration: d => Math.sqrt(d * 100),\n\n\t\tfallback(node, params) {\n\t\t\tconst style = getComputedStyle(node);\n\t\t\tconst transform = style.transform === 'none' ? '' : style.transform;\n\n\t\t\treturn {\n\t\t\t\tduration: 125,\n\t\t\t\teasing: quintOut,\n\t\t\t\tcss: t => `\n\t\t\t\t\ttransform: ${transform} scale(${t});\n\t\t\t\t\topacity: ${t}\n\t\t\t\t`\n\t\t\t};\n\t\t}\n\t});\n\n\tonMount(async () => {\n    firestoreDb.collection(`rooms/${id}/messages`)\n      .limit(10)\n      .orderBy('createdAt', 'desc')\n      .onSnapshot(function(collection) {\n        const docsData = collection.docs.map((doc) => {\n          return {\n            id: doc.id,\n            ...doc.data()\n          }\n        });\n        messages = docsData;\n      });\n  });\n\n\tasync function handleCreateMessage (event) {\n    const { text, imageDataURL } = event.detail;\n\t\tconst newMessage = await firestoreDb.collection(`rooms/${id}/messages`).add({\n      createdAt: firestore.FieldValue.serverTimestamp(),\n      imageBlob: imageDataURL,\n      text\n    });\n\t}\n</script>\n\n<style>\n  .content {\n    width: 100%;\n  }\n</style>\n\n<svelte:head>\n\t<title>Room {id}</title>\n</svelte:head>\n\n<div class=\"content\">\n  <NewMessage on:createMessage={handleCreateMessage} />\n\n  {#each messages as { id, text, imageBlob }, i (id)}\n    <div animate:flip=\"{{duration: 200}}\" in:receive=\"{{key: id}}\" out:send=\"{{key: id}}\">\n    <Message text={text} imageBlob={imageBlob} />\n    </div>\n  {/each}\n</div>",
    "<script>\n\n</script>\n\n<style>\n\t.nav {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tpadding: 0 10px;\n\t\tz-index: 5;\n\t\tbackground: var(--black);\n\t\tfont-size: 10px;\n\t}\n\n\t.app-name {\n\t\ttext-transform: uppercase;\n\t}\n\n\t.alpha-tag {\n\t\tfont-style: italic;\n\t\ttext-transform: none;\n\t}\n</style>\n\n<nav class=\"nav\">\n\t<a href=\"/\" class=\"app-name\">Dither <span class=\"alpha-tag\">alpha</span></a>\n</nav>\n",
    "<script>\n  import { createEventDispatcher } from 'svelte';\n\n  import { generateImage } from '../utils/filmstrip.js';\n\n  import StylizedWebcamFeed from './stylized-webcam-feed.svelte';\n  import Filmstrip from './filmstrip.svelte';\n\n  const dispatch = createEventDispatcher();\n  let webcamFeed;\n  let inputMessage = '';\n  let recording = false;\n\n  async function handleSubmit () {\n    recording = true;\n    const imageDataURL = await generateImage(webcamFeed.canvasElement);\n    recording = false;\n\n    dispatch('createMessage', {\n      text: inputMessage,\n      imageDataURL\n    });\n\n    inputMessage = '';\n  }\n\n  function handleInputKeydown (event) {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      handleSubmit();\n    }\n  }\n</script>\n\n<style>\n  .new-message {\n    margin: 25px 10px 35px 10px;\n  }\n\n  .form {\n    display: flex;\n    align-items: stretch;\n    margin-bottom: 15px;\n    justify-content: center;\n  }\n\n  .fake-input {\n    position: relative;\n    display: flex;\n    background: var(--white);\n    color: var(--black);\n    border-top-right-radius: 5px;\n    border-bottom-right-radius: 5px;\n    overflow: hidden;\n    border: var(--white) 1px solid;\n    transition: transform 200ms;\n  }\n\n  .input {\n    display: block;\n    border: none;\n    margin: 0;\n    border: 2px var(--white) solid;\n    padding: 10px 50px 10px 15px;\n    font-size: inherit;\n    font-style: italic;\n    max-width: 100%;\n  }\n\n  .fake-input:focus-within {\n    transform: scale(1.05);\n  }\n\n  .submit {\n    position: absolute;\n    top: 50%;\n    right: 0;\n    transform: translateY(-50%);\n    padding: 10px;\n    margin: 0;\n    color: var(--black);\n    background: none;\n    border: none;\n    font-size: 40px;\n    line-height: 40px;\n  }\n\n  .recording-booth {\n    position: relative;\n    border: var(--white) 1px solid;\n    border-top-left-radius: 5px;\n    border-bottom-left-radius: 5px;\n    overflow: hidden;\n    flex-shrink: 0;\n  }\n\n  .recording-indicator {\n    position: absolute;\n    bottom: 10px;\n    right: 10px;\n    display: block;\n    border-radius: 50%;\n    background: red;\n    width: 10px;\n    height: 10px;\n  }\n</style>\n\n<div class=\"new-message\">\n  <form class=\"form\" on:submit|preventDefault={handleSubmit}>\n    <div class=\"recording-booth\">\n      <StylizedWebcamFeed bind:this={webcamFeed} />\n      {#if recording}<span class=\"recording-indicator\" />{/if}\n    </div>\n    <div class=\"fake-input\">\n      <textarea\n        class=\"input\"\n        type=\"text\"\n        bind:value={inputMessage}\n        on:keydown={handleInputKeydown}\n        placeholder=\"Type to GIF\"\n        disabled={recording} />\n      <button class=\"submit\" type=\"submit\" disabled={recording}>➪</button>\n    </div>\n  </form>\n</div>",
    "<script>\n  import Filmstrip from './filmstrip.svelte';\n\n  export let imageBlob;\n  export let text;\n</script>\n\n<style>\n  .message {\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n    margin-bottom: 25px;\n  }\n\n  .text {\n    margin-top: -10px;\n    padding: 15px 20px;\n    background: var(--black);\n    color: var(--white);\n    border: var(--white) 1px solid;\n    border-radius: 5px;\n    z-index: 2;\n  }\n</style>\n\n<div class=\"message\">\n  <Filmstrip src={imageBlob} />\n  <div class=\"text\">{text}</div>\n</div>\n",
    "<svelte:options accessors={true} />\n\n<script>\n  import Dither from 'canvas-dither';\n  import throttle from 'just-throttle';\n  import { onMount } from 'svelte';\n\n  export let canvasElement;\n  export let videoElement;\n  let processedImageDrawRequestId;\n\n  function drawProcessedImage () {\n    const canvas2dContext = canvasElement.getContext('2d');\n    canvas2dContext.drawImage(videoElement, 0, 0, videoElement.width, videoElement.height);\n    const canvasImageData = canvas2dContext.getImageData(0, 0, canvasElement.width, canvasElement.height);\n    const filteredImageData = Dither.atkinson(canvasImageData);\n    canvas2dContext.putImageData(filteredImageData, 0, 0);\n  }\n\n  const throttledDrawProcessedImage = throttle(drawProcessedImage, 100, true);\n    \n  function tryToDraw () {\n    throttledDrawProcessedImage();\n\n    processedImageDrawRequestId = requestAnimationFrame(tryToDraw);\n  }\n\n  onMount(() => {\n    navigator.mediaDevices.getUserMedia({\n      audio: false,\n      video: {\n        aspectRatio: {\n          ideal: 4 / 3\n        },\n        frameRate: {\n          ideal: 10\n        },\n        width: {\n          ideal: 640\n        },\n        height: {\n          ideal: 480\n        }\n      }\n    }).then((mediaStream) => {\n      videoElement.srcObject = mediaStream;\n      videoElement.play();\n    }).catch((error) => {\n      alert(error);\n    });\n\n    processedImageDrawRequestId = requestAnimationFrame(tryToDraw);\n\n    return function onUnMount () {\n      cancelAnimationFrame(processedImageDrawRequestId);\n    }\n  });\n</script>\n\n<style>\n  .raw-webcam {\n    position: fixed;\n    top: -9999px;\n    visibility: hidden;\n  }\n\n  .raw-webcam,\n  .processed-webcam {\n    display: block;\n    width: 200px;\n    height: 150px;\n    image-rendering: crisp-edges;\n    image-rendering: pixelated;\n  }\n\n  .processed-webcam {\n    background: var(--black);\n  }\n\n  @media (max-width: 480px) {\n    .raw-webcam,\n    .processed-webcam {\n      width: 100px;\n      height: 75px;\n    }\n  }\n</style>\n\n<div class=\"stylized-webcam-feed\">\n  <video class=\"raw-webcam\" width=\"200\" height=\"150\" bind:this={videoElement} />\n  <canvas class=\"processed-webcam\" width=\"200\" height=\"150\" bind:this={canvasElement} />\n</div>",
    "<script>\n  import { onMount } from 'svelte';\n\n  import { generateGIF } from '../utils/filmstrip.js';\n\n  export let src;\n  let imageElement;\n\n  function handleDownloadClick () {\n    console.log('handleDownloadClick()')\n    generateGIF(imageElement);\n  }\n</script>\n\n<style>\n  @keyframes play-frames {\n    from {\n      transform: translateY(0%);\n    }\n    to {\n      transform: translateY(-100%);\n    }\n  }\n\n  .filmstrip {\n    position: relative;\n    width: 300px;\n    height: 225px;\n    overflow: hidden;\n    background: var(--black);\n    border: white 1px solid;\n    border-radius: 5px;\n  }\n\n  .image {\n    animation: play-frames 2000ms steps(20, end) infinite;\n    width: 100%;\n    image-rendering: crisp-edges;\n  }\n\n  .download {\n    opacity: 0;\n    transition: opacity 200ms, transform 200ms;\n    transform: scale(0.9);\n    position: absolute;\n    top: 5px;\n    right: 5px;\n  }\n\n  .filmstrip:hover .download {\n    opacity: 1;\n    transform: scale(1);\n  }\n</style>\n\n<div class=\"filmstrip\">\n  <img class=\"image\" src={src} alt=\"\" bind:this={imageElement} />\n  <button class=\"download\" type=\"button\" on:click={handleDownloadClick}>Save  ▿</button>\n</div>"
  ],
  "names": [],
  "mappings": "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"
}