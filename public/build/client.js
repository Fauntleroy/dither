!function(){"use strict";function t(){}const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function s(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function u(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function c(t,e,n){t.$$.on_destroy.push(u(e,n))}function h(t,e,r,i){return t[1]&&i?n(r.ctx.slice(),t[1](i(e))):r.ctx}const f="undefined"!=typeof window;let l=f?()=>window.performance.now():()=>Date.now(),p=f?t=>requestAnimationFrame(t):t;const d=new Set;function v(t){d.forEach(e=>{e.c(t)||(d.delete(e),e.f())}),0!==d.size&&p(v)}function y(t){let e;return 0===d.size&&p(v),{promise:new Promise(n=>{d.add(e={c:t,f:n})}),abort(){d.delete(e)}}}function g(t,e){t.appendChild(e)}function m(t,e,n){t.insertBefore(e,n||null)}function w(t){t.parentNode.removeChild(t)}function b(t){return document.createElement(t)}function E(t){return document.createTextNode(t)}function _(){return E(" ")}function I(){return E("")}function T(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function A(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function N(t,e){(null!=e||t.value)&&(t.value=e)}function S(t,e,n){t.classList[n?"add":"remove"](e)}function k(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}const R=new Set;let D,O=0;function x(t,e,n,r,i,o,s,a=0){const u=16.666/r;let c="{\n";for(let t=0;t<=1;t+=u){const r=e+(n-e)*o(t);c+=100*t+`%{${s(r,1-r)}}\n`}const h=c+`100% {${s(n,1-n)}}\n}`,f=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(h)}_${a}`,l=t.ownerDocument;R.add(l);const p=l.__svelte_stylesheet||(l.__svelte_stylesheet=l.head.appendChild(b("style")).sheet),d=l.__svelte_rules||(l.__svelte_rules={});d[f]||(d[f]=!0,p.insertRule(`@keyframes ${f} ${h}`,p.cssRules.length));const v=t.style.animation||"";return t.style.animation=`${v?`${v}, `:""}${f} ${r}ms linear ${i}ms 1 both`,O+=1,f}function C(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),O-=i,O||p(()=>{O||(R.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),R.clear())}))}function P(t,e){const n=t.getBoundingClientRect();if(e.left!==n.left||e.top!==n.top){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform;t.style.transform=`${i} translate(${e.left-n.left}px, ${e.top-n.top}px)`}}function L(t){D=t}function M(){if(!D)throw new Error("Function called outside component initialization");return D}function U(t){M().$$.on_mount.push(t)}const j=[],B=[],F=[],V=[],q=Promise.resolve();let z=!1;function G(t){F.push(t)}let $=!1;const W=new Set;function Y(){if(!$){$=!0;do{for(let t=0;t<j.length;t+=1){const e=j[t];L(e),H(e.$$)}for(j.length=0;B.length;)B.pop()();for(let t=0;t<F.length;t+=1){const e=F[t];W.has(e)||(W.add(e),e())}F.length=0}while(j.length);for(;V.length;)V.pop()();z=!1,$=!1,W.clear()}}function H(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(G)}}let Q;function K(){return Q||(Q=Promise.resolve(),Q.then(()=>{Q=null})),Q}function J(t,e,n){t.dispatchEvent(k(`${e?"intro":"outro"}${n}`))}const X=new Set;let Z;function tt(){Z={r:0,c:[],p:Z}}function et(){Z.r||o(Z.c),Z=Z.p}function nt(t,e){t&&t.i&&(X.delete(t),t.i(e))}function rt(t,e,n,r){if(t&&t.o){if(X.has(t))return;X.add(t),Z.c.push(()=>{X.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}const it={duration:0};function ot(t,e){t.f(),function(t,e){rt(t,1,1,()=>{e.delete(t.key)})}(t,e)}function st(t){t&&t.c()}function at(t,e,n){const{fragment:i,on_mount:a,on_destroy:u,after_update:c}=t.$$;i&&i.m(e,n),G(()=>{const e=a.map(r).filter(s);u?u.push(...e):o(e),t.$$.on_mount=[]}),c.forEach(G)}function ut(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ct(t,e){-1===t.$$.dirty[0]&&(j.push(t),z||(z=!0,q.then(Y)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ht(e,n,r,s,a,u,c=[-1]){const h=D;L(e);const f=n.props||{},l=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:[]),callbacks:i(),dirty:c};let p=!1;if(l.ctx=r?r(e,f,(t,n,...r)=>{const i=r.length?r[0]:n;return l.ctx&&a(l.ctx[t],l.ctx[t]=i)&&(l.bound[t]&&l.bound[t](i),p&&ct(e,t)),n}):[],l.update(),p=!0,o(l.before_update),l.fragment=!!s&&s(l.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);l.fragment&&l.fragment.l(t),t.forEach(w)}else l.fragment&&l.fragment.c();n.intro&&nt(e.$$.fragment),at(e,n.target,n.anchor),Y()}L(h)}class ft{$destroy(){ut(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const lt=[];function pt(t,e){return{subscribe:dt(t,e).subscribe}}function dt(e,n=t){let r;const i=[];function o(t){if(a(e,t)&&(e=t,r)){const t=!lt.length;for(let t=0;t<i.length;t+=1){const n=i[t];n[1](),lt.push(n,e)}if(t){for(let t=0;t<lt.length;t+=2)lt[t][0](lt[t+1]);lt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const u=[s,a];return i.push(u),1===i.length&&(r=n(o)||t),s(e),()=>{const t=i.indexOf(u);-1!==t&&i.splice(t,1),0===i.length&&(r(),r=null)}}}}var vt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function yt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function gt(t,e){return t(e={exports:{}},e.exports),e.exports}function mt(t){return t&&t.default||t}const wt=(0,mt(Object.freeze({__proto__:null,derived:function(e,n,r){const i=!Array.isArray(e),a=i?[e]:e,c=n.length<2;return pt(r,e=>{let r=!1;const h=[];let f=0,l=t;const p=()=>{if(f)return;l();const r=n(i?h[0]:h,e);c?e(r):l=s(r)?r:t},d=a.map((t,e)=>u(t,t=>{h[e]=t,f&=~(1<<e),r&&p()},()=>{f|=1<<e}));return r=!0,p(),function(){o(d),l()}})},readable:pt,writable:dt,get:function(t){let e;return u(t,t=>e=t)(),e}})).writable)({});var bt={activeRoute:{subscribe:wt.subscribe,set:function(t){wt.set(t)},remove:function(){wt.set({})}}},Et=bt.activeRoute;var _t={UrlParser:(t,e="")=>{const n=new URL(t);function r(){return o(e).reduce((t,e,n)=>(":"===e[0]&&t.push({value:e.slice(1),index:n}),t),[])}function i(){return o(n.pathname)}function o(t){return"/"===t||0===t.trim().length?[t]:("/"===t.slice(-1)&&(t=t.slice(0,-1)),"/"===t[0]&&(t=t.slice(1)),t.split("/"))}return Object.freeze({host:n.host,hostname:n.hostname,namedParams:function(){const t=i();return r().reduce((e,n)=>(e[n.value]=t[n.index],e),{})}(),namedParamsKeys:r().reduce((t,e)=>(t.push(e.value),t),[]),namedParamsValues:function(){const t=i();return r().reduce((e,n)=>(e.push(t[n.index]),e),[])}(),pathNames:i(),port:n.port,pathname:n.pathname,protocol:n.protocol,search:n.search,queryParams:function(){const t={};return n.searchParams.forEach((e,n)=>{t[n]=e}),t}(),queryParamsKeys:function(){const t=[];return n.searchParams.forEach((e,n)=>{t.push(n)}),t}(),queryParamsValues:function(){const t=[];return n.searchParams.forEach(e=>{t.push(e)}),t}()})}};function It(t,e){return(e=Nt(e)).includes(":")?e.includes(t):e.startsWith(t)}function Tt(t,e,n){let r=!1;if(n)return{exists:e.lang&&e.lang[n]&&e.lang[n].includes(t),language:n};if(r=It(t,e.name),!r&&e.lang&&"object"==typeof e.lang)for(const[i,o]of Object.entries(e.lang))It(t,o)&&(r=!0,n=i);return{exists:r,language:n}}function At(t){return"/"===t||0===t.trim().length?[t]:(t=Nt(t,"both")).split("/")}function Nt(t,e="lead"){return t.trim().length<1?"":("trail"!==e&&"both"!==e||"/"===t.slice(-1)&&(t=t.slice(0,-1)),"lead"!==e&&"both"!==e||"/"===t[0]&&(t=t.slice(1)),t)}function St(t,e=null){return e&&t.lang&&t.lang[e]?t.lang[e]:t.name}var kt={anyEmptyNestedRoutes:function t(e){let n=!1;return 0===Object.keys(e).length||(e.childRoute&&0===Object.keys(e.childRoute).length?n=!0:e.childRoute&&(n=t(e.childRoute)),n)},compareRoutes:It,findLocalisedRoute:Tt,getNamedParams:function(t=""){return 0===t.trim().length?[]:At(t).reduce((t,e)=>(":"===e[0]&&t.push(e.slice(1)),t),[])},getPathNames:At,nameToPath:function(t=""){let e;return"/"===t||0===t.trim().length?t:(e=(t=Nt(t,"lead")).split(":")[0],e=Nt(e,"trail"),e.toLowerCase())},pathWithQueryParams:function(t){let e=[];if(t.queryParams)for(let[n,r]of Object.entries(t.queryParams))e.push(`${n}=${r}`);return e.length>0?`${t.path}?${e.join("&")}`:t.path},pathWithoutQueryParams:function(t){return t.path.split("?")[0]},removeExtraPaths:function(t,e){const n=e.split("/");return n.length>1&&n.forEach((function(e,n){e.length>0&&n>0&&t.shift()})),t},removeSlash:Nt,routeNameLocalised:St,updateRoutePath:function(t,e,n,r,i=!1){if("/"===t||0===t.trim().length)return{result:t,language:null};let o=t,s=n.name,a=r;if(i&&(a=""),s=Nt(s),o=Nt(o),n.childRoute)return{result:t,language:a};{let t=Tt(o,n,a);t.exists&&i&&(o=St(n,r));let u=s.split(":")[0];return u=Nt(u,"trail"),u=u.split("/"),u.shift(),u.forEach(()=>{const s=e[0];if(t=Tt(`${o}/${s}`,n,a),!s||!t.exists)return{result:o,language:t.language};o=i?St(n,r):`${o}/${s}`,e.shift()}),{result:o,language:t.language}}}};const{UrlParser:Rt}=_t,{pathWithQueryParams:Dt,removeSlash:Ot}=kt;var xt={RouterCurrent:function(t){const e=t||!1;let n="";return Object.freeze({active:function(){return n},isActive:function(t,e=!1){"/"!==t[0]&&(t="/"+t);let r=Rt(`http://fake.com${t}`).pathname,i=Rt(`http://fake.com${n}`).pathname;return r=Ot(r,"trail"),i=Ot(i,"trail"),e?i.includes(r):i===r},setActive:function(t){n=t.path,function(t){if("undefined"!=typeof window){const r=Dt(t);window.history.pushState({page:r},"",r),e&&(n=r,"undefined"!=typeof ga&&(ga("set","page",n),ga("send","pageview")))}var n}(t)}})}};var Ct={RouterGuard:function(t){const e=t;return Object.freeze({valid:function(){return e&&e.guard&&"function"==typeof e.guard},redirect:function(){return!e.guard()},redirectPath:function(){let t="/";return e.redirect&&e.redirect.length>0&&(t=e.redirect),t}})}};const{RouterGuard:Pt}=Ct;var Lt={RouterRedirect:function(t,e){const n=Pt(t.onlyIf);return Object.freeze({path:function(){let r=e;return t.redirectTo&&t.redirectTo.length>0&&(r=t.redirectTo),n.valid()&&n.redirect()&&(r=n.redirectPath()),r}})}};const{UrlParser:Mt}=_t;var Ut={RouterRoute:function({routeInfo:t,path:e,routeNamedParams:n,urlParser:r,namedPath:i,language:o}){function s(){const t=Mt(`https://fake.com${r.pathname}`,i).namedParams;return{...n,...t}}return Object.freeze({get:function(){return{name:e,component:t.component,layout:t.layout,queryParams:r.queryParams,namedParams:s(),path:e,language:o}},namedParams:s})}};const{updateRoutePath:jt,getNamedParams:Bt,nameToPath:Ft,removeExtraPaths:Vt,routeNameLocalised:qt}=kt;var zt={RouterPath:function({basePath:t,basePathName:e,pathNames:n,convert:r,currentLanguage:i}){let o,s,a=i;function u(){return qt(s,a)}function c(){return Ft(u())}function h(){return Ft(o.result)}return Object.freeze({basePathSameAsLocalised:function(){return h()===c()},updatedPath:function(t){return s=t,o=jt(e,n,s,a,r),a=r?i:o.language,o},basePathNameWithoutNamedParams:h,localisedPathName:u,localisedRouteWithoutNamedParams:c,namedPath:function(){const e=u();return t?`${t}/${e}`:e},pathNames:n,routeLanguage:function(){return a},routePath:function(){let e=`${t}/${h()}`;"//"===e&&(e="/"),a&&(n=Vt(n,c()));const r=Bt(u());return r&&r.length>0&&r.forEach((function(){n.length>0&&(e+=`/${n.shift()}`)})),e}})}};const{UrlParser:Gt}=_t,{RouterRedirect:$t}=Lt,{RouterRoute:Wt}=Ut,{RouterPath:Yt}=zt,{anyEmptyNestedRoutes:Ht,pathWithoutQueryParams:Qt}=kt;var Kt={RouterFinder:function({routes:t,currentUrl:e,routerOptions:n,convert:r}){const i=n.defaultLanguage,o=Gt(e);let s="",a={};return Object.freeze({findActiveRoute:function(){let e=function t(e,n,r,u,c){let h={},f=r.shift().toLowerCase();const l=Yt({basePath:n,basePathName:f,pathNames:r,convert:c,currentLanguage:u});e.forEach((function(e){if(l.updatedPath(e),l.basePathSameAsLocalised()){let n=l.routePath();if(s=$t(e,s).path(),h.name!==n&&(h=function({route:t,routePath:e,routeLanguage:n,urlParser:r,namedPath:o}){const s=Wt({routeInfo:t,urlParser:r,path:e,routeNamedParams:a,namedPath:o,language:n||i});return a=s.namedParams(),s.get()}({route:e,routePath:n,routeLanguage:l.routeLanguage(),urlParser:o,namedPath:l.namedPath()})),e.nestedRoutes&&e.nestedRoutes.length>0&&l.pathNames.length>0)h.childRoute=t(e.nestedRoutes,n,l.pathNames,l.routeLanguage(),c),h.path=h.childRoute.path,h.language=h.childRoute.language;else if(function(t,e){return t.nestedRoutes&&t.nestedRoutes.length>0&&0===e.length}(e,l.pathNames)){const r=t(e.nestedRoutes,n,["index"],l.routeLanguage(),c);r&&Object.keys(r).length>0&&(h.childRoute=r,h.language=h.childRoute.language)}}})),s&&(h.redirectTo=s);return h}(t,"",o.pathNames,n.lang,r);return e&&Object.keys(e).length&&!Ht(e)?e.path=Qt(e):"undefined"!=typeof window&&(e={name:"404",component:"",path:"404",redirectTo:"/404.html"}),e}})}};const{activeRoute:Jt}=bt,{RouterCurrent:Xt}=xt,{RouterFinder:Zt}=Kt,{removeSlash:te}=kt;let ee,ne=[],re={};function ie(t,e,n={}){function r(){let n=!1;return re.langConvertTo&&(re.lang=re.langConvertTo,n=!0),Zt({routes:t,currentUrl:e,routerOptions:re,convert:n}).findActiveRoute()}return re={...n},void 0!==e&&""!==e||(e=document.location.href),ee=Xt(re.gaPageviews),e=te(e,"trail"),ne=t,Object.freeze({setActiveRoute:function(){const t=r();return t.redirectTo?(e=t.redirectTo,"undefined"!=typeof window&&("/404.html"===e?ee.setActive({path:"/404.html"}):oe(e)),e):(ee.setActive(t),Jt.set(t),t);var e},findActiveRoute:r})}function oe(t,e=null){return t=te(t,"lead"),e&&(re.langConvertTo=e),ie(ne,"http://fake.com/"+t,re).setActiveRoute()}"undefined"!=typeof window&&(window.addEventListener("click",t=>{t.target.pathname&&t.target.hostname===window.location.hostname&&"a"===t.target.localName&&(t.preventDefault(),oe(t.target.pathname+t.target.search))}),window.onpopstate=function(t){oe(window.location.pathname+window.location.search)});var se={SpaRouter:ie,localisedRoute:function(t,e){return t=te(t,"lead"),re.langConvertTo=e,ie(ne,"http://fake.com/"+t,re).findActiveRoute()},navigateTo:oe,routeIsActive:function(t,e=!1){return ee.isActive(t,e)}},ae=se.SpaRouter,ue=se.localisedRoute,ce=se.navigateTo,he=se.routeIsActive;function fe(t){let e;const n=new ye({props:{currentRoute:t[0].childRoute,params:t[1]}});return{c(){st(n.$$.fragment)},m(t,r){at(n,t,r),e=!0},p(t,e){const r={};1&e&&(r.currentRoute=t[0].childRoute),2&e&&(r.params=t[1]),n.$set(r)},i(t){e||(nt(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function le(t){let e,n;var r=t[0].component;function i(t){return{props:{currentRoute:{...t[0],component:""},params:t[1]}}}if(r)var o=new r(i(t));return{c(){o&&st(o.$$.fragment),e=I()},m(t,r){o&&at(o,t,r),m(t,e,r),n=!0},p(t,n){const s={};if(1&n&&(s.currentRoute={...t[0],component:""}),2&n&&(s.params=t[1]),r!==(r=t[0].component)){if(o){tt();const t=o;rt(t.$$.fragment,1,0,()=>{ut(t,1)}),et()}r?(st((o=new r(i(t))).$$.fragment),nt(o.$$.fragment,1),at(o,e.parentNode,e)):o=null}else r&&o.$set(s)},i(t){n||(o&&nt(o.$$.fragment,t),n=!0)},o(t){o&&rt(o.$$.fragment,t),n=!1},d(t){t&&w(e),o&&ut(o,t)}}}function pe(t){let e,n;var r=t[0].layout;function i(t){return{props:{currentRoute:{...t[0],layout:""},params:t[1]}}}if(r)var o=new r(i(t));return{c(){o&&st(o.$$.fragment),e=I()},m(t,r){o&&at(o,t,r),m(t,e,r),n=!0},p(t,n){const s={};if(1&n&&(s.currentRoute={...t[0],layout:""}),2&n&&(s.params=t[1]),r!==(r=t[0].layout)){if(o){tt();const t=o;rt(t.$$.fragment,1,0,()=>{ut(t,1)}),et()}r?(st((o=new r(i(t))).$$.fragment),nt(o.$$.fragment,1),at(o,e.parentNode,e)):o=null}else r&&o.$set(s)},i(t){n||(o&&nt(o.$$.fragment,t),n=!0)},o(t){o&&rt(o.$$.fragment,t),n=!1},d(t){t&&w(e),o&&ut(o,t)}}}function de(t){let e,n,r,i;const o=[pe,le,fe],s=[];function a(t,e){return t[0].layout?0:t[0].component?1:t[0].childRoute?2:-1}return~(e=a(t))&&(n=s[e]=o[e](t)),{c(){n&&n.c(),r=I()},m(t,n){~e&&s[e].m(t,n),m(t,r,n),i=!0},p(t,[i]){let u=e;e=a(t),e===u?~e&&s[e].p(t,i):(n&&(tt(),rt(s[u],1,1,()=>{s[u]=null}),et()),~e?(n=s[e],n||(n=s[e]=o[e](t),n.c()),nt(n,1),n.m(r.parentNode,r)):n=null)},i(t){i||(nt(n),i=!0)},o(t){rt(n),i=!1},d(t){~e&&s[e].d(t),t&&w(r)}}}function ve(t,e,n){let{currentRoute:r={}}=e,{params:i={}}=e;return t.$set=t=>{"currentRoute"in t&&n(0,r=t.currentRoute),"params"in t&&n(1,i=t.params)},[r,i]}class ye extends ft{constructor(t){super(),ht(this,t,ve,de,a,{currentRoute:0,params:1})}}var ge=Object.freeze({__proto__:null,default:ye});function me(t){let e;const n=new ye({props:{currentRoute:t[0]}});return{c(){st(n.$$.fragment)},m(t,r){at(n,t,r),e=!0},p(t,[e]){const r={};1&e&&(r.currentRoute=t[0]),n.$set(r)},i(t){e||(nt(n.$$.fragment,t),e=!0)},o(t){rt(n.$$.fragment,t),e=!1},d(t){ut(n,t)}}}function we(t,e,n){let r;c(t,Et,t=>n(0,r=t));let{routes:i=[]}=e,{options:o={}}=e;return U((function(){ae(i,document.location.href,o).setActiveRoute()})),t.$set=t=>{"routes"in t&&n(1,i=t.routes),"options"in t&&n(2,o=t.options)},[r,i,o]}var be=Object.freeze({__proto__:null,default:class extends ft{constructor(t){super(),ht(this,t,we,me,a,{routes:1,options:2})}}});function Ee(t){let e,n,r;const i=t[6].default,o=function(t,e,n,r){if(t){const i=h(t,e,n,r);return t[0](i)}}(i,t,t[5],null);return{c(){e=b("a"),o&&o.c(),A(e,"href",t[0]),A(e,"title",t[1]),A(e,"class",t[2]),S(e,"active",he(t[0]))},m(i,s,a){m(i,e,s),o&&o.m(e,null),n=!0,a&&r(),r=T(e,"click",t[3])},p(t,[r]){o&&o.p&&32&r&&o.p(h(i,t,t[5],null),function(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|i[r];return t}return e.dirty|i}return e.dirty}(i,t[5],r,null)),(!n||1&r)&&A(e,"href",t[0]),(!n||2&r)&&A(e,"title",t[1]),(!n||4&r)&&A(e,"class",t[2]),5&r&&S(e,"active",he(t[0]))},i(t){n||(nt(o,t),n=!0)},o(t){rt(o,t),n=!1},d(t){t&&w(e),o&&o.d(t),r()}}}function _e(t,e,n){let{to:r="/"}=e,{title:i=""}=e,{styles:o=""}=e,{lang:s=null}=e;U((function(){if(s){const t=ue(r,s);t&&n(0,r=t.path)}}));let{$$slots:a={},$$scope:u}=e;return t.$set=t=>{"to"in t&&n(0,r=t.to),"title"in t&&n(1,i=t.title),"styles"in t&&n(2,o=t.styles),"lang"in t&&n(4,s=t.lang),"$$scope"in t&&n(5,u=t.$$scope)},[r,i,o,function(t){t.preventDefault(),t.stopPropagation(),ce(r)},s,u,a]}var Ie=Object.freeze({__proto__:null,default:class extends ft{constructor(t){super(),ht(this,t,_e,Ee,a,{to:0,title:1,styles:2,lang:4})}}}),Te=mt(ge),Ae=mt(be),Ne=mt(Ie);const{SpaRouter:Se,navigateTo:ke,localisedRoute:Re,routeIsActive:De}=se;var Oe={SpaRouter:Se,localisedRoute:Re,navigateTo:ke,routeIsActive:De,Route:Te,Router:Ae,Navigate:Ne},xe=Oe.navigateTo,Ce=Oe.Route,Pe=Oe.Router,Le=function(t,e){return(Le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Me=function(){return(Me=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Ue(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function je(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Be(t){return this instanceof Be?(this.v=t,this):new Be(t)}var Fe=Object.freeze({__proto__:null,__extends:function(t,e){function n(){this.constructor=t}Le(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},get __assign(){return Me},__rest:function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},__decorate:function(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s},__param:function(t,e){return function(n,r){e(n,r,t)}},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{u(r.next(t))}catch(t){o(t)}}function a(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((r=r.apply(t,e||[])).next())}))},__generator:function(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},__exportStar:function(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])},__values:Ue,__read:je,__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(je(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r},__await:Be,__asyncGenerator:function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))})}function a(t,e){try{!function(t){t.value instanceof Be?Promise.resolve(t.value.v).then(u,c):h(o[0][2],t)}(i[t](e))}catch(t){h(o[0][3],t)}}function u(t){a("next",t)}function c(t){a("throw",t)}function h(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}},__asyncDelegator:function(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:Be(t[r](e)),done:"return"===r}:i?i(e):e}:i}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=Ue(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}}),Ve=gt((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var n={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},r=function(t,e){if(!t)throw i(e)},i=function(t){return new Error("Firebase Database ("+n.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},o=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,f=(3&o)<<4|a>>4,l=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(l=64)),r.push(n[h],n[f],n[l],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(o(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var f=a<<6&192|u;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},a=function(t){try{return s.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function u(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=u(t[n],e[n]));return t}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var c=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function h(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var f=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,l.prototype.create),i}return Fe.__extends(e,t),e}(Error),l=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?p(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new f(i,a),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),u[l]=r[l])}return u},t}();function p(t,e){return t.replace(d,(function(t,n){var r=e[n];return null!=r?r.toString():"<"+n+"?>"}))}var d=/\{\$([^}]+)}/g;
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function v(t){return JSON.parse(t)}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var y=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=v(a(o[0])||""),n=v(a(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}};
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var g=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],f=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),s=1518500249):(o=u^c^h,s=1859775393):r<60?(o=u&c|h&(u|c),s=2400959708):(o=u^c^h,s=3395469782);i=(a<<5|a>>>27)+o+f+s+n[r]&4294967295;f=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+f&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();var m=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=w),void 0===r.error&&(r.error=w),void 0===r.complete&&(r.complete=w);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function w(){}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function b(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}e.CONSTANTS=n,e.Deferred=c,e.ErrorFactory=l,e.FirebaseError=f,e.Sha1=g,e.assert=r,e.assertionError=i,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}},e.base64=s,e.base64Decode=a,e.base64Encode=function(t){var e=o(t);return s.encodeByteArray(e,!0)},e.contains=
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new m(t,e);return n.subscribe.bind(n)},e.decode=y,e.deepCopy=
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(t){return u(void 0,t)},e.deepExtend=u,e.errorPrefix=b,e.getUA=h,e.isAdmin=function(t){var e=y(t).claims;return"object"==typeof e&&!0===e.admin},e.isBrowser=function(){return"object"==typeof self&&self.self===self},e.isBrowserExtension=function(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id},e.isElectron=function(){return h().indexOf("Electron/")>=0},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isIE=function(){var t=h();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(h())},e.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(vt.process)}catch(t){return!1}},e.isNodeSdk=function(){return!0===n.NODE_CLIENT||!0===n.NODE_ADMIN},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isUWP=function(){return h().indexOf("MSAppHost/")>=0},e.isValidFormat=function(t){var e=y(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e=y(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=y(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=v,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */,e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}})),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);if(o>=55296&&o<=56319){var s=o-55296;i++,r(i<t.length,"Surrogate pair missing trail surrogate."),o=65536+(s<<10)+(t.charCodeAt(i)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(b(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(b(t,e,r)+"must be a valid context object.")}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */,e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(b(t,e,r)+"must be a valid firebase namespace.")}}));yt(Ve);Ve.CONSTANTS,Ve.Deferred,Ve.ErrorFactory,Ve.FirebaseError,Ve.Sha1,Ve.assert,Ve.assertionError,Ve.async,Ve.base64,Ve.base64Decode,Ve.base64Encode,Ve.contains,Ve.createSubscribe,Ve.decode,Ve.deepCopy,Ve.deepExtend,Ve.errorPrefix,Ve.getUA,Ve.isAdmin,Ve.isBrowser,Ve.isBrowserExtension,Ve.isElectron,Ve.isEmpty,Ve.isIE,Ve.isMobileCordova,Ve.isNode,Ve.isNodeSdk,Ve.isReactNative,Ve.isUWP,Ve.isValidFormat,Ve.isValidTimestamp,Ve.issuedAtTime,Ve.jsonEval,Ve.map,Ve.querystring,Ve.querystringDecode,Ve.safeGet,Ve.stringLength,Ve.stringToByteArray,Ve.stringify,Ve.validateArgCount,Ve.validateCallback,Ve.validateContextObject,Ve.validateNamespace;var qe=gt((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),r=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Ve.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=Fe.__assign({identifier:"[DEFAULT]",optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t))try{this.getOrInitializeService("[DEFAULT]")}catch(t){}try{for(var r=Fe.__values(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Fe.__read(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService(u);a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t;return Fe.__generator(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}();
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var i=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new r(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();e.Component=n,e.ComponentContainer=i,e.Provider=r}));yt(qe);var ze;qe.Component,qe.ComponentContainer,qe.Provider;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
function Ge(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $e,We=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}($e||($e={}));var Ye={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},He=$e.INFO,Qe=((ze={})[$e.DEBUG]="log",ze[$e.VERBOSE]="log",ze[$e.INFO]="info",ze[$e.WARN]="warn",ze[$e.ERROR]="error",ze),Ke=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=Qe[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,Ge(["["+i+"]  "+t.name+":"],n))}},Je=function(){function t(t){this.name=t,this._logLevel=He,this._logHandler=Ke,this._userLogHandler=null,We.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in $e))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ge([this,$e.DEBUG],t)),this._logHandler.apply(this,Ge([this,$e.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ge([this,$e.VERBOSE],t)),this._logHandler.apply(this,Ge([this,$e.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ge([this,$e.INFO],t)),this._logHandler.apply(this,Ge([this,$e.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ge([this,$e.WARN],t)),this._logHandler.apply(this,Ge([this,$e.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,Ge([this,$e.ERROR],t)),this._logHandler.apply(this,Ge([this,$e.ERROR],t))},t}();var Xe=Object.freeze({__proto__:null,get LogLevel(){return $e},Logger:Je,setLogLevel:function(t){var e="string"==typeof t?Ye[t]:t;We.forEach((function(t){t.logLevel=e}))},setUserLogHandler:function(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=Ye[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:$e[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=We;r<i.length;r++){n(i[r])}}}),Ze=gt((function(t,e){
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var n;Object.defineProperty(e,"__esModule",{value:!0});var r,i=((n={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",n["bad-app-name"]="Illegal App name: '{$appName}",n["duplicate-app"]="Firebase App named '{$appName}' already exists",n["app-deleted"]="Firebase App named '{$appName}' already deleted",n["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",n["invalid-log-argument"]="First argument to `onLog` must be null or a function.",n),o=new Ve.ErrorFactory("app","Firebase",i),s=((r={})["@firebase/app"]="fire-core",r["@firebase/analytics"]="fire-analytics",r["@firebase/auth"]="fire-auth",r["@firebase/database"]="fire-rtdb",r["@firebase/functions"]="fire-fn",r["@firebase/installations"]="fire-iid",r["@firebase/messaging"]="fire-fcm",r["@firebase/performance"]="fire-perf",r["@firebase/remote-config"]="fire-rc",r["@firebase/storage"]="fire-gcs",r["@firebase/firestore"]="fire-fst",r["fire-js"]="fire-js",r["firebase-wrapper"]="fire-js-all",r),a=new Xe.Logger("@firebase/app"),u=function(){function t(t,e,n){var r,i,o=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Ve.deepCopy(t),this.container=new qe.ComponentContainer(e.name),this._addComponent(new qe.Component("app",(function(){return o}),"PUBLIC"));try{for(var s=Fe.__values(this.firebase_.INTERNAL.components.values()),a=s.next();!a.done;a=s.next()){var u=a.value;this._addComponent(u)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){a.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw o.create("app-deleted",{appName:this.name_})},t}();u.prototype.name&&u.prototype.options||u.prototype.delete||console.log("dc");var c=
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function t(){var e=
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={});if("object"!=typeof i||null===i){i={name:i}}var s=i;void 0===s.name&&(s.name="[DEFAULT]");var a=s.name;if("string"!=typeof a||!a)throw o.create("bad-app-name",{appName:String(a)});if(Ve.contains(e,a))throw o.create("duplicate-app",{appName:a});var u=new t(n,s,r);return e[a]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=s[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){var h=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&h.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&c&&h.push("and"),c&&h.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void a.warn(h.join(" "))}u(new qe.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:Xe.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw o.create("invalid-log-argument",{appName:name});Xe.setUserLogHandler(t,e)},apps:null,SDK_VERSION:"7.13.2",INTERNAL:{registerComponent:u,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){if("serverAuth"===e)return null;return e}}};function i(t){if(t=t||"[DEFAULT]",!Ve.contains(e,t))throw o.create("no-app",{appName:t});return e[t]}function u(s){var u,c,h=s.name;if(n.has(h))return a.debug("There were multiple attempts to register component "+h+"."),"PUBLIC"===s.type?r[h]:null;if(n.set(h,s),"PUBLIC"===s.type){var f=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[h])throw o.create("invalid-app-argument",{appName:h});return t[h]()};void 0!==s.serviceProps&&Ve.deepExtend(f,s.serviceProps),r[h]=f,t.prototype[h]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,h);return n.apply(this,s.multipleInstances?t:[])}}try{for(var l=Fe.__values(Object.keys(e)),p=l.next();!p.done;p=l.next()){var d=p.value;e[d]._addComponent(s)}}catch(t){u={error:t}}finally{try{p&&!p.done&&(c=l.return)&&c.call(l)}finally{if(u)throw u.error}}return"PUBLIC"===s.type?r[h]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(u);return e.INTERNAL=Fe.__assign(Fe.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Ve.deepExtend(e,t)},createSubscribe:Ve.createSubscribe,ErrorFactory:Ve.ErrorFactory,deepExtend:Ve.deepExtend}),e}(),h=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
if(Ve.isBrowser()&&void 0!==self.firebase){a.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var f=self.firebase.SDK_VERSION;f&&f.indexOf("LITE")>=0&&a.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var l=c.initializeApp;c.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ve.isNode()&&a.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),l.apply(void 0,t)};var p=c;!function(t,e){t.INTERNAL.registerComponent(new qe.Component("platform-logger",(function(t){return new h(t)}),"PRIVATE")),t.registerVersion("@firebase/app","0.6.1",e),t.registerVersion("fire-js","")}(p),e.default=p,e.firebase=p}));yt(Ze);Ze.firebase;var tn,en=(tn=Ze)&&"object"==typeof tn&&"default"in tn?tn.default:tn;
/**
     * @license
     * Copyright 2018 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
en.registerVersion("firebase","7.13.2","app");var nn=en,rn="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function on(){throw new Error("setTimeout has not been defined")}function sn(){throw new Error("clearTimeout has not been defined")}var an=on,un=sn;function cn(t){if(an===setTimeout)return setTimeout(t,0);if((an===on||!an)&&setTimeout)return an=setTimeout,setTimeout(t,0);try{return an(t,0)}catch(e){try{return an.call(null,t,0)}catch(e){return an.call(this,t,0)}}}"function"==typeof rn.setTimeout&&(an=setTimeout),"function"==typeof rn.clearTimeout&&(un=clearTimeout);var hn,fn=[],ln=!1,pn=-1;function dn(){ln&&hn&&(ln=!1,hn.length?fn=hn.concat(fn):pn=-1,fn.length&&vn())}function vn(){if(!ln){var t=cn(dn);ln=!0;for(var e=fn.length;e;){for(hn=fn,fn=[];++pn<e;)hn&&hn[pn].run();pn=-1,e=fn.length}hn=null,ln=!1,function(t){if(un===clearTimeout)return clearTimeout(t);if((un===sn||!un)&&clearTimeout)return un=clearTimeout,clearTimeout(t);try{un(t)}catch(e){try{return un.call(null,t)}catch(e){return un.call(this,t)}}}(t)}}function yn(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];fn.push(new gn(t,e)),1!==fn.length||ln||cn(vn)}function gn(t,e){this.fun=t,this.array=e}gn.prototype.run=function(){this.fun.apply(null,this.array)};function mn(){}var wn=mn,bn=mn,En=mn,_n=mn,In=mn,Tn=mn,An=mn;var Nn=rn.performance||{},Sn=Nn.now||Nn.mozNow||Nn.msNow||Nn.oNow||Nn.webkitNow||function(){return(new Date).getTime()};var kn=new Date;var Rn,Dn={nextTick:yn,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:wn,addListener:bn,once:En,off:_n,removeListener:In,removeAllListeners:Tn,emit:An,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*Sn.call(Nn),n=Math.floor(e),r=Math.floor(e%1*1e9);return t&&(n-=t[0],(r-=t[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-kn)/1e3}},On="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==rn?rn:"undefined"!=typeof self?self:{},xn=xn||{},Cn=On;function Pn(t){return"string"==typeof t}function Ln(t){return"number"==typeof t}function Mn(t,e){t=t.split("."),e=e||Cn;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function Un(){}function jn(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function Bn(t){return"array"==jn(t)}function Fn(t){var e=jn(t);return"array"==e||"object"==e&&"number"==typeof t.length}function Vn(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var qn="closure_uid_"+(1e9*Math.random()>>>0),zn=0;function Gn(t,e,n){return t.call.apply(t.bind,arguments)}function $n(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Wn(t,e,n){return(Wn=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Gn:$n).apply(null,arguments)}function Yn(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var Hn=Date.now||function(){return+new Date};function Qn(t,e){function n(){}n.prototype=e.prototype,t.N=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.yb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function Kn(){this.j=this.j,this.i=this.i}Kn.prototype.j=!1,Kn.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[qn]||(this[qn]=++zn)},Kn.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var Jn=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(Pn(t))return Pn(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Xn=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=Pn(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Zn(t){return Array.prototype.concat.apply([],arguments)}function tr(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function er(t){return/^[\s\xa0]*$/.test(t)}var nr,rr=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function ir(t,e){return-1!=t.indexOf(e)}function or(t,e){return t<e?-1:t>e?1:0}t:{var sr=Cn.navigator;if(sr){var ar=sr.userAgent;if(ar){nr=ar;break t}}nr=""}function ur(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function cr(t){var e,n={};for(e in t)n[e]=t[e];return n}var hr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function fr(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<hr.length;o++)n=hr[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function lr(t){return lr[" "](t),t}lr[" "]=Un;var pr,dr,vr=ir(nr,"Opera"),yr=ir(nr,"Trident")||ir(nr,"MSIE"),gr=ir(nr,"Edge"),mr=gr||yr,wr=ir(nr,"Gecko")&&!(ir(nr.toLowerCase(),"webkit")&&!ir(nr,"Edge"))&&!(ir(nr,"Trident")||ir(nr,"MSIE"))&&!ir(nr,"Edge"),br=ir(nr.toLowerCase(),"webkit")&&!ir(nr,"Edge");function Er(){var t=Cn.document;return t?t.documentMode:void 0}t:{var _r="",Ir=(dr=nr,wr?/rv:([^\);]+)(\)|;)/.exec(dr):gr?/Edge\/([\d\.]+)/.exec(dr):yr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(dr):br?/WebKit\/(\S+)/.exec(dr):vr?/(?:Version)[ \/]?(\S+)/.exec(dr):void 0);if(Ir&&(_r=Ir?Ir[1]:""),yr){var Tr=Er();if(null!=Tr&&Tr>parseFloat(_r)){pr=String(Tr);break t}}pr=_r}var Ar,Nr={};function Sr(t){return function(t,e){var n=Nr;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=rr(String(pr)).split("."),r=rr(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;e=or(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||or(0==s[2].length,0==a[2].length)||or(s[2],a[2]),s=s[3],a=a[3]}while(0==e)}return 0<=e}))}var kr=Cn.document;Ar=kr&&yr?Er()||("CSS1Compat"==kr.compatMode?parseInt(pr,10):5):void 0;var Rr=!yr||9<=Number(Ar),Dr=yr&&!Sr("9"),Or=function(){if(!Cn.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Cn.addEventListener("test",Un,e),Cn.removeEventListener("test",Un,e)}catch(t){}return t}();function xr(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function Cr(t,e){if(xr.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(wr){t:{try{lr(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=Pn(t.pointerType)?t.pointerType:Pr[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}xr.prototype.b=function(){this.Ia=!1},Qn(Cr,xr);var Pr={2:"touch",3:"pen",4:"mouse"};Cr.prototype.b=function(){Cr.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Dr)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var Lr="closure_listenable_"+(1e6*Math.random()|0),Mr=0;function Ur(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++Mr,this.X=this.Z=!1}function jr(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Br(t){this.src=t,this.a={},this.b=0}function Fr(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=Jn(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(jr(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Vr(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}Br.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Vr(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ur(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var qr="closure_lm_"+(1e6*Math.random()|0),zr={};function Gr(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Bn(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Xr(r),e&&e[Lr]?e.Aa(n,r,Vn(i)?!!i.capture:!!i,o):$r(e,n,r,!0,i,o)}(t,e,n,r,i);if(Bn(e)){for(var o=0;o<e.length;o++)Gr(t,e[o],n,r,i);return null}return n=Xr(n),t&&t[Lr]?t.za(e,n,Vn(r)?!!r.capture:!!r,i):$r(t,e,n,!1,r,i)}function $r(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=Vn(i)?!!i.capture:!!i;if(s&&!Rr)return null;var a=Kr(t);if(a||(t[qr]=a=new Br(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Qr,e=Rr?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Or||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Yr(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Wr(t){if(!Ln(t)&&t&&!t.X){var e=t.src;if(e&&e[Lr])Fr(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Yr(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Kr(e))?(Fr(n,t),0==n.b&&(n.src=null,e[qr]=null)):jr(t)}}}function Yr(t){return t in zr?zr[t]:zr[t]="on"+t}function Hr(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&Wr(t),n.call(r,e)}function Qr(t,e){return!!t.X||(Rr?Hr(t,new Cr(e,this)):Hr(t,e=new Cr(e||Mn("window.event"),this)))}function Kr(t){return(t=t[qr])instanceof Br?t:null}var Jr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Xr(t){return"function"==jn(t)?t:(t[Jr]||(t[Jr]=function(e){return t.handleEvent(e)}),t[Jr])}function Zr(){Kn.call(this),this.c=new Br(this),this.J=this,this.B=null}function ti(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&Fr(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&0!=r.Ia}Qn(Zr,Kn),Zr.prototype[Lr]=!0,(Rn=Zr.prototype).addEventListener=function(t,e,n,r){Gr(this,t,e,n,r)},Rn.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Bn(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=Vn(i)?!!i.capture:!!i,r=Xr(r),e&&e[Lr]?(e=e.c,(n=String(n).toString())in e.a&&(-1<(r=Vr(s=e.a[n],r,i,o))&&(jr(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--)))):e&&(e=Kr(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Vr(n,r,i,o)),(r=-1<e?n[e]:null)&&Wr(r))}(this,t,e,n,r)},Rn.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(Pn(t))t=new xr(t,n);else if(t instanceof xr)t.target=t.target||n;else{var i=t;fr(t=new xr(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=ti(s,r,!0,t)&&i}if(i=ti(s=t.a=n,r,!0,t)&&i,i=ti(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=ti(s=t.a=e[o],r,!1,t)&&i;return i},Rn.G=function(){if(Zr.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)jr(n[r]);delete e.a[t],e.b--}}this.B=null},Rn.za=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},Rn.Aa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var ei=Cn.JSON.stringify;function ni(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function ri(){this.b=this.a=null}ni.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var ii,oi=new ni((function(){return new ai}),(function(t){t.reset()}));function si(){var t=fi,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function ai(){this.next=this.b=this.a=null}function ui(t){Cn.setTimeout((function(){throw t}),0)}function ci(t,e){ii||function(){var t=Cn.Promise.resolve(void 0);ii=function(){t.then(li)}}(),hi||(ii(),hi=!0),fi.add(t,e)}ri.prototype.add=function(t,e){var n=oi.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},ai.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},ai.prototype.reset=function(){this.next=this.b=this.a=null};var hi=!1,fi=new ri;function li(){for(var t;t=si();){try{t.a.call(t.b)}catch(t){ui(t)}var e=oi;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}hi=!1}function pi(t,e){Zr.call(this),this.b=t||1,this.a=e||Cn,this.f=Wn(this.gb,this),this.g=Hn()}function di(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function vi(t,e,n){if("function"==jn(t))n&&(t=Wn(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Wn(t.handleEvent,t)}return 2147483647<Number(e)?-1:Cn.setTimeout(t,e||0)}function yi(t,e,n){Kn.call(this),this.f=null!=n?Wn(t,n):t,this.c=e,this.b=Wn(this.$a,this),this.a=[]}function gi(t){t.U=vi(t.b,t.c),t.f.apply(null,t.a)}function mi(t){Kn.call(this),this.b=t,this.a={}}Qn(pi,Zr),(Rn=pi.prototype).ba=!1,Rn.L=null,Rn.gb=function(){if(this.ba){var t=Hn()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(di(this),this.start()))}},Rn.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=Hn())},Rn.G=function(){pi.N.G.call(this),di(this),delete this.a},Qn(yi,Kn),(Rn=yi.prototype).ea=!1,Rn.U=null,Rn.Ta=function(t){this.a=arguments,this.U?this.ea=!0:gi(this)},Rn.G=function(){yi.N.G.call(this),this.U&&(Cn.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},Rn.$a=function(){this.U=null,this.ea&&(this.ea=!1,gi(this))},Qn(mi,Kn);var wi=[];function bi(t,e,n,r){Bn(n)||(n&&(wi[0]=n.toString()),n=wi);for(var i=0;i<n.length;i++){var o=Gr(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Ei(t){ur(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Wr(t)}),t),t.a={}}function _i(){}mi.prototype.G=function(){mi.N.G.call(this),Ei(this)},mi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ii=new Zr;function Ti(t){xr.call(this,"serverreachability",t)}function Ai(t){Ii.dispatchEvent(new Ti(Ii,t))}function Ni(t){xr.call(this,"statevent",t)}function Si(t){Ii.dispatchEvent(new Ni(Ii,t))}function ki(t){xr.call(this,"timingevent",t)}function Ri(t,e){if("function"!=jn(t))throw Error("Fn must not be null and must be a function");return Cn.setTimeout((function(){t()}),e)}Qn(Ti,xr),Qn(Ni,xr),Qn(ki,xr);var Di={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Oi={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function xi(){}function Ci(t){var e;return(e=t.a)||(e=t.a={}),e}function Pi(){}xi.prototype.a=null;var Li,Mi={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function Ui(){xr.call(this,"d")}function ji(){xr.call(this,"c")}function Bi(){}function Fi(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new mi(this),this.O=Vi,t=mr?125:void 0,this.P=new pi(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}Qn(Ui,xr),Qn(ji,xr),Qn(Bi,xi),Li=new Bi;var Vi=45e3,qi={},zi={};function Gi(t,e,n){t.F=1,t.f=yo(uo(e)),t.l=n,t.H=!0,Wi(t,null)}function $i(t,e,n,r){t.F=1,t.f=yo(uo(e)),t.l=null,t.H=n,Wi(t,r)}function Wi(t,e){t.v=Hn(),Qi(t),t.D=uo(t.f),vo(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new yi(Wn(t.Ja,t,t.a),t.J)),bi(t.I,t.a,"readystatechange",t.cb),e=t.h?cr(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),Ai(1)}function Yi(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=Hi(t,n);if(i==zi){4==e&&(t.c=4,Si(14),r=!1);break}if(i==qi){t.c=4,Si(15),r=!1;break}to(t,i)}4==e&&0==n.length&&(t.c=1,Si(16),r=!1),t.b=t.b&&r,r||(Zi(t),Xi(t))}function Hi(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?zi:(n=Number(e.substring(n,r)),isNaN(n)?qi:(r+=1)+n>e.length?zi:(e=e.substr(r,n),t.A=r+n,e))}function Qi(t){t.R=Hn()+t.O,Ki(t,t.O)}function Ki(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Ri(Wn(t.ab,t),e)}function Ji(t){t.i&&(Cn.clearTimeout(t.i),t.i=null)}function Xi(t){t.g.Ca()||t.m||t.g.na(t)}function Zi(t){Ji(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,di(t.P),Ei(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function to(t,e){try{t.g.Fa(t,e),Ai(4)}catch(t){}}function eo(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Fn(t)||Pn(t))Xn(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(Fn(t)||Pn(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(Pn(t))return t.split("");if(Fn(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function no(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof no)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ro(t,e){oo(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&io(t))}function io(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];oo(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)oo(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function oo(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Rn=Fi.prototype).setTimeout=function(t){this.O=t},Rn.cb=function(t){t=t.target;var e=this.B;e&&3==us(t)?e.Ta():this.Ja(t)},Rn.Ja=function(t){try{if(t==this.a)t:{var e=us(this.a),n=this.a.ya(),r=this.a.T();if(!(3>e||3==e&&!mr&&!this.a.aa())){this.m||4!=e||7==n||Ai(8==n||0>=r?3:2),Ji(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var s=cs(this.a,"X-HTTP-Initial-Response");if(s&&!er(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,Si(12),Zi(this),Xi(this);break t}this.s=!0,to(this,a)}this.H?(Yi(this,e,o),mr&&this.b&&3==e&&(bi(this.I,this.P,"tick",this.bb),this.P.start())):to(this,o),4==e&&Zi(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Qi(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,Si(12)):(this.c=0,Si(13)),Zi(this),Xi(this)}}}catch(t){}},Rn.bb=function(){if(this.a){var t=us(this.a),e=this.a.aa();this.A<e.length&&(Ji(this),Yi(this,t,e),this.b&&4!=t&&Qi(this))}},Rn.cancel=function(){this.m=!0,Zi(this)},Rn.ab=function(){this.i=null;var t=Hn();0<=t-this.R?(2!=this.F&&(Ai(3),Si(17)),Zi(this),this.c=2,Xi(this)):Ki(this,this.R-t)},(Rn=no.prototype).C=function(){io(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},Rn.K=function(){return io(this),this.a.concat()},Rn.get=function(t,e){return oo(this.b,t)?this.b[t]:e},Rn.set=function(t,e){oo(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},Rn.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var so=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ao(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof ao?(this.h=void 0!==e?e:t.h,co(this,t.f),this.j=t.j,ho(this,t.b),fo(this,t.i),this.a=t.a,lo(this,Do(t.c)),this.g=t.g):t&&(n=String(t).match(so))?(this.h=!!e,co(this,n[1]||"",!0),this.j=go(n[2]||""),ho(this,n[3]||"",!0),fo(this,n[4]),this.a=go(n[5]||"",!0),lo(this,n[6]||"",!0),this.g=go(n[7]||"")):(this.h=!!e,this.c=new Ao(null,this.h))}function uo(t){return new ao(t)}function co(t,e,n){t.f=n?go(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function ho(t,e,n){t.b=n?go(e,!0):e}function fo(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function lo(t,e,n){e instanceof Ao?(t.c=e,function(t,e){e&&!t.f&&(No(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(So(this,e),Ro(this,n,t))}),t)),t.f=e}(t.c,t.h)):(n||(e=mo(e,Io)),t.c=new Ao(e,t.h))}function po(t,e,n){t.c.set(e,n)}function vo(t,e,n){Bn(n)||(n=[String(n)]),Ro(t.c,e,n)}function yo(t){return po(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Hn()).toString(36)),t}function go(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function mo(t,e,n){return Pn(t)?(t=encodeURI(t).replace(e,wo),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function wo(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ao.prototype.toString=function(){var t=[],e=this.f;e&&t.push(mo(e,bo,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(mo(e,bo,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(mo(n,"/"==n.charAt(0)?_o:Eo,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",mo(n,To)),t.join("")},ao.prototype.resolve=function(t){var e=uo(this),n=!!t.f;n?co(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?ho(e,t.b):n=null!=t.i;var r=t.a;if(n)fo(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ir(i,"./")||ir(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?lo(e,Do(t.c)):n=!!t.g,n&&(e.g=t.g),e};var bo=/[#\/\?@]/g,Eo=/[#\?:]/g,_o=/[#\?]/g,Io=/[#\?@]/g,To=/#/g;function Ao(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function No(t){t.a||(t.a=new no,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function So(t,e){No(t),e=Oo(t,e),oo(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ro(t.a,e))}function ko(t,e){return No(t),e=Oo(t,e),oo(t.a.b,e)}function Ro(t,e,n){So(t,e),0<n.length&&(t.c=null,t.a.set(Oo(t,e),tr(n)),t.b+=n.length)}function Do(t){var e=new Ao;return e.c=t.c,t.a&&(e.a=new no(t.a),e.b=t.b),e}function Oo(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function xo(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Co(t){var e=t.a.F.a;if(null!=e)Si(4),e?(Si(10),Es(t.a,t,!1)):(Si(11),Es(t.a,t,!0));else{t.b=new Fi(t,void 0,void 0),t.b.h=t.h,e=Ns(e=t.a,e.Y()?t.f:null,t.i),Si(4),vo(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&po(e,n,r),$i(t.b,e,!1,t.f)}}function Po(){this.a=this.b=null}function Lo(){this.a=new no}function Mo(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[qn]||(t[qn]=++zn)):e.charAt(0)+t}function Uo(t,e){this.b=t,this.a=e}function jo(t){this.g=t||Bo,Cn.PerformanceNavigationTiming?t=0<(t=Cn.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(Cn.ka&&Cn.ka.Da&&Cn.ka.Da()&&Cn.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Lo),this.b=null,this.c=[]}(Rn=Ao.prototype).add=function(t,e){No(this),this.c=null,t=Oo(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},Rn.forEach=function(t,e){No(this),this.a.forEach((function(n,r){Xn(n,(function(n){t.call(e,n,r,this)}),this)}),this)},Rn.K=function(){No(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Rn.C=function(t){No(this);var e=[];if(Pn(t))ko(this,t)&&(e=Zn(e,this.a.get(Oo(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=Zn(e,t[n])}return e},Rn.set=function(t,e){return No(this),this.c=null,ko(this,t=Oo(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},Rn.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},Rn.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")},Qn((function(){}),(function(){})),(Rn=xo.prototype).M=null,Rn.$=function(t){return this.a.$(t)},Rn.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},Rn.Ca=function(){return!1},Rn.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=cs(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=cs(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void Ts(e,2)}this.f=r[0]}else(e=this.a).m=this.c,Ts(e,2)}else 1==this.M&&(this.g?Si(6):"11111"==e?(Si(5),this.g=!0,(!yr||10<=Number(Ar))&&(this.c=200,this.b.cancel(),Si(11),Es(this.a,this,!0))):(Si(7),this.g=!1))},Rn.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Co(this)):1==this.M&&(this.g?(Si(11),Es(this.a,this,!0)):(Si(10),Es(this.a,this,!1)));else{0==this.M?Si(8):1==this.M&&Si(9);var t=this.a;t.m=this.c,Ts(t,2)}},Rn.Y=function(){return this.a.Y()},Rn.ma=function(){return this.a.ma()},Lo.prototype.add=function(t){this.a.set(Mo(t),t)},Lo.prototype.C=function(){return this.a.C()};var Bo=10;function Fo(t,e){!t.a&&(ir(e,"spdy")||ir(e,"quic")||ir(e,"h2"))&&(t.f=t.g,t.a=new Lo,t.b&&(Go(t,t.b),t.b=null))}function Vo(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function qo(t){return t.b?1:t.a?t.a.a.c:0}function zo(t,e){return t.b?t=t.b==e:t.a?(e=Mo(e),t=oo(t.a.a.b,e)):t=!1,t}function Go(t,e){t.a?t.a.add(e):t.b=e}function $o(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Mo(e),n=oo(t.a.a.b,n)),n&&ro(t.a.a,Mo(e)))}function Wo(t){if(null!=t.b)return t.c.concat(t.b.j);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return Xn(t.a.C(),(function(t){e=e.concat(t.j)})),e}return tr(t.c)}function Yo(){}function Ho(){this.a=new Yo}function Qo(t,e,n){var r=n||"";try{eo(t,(function(t,n){var i=t;Vn(t)&&(i=ei(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Ko(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}jo.prototype.cancel=function(){this.c=Wo(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(Xn(this.a.C(),(function(t){t.cancel()})),function(t){t.b={},t.a.length=0,t.c=0}(this.a.a))},Yo.prototype.stringify=function(t){return Cn.JSON.stringify(t,void 0)},Yo.prototype.parse=function(t){return Cn.JSON.parse(t,void 0)};var Jo=Cn.JSON.parse;function Xo(t){Zr.call(this),this.headers=new no,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Zo,this.D=this.F=!1}Qn(Xo,Zr);var Zo="",ts=/^https?$/i,es=["POST","PUT"];function ns(t){return"content-type"==t.toLowerCase()}function rs(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,is(t),ss(t)}function is(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function os(t){if(t.b&&void 0!==xn&&(!t.s[1]||4!=us(t)||2!=t.T()))if(t.l&&4==us(t))vi(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==us(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.A).match(so)[1]||null;if(!o&&Cn.self&&Cn.self.location){var s=Cn.self.location.protocol;o=s.substr(0,s.length-1)}i=!ts.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<us(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.T()+"]",is(t)}}finally{ss(t)}}}function ss(t,e){if(t.a){as(t);var n=t.a,r=t.s[0]?Un:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function as(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(Cn.clearTimeout(t.m),t.m=null)}function us(t){return t.a?t.a.readyState:0}function cs(t,e){return t.a?t.a.getResponseHeader(e):null}function hs(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var e="";return ur(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),Pn(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if(0>(n=t.indexOf("#"))&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return po(t,e,n),t}function fs(t){this.f=[],this.F=new Po,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!Mn("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=Mn("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=Mn("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=Mn("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=Mn("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new jo(t&&t.concurrentRequestLimit),this.ja=new Ho,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function ls(t){if(ps(t),3==t.u){var e=t.P++,n=uo(t.B);po(n,"SID",t.H),po(n,"RID",e),po(n,"TYPE","terminate"),gs(t,n),(e=new Fi(t,e,void 0)).F=2,e.f=yo(uo(n)),n=!1,Cn.navigator&&Cn.navigator.sendBeacon&&(n=Cn.navigator.sendBeacon(e.f.toString(),"")),!n&&Cn.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=Hn(),Qi(e)}As(t)}function ps(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(Cn.clearTimeout(t.l),t.l=null),_s(t),t.b.cancel(),t.h&&(Ln(t.h)&&Cn.clearTimeout(t.h),t.h=null)}function ds(t,e){t.f.push(new Uo(t.Qa++,e)),3==t.u&&vs(t)}function vs(t){Vo(t.b)||t.h||(t.h=!0,ci(t.Ha,t),t.A=0)}function ys(t,e){var n;n=e?e.W:t.P++;var r=uo(t.B);po(r,"SID",t.H),po(r,"RID",n),po(r,"AID",t.O),gs(t,r),t.g&&t.i&&hs(r,t.g,t.i),n=new Fi(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=ms(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Go(t.b,n),Gi(n,r,e)}function gs(t,e){t.c&&eo({},(function(t,n){po(e,n,t)}))}function ms(t,e,n){n=Math.min(t.f.length,n);var r=t.c?Wn(t.c.Sa,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),a=!1;else try{Qo(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function ws(t){t.a||t.l||(t.S=1,ci(t.Ga,t),t.v=0)}function bs(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Ri(Wn(t.Ga,t),Is(t,t.v)),t.v++,!0)}function Es(t,e,n){var r=e.l;r&&Fo(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=Ns(t,null,t.ha),vs(t)}function _s(t){null!=t.s&&(Cn.clearTimeout(t.s),t.s=null)}function Is(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function Ts(t,e){if(2==e){var n=null;t.c&&(n=null);var r=Wn(t.eb,t);n||(n=new ao("//www.google.com/images/cleardot.gif"),Cn.location&&"http"==Cn.location.protocol||co(n,"https"),yo(n)),function(t,e){var n=new _i;if(Cn.Image){var r=new Image;r.onload=Yn(Ko,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Yn(Ko,n,r,"TestLoadImage: error",!1,e),r.onabort=Yn(Ko,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Yn(Ko,n,r,"TestLoadImage: timeout",!1,e),Cn.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else Si(2);t.u=0,t.c&&t.c.ta(e),As(t),ps(t)}function As(t){t.u=0,t.m=-1,t.c&&(0==Wo(t.b).length&&0==t.f.length||(t.b.c.length=0,tr(t.f),t.f.length=0),t.c.sa())}function Ns(t,e,n){var r=function(t){return t instanceof ao?uo(t):new ao(t,void 0)}(n);if(""!=r.b)e&&ho(r,e+"."+r.b),fo(r,r.i);else{var i,o=Cn.location;i=e?e+"."+o.hostname:o.hostname,r=function(t,e,n,r){var i=new ao(null,void 0);return t&&co(i,t),e&&ho(i,e),n&&fo(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return t.V&&ur(t.V,(function(t,e){po(r,e,t)})),e=t.j,n=t.I,e&&n&&po(r,e,n),po(r,"VER",t.wa),gs(t,r),r}function Ss(){}function ks(){if(yr&&!(10<=Number(Ar)))throw Error("Environmental error: no available transport.")}function Rs(t,e){Zr.call(this),this.a=new fs(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r,i=arguments[n];if(0==i.lastIndexOf("/",0))e=i;else(r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!er(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!er(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new xs(this)}function Ds(t){Ui.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Os(){ji.call(this),this.status=1}function xs(t){this.a=t}(Rn=Xo.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ci(this.H):Ci(Li),this.a.onreadystatechange=Wn(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void rs(this,t)}t=n||"";var i=new no(this.headers);r&&eo(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=ns,n=t.length,r=Pn(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:Pn(t)?t.charAt(e):t[e]}(i.K()),n=Cn.FormData&&t instanceof Cn.FormData,!(0<=Jn(es,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{as(this),0<this.o&&((this.D=function(t){return yr&&Sr(9)&&Ln(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=Wn(this.Ba,this)):this.m=vi(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){rs(this,t)}},Rn.Ba=function(){void 0!==xn&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},Rn.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ss(this))},Rn.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),ss(this,!0)),Xo.N.G.call(this)},Rn.Ea=function(){this.j||(this.w||this.l||this.g?os(this):this.Za())},Rn.Za=function(){os(this)},Rn.T=function(){try{return 2<us(this)?this.a.status:-1}catch(t){return-1}},Rn.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},Rn.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Jo(e)}},Rn.ya=function(){return this.h},Rn.Xa=function(){return Pn(this.f)?this.f:String(this.f)},(Rn=fs.prototype).wa=8,Rn.u=1,Rn.Ca=function(){return 0==this.u},Rn.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random());var e,n=new Fi(this,t=this.P++,void 0),r=this.i;if(this.J&&(r?fr(r=cr(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&Pn(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=ms(this,n,e),po(i=uo(this.B),"RID",t),po(i,"CVER",22),this.o&&this.j&&po(i,"X-HTTP-Session-Id",this.j),gs(this,i),this.g&&r&&hs(i,this.g,r),Go(this.b,n),this.W?(po(i,"$req",e),po(i,"SID","null"),n.S=!0,Gi(n,i,null)):Gi(n,i,e),this.u=2}}else 3==this.u&&(t?ys(this,t):0==this.f.length||Vo(this.b)||ys(this))},Rn.Ga=function(){this.l=null,this.a=new Fi(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=uo(this.pa);po(t,"RID","rpc"),po(t,"SID",this.H),po(t,"CI",this.ia?"0":"1"),po(t,"AID",this.O),gs(this,t),po(t,"TYPE","xmlhttp"),this.g&&this.i&&hs(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),$i(this.a,t,!0,this.ga)},Rn.Fa=function(t,e){if(0!=this.u&&(this.a==t||zo(this.b,t)))if(this.m=t.o,!t.s&&zo(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(Bn(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;_s(this),this.a.cancel(),this.a=null}bs(this),Si(18)}}else this.ra=e[1],0<this.ra-this.O&&37500>e[2]&&this.ia&&0==this.v&&!this.s&&(this.s=Ri(Wn(this.Ya,this),6e3));if(1>=qo(this.b)&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else Ts(this,11)}else if((t.s||this.a==t)&&_s(this),!er(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&Ln(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=cs(r,"X-Client-Wire-Protocol"))&&Fo(this.b,i),this.j&&(r=cs(r,"X-HTTP-Session-Id")))&&(this.I=r,po(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=Ns(this,this.Y()?this.ga:null,this.ha),r.s?($o(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(Ji(r),Qi(r)),this.a=r):ws(this),0<this.f.length&&vs(this)}else"stop"!=r[0]&&"close"!=r[0]||Ts(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Ts(this,7):ls(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},Rn.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,bs(this),Si(19))},Rn.na=function(t){var e=null;if(this.a==t){_s(this),this.a=null;var n=2}else{if(!zo(this.b,t))return;e=t.j,$o(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=Hn()-t.v,Ii.dispatchEvent(new ki(Ii,t.l?t.l.length:0,e,this.A)),vs(this)):ws(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(qo(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=e.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa))&&(t.h=Ri(Wn(t.Ha,t,e),Is(t,t.A)),t.A++,!0))}(this,t)||2==n&&bs(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:Ts(this,5);break;case 4:Ts(this,10);break;case 3:Ts(this,6);break;default:Ts(this,2)}}},Rn.eb=function(t){Si(t?2:1)},Rn.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new Xo(this.Ka)).F=this.R,t},Rn.ma=function(){return!!this.c&&!0},Rn.Y=function(){return this.R},(Rn=Ss.prototype).va=function(){},Rn.ua=function(){},Rn.ta=function(){},Rn.sa=function(){},Rn.Sa=function(){},ks.prototype.a=function(t,e){return new Rs(t,e)},Qn(Rs,Zr),(Rn=Rs.prototype).addEventListener=function(t,e,n,r){Rs.N.addEventListener.call(this,t,e,n,r)},Rn.removeEventListener=function(t,e,n,r){Rs.N.removeEventListener.call(this,t,e,n,r)},Rn.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;Si(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new xo(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=hs(e,t.g,t.i)),(t=t.w).i=n,e=Ns(t.a,null,t.i),Si(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Co(t)):(vo(e,"MODE","init"),!t.a.o&&t.a.j&&vo(e,"X-HTTP-Session-Id",t.a.j),t.b=new Fi(t,void 0,void 0),t.b.h=t.h,$i(t.b,e,!1,null),t.M=0)},Rn.close=function(){ls(this.a)},Rn.Wa=function(t){if(Pn(t)){var e={};e.__data__=t,ds(this.a,e)}else this.h?((e={}).__data__=ei(t),ds(this.a,e)):ds(this.a,t)},Rn.G=function(){this.a.c=null,delete this.f,ls(this.a),delete this.a,Rs.N.G.call(this)},Qn(Ds,Ui),Qn(Os,ji),Qn(xs,Ss),xs.prototype.va=function(){this.a.dispatchEvent("a")},xs.prototype.ua=function(t){this.a.dispatchEvent(new Ds(t))},xs.prototype.ta=function(t){this.a.dispatchEvent(new Os(t))},xs.prototype.sa=function(){this.a.dispatchEvent("b")};var Cs=Yn((function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r}),ks);ks.prototype.createWebChannel=ks.prototype.a,Rs.prototype.send=Rs.prototype.Wa,Rs.prototype.open=Rs.prototype.Va,Rs.prototype.close=Rs.prototype.close,Di.NO_ERROR=0,Di.TIMEOUT=8,Di.HTTP_ERROR=6,Oi.COMPLETE="complete",Pi.EventType=Mi,Mi.OPEN="a",Mi.CLOSE="b",Mi.ERROR="c",Mi.MESSAGE="d",Zr.prototype.listen=Zr.prototype.za,Xo.prototype.listenOnce=Xo.prototype.Aa,Xo.prototype.getLastError=Xo.prototype.Xa,Xo.prototype.getLastErrorCode=Xo.prototype.ya,Xo.prototype.getStatus=Xo.prototype.T,Xo.prototype.getResponseJson=Xo.prototype.Ua,Xo.prototype.getResponseText=Xo.prototype.aa,Xo.prototype.send=Xo.prototype.ca;var Ps={createWebChannelTransport:Cs,ErrorCode:Di,EventType:Oi,WebChannel:Pi,XhrIo:Xo},Ls=gt((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&"object"==typeof t&&"default"in t?t.default:t}(Ze),r=n.SDK_VERSION,i=function(){function t(t){this.uid=t}return t.prototype.t=function(){return null!=this.uid},t.prototype.i=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.u=new t("google-credentials-uid"),t.s=new t("first-party-uid"),t}(),o={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},s=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Fe.__extends(e,t),e}(Error),a=function(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t},u=function(){function t(){this.h=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.l=function(){},t.prototype.v=function(t){Te(!this.h,"Can only call setChangeListener() once."),this.h=t,t(i.UNAUTHENTICATED)},t.prototype.m=function(){Te(null!==this.h,"removeChangeListener() when no listener registered"),this.h=null},t}(),c=function(){function t(t){var e=this;this.p=null,this.currentUser=i.UNAUTHENTICATED,this.g=!1,this._=0,this.h=null,this.forceRefresh=!1,this.p=function(){e._++,e.currentUser=e.I(),e.g=!0,e.h&&e.h(e.currentUser)},this._=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.p):(this.p(null),t.get().then((function(t){e.auth=t,e.p&&e.auth.addAuthTokenListener(e.p)}),(function(){})))}return t.prototype.getToken=function(){var t=this;Te(null!=this.p,"getToken cannot be called after listener removed.");var e=this._,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){if(t._!==e)throw new s(o.ABORTED,"getToken aborted due to token change.");return n?(Te("string"==typeof n.accessToken,"Invalid tokenData returned from getToken():"+n),new a(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.l=function(){this.forceRefresh=!0},t.prototype.v=function(t){Te(!this.h,"Can only call setChangeListener() once."),this.h=t,this.g&&t(this.currentUser)},t.prototype.m=function(){Te(null!=this.p,"removeChangeListener() called twice"),Te(null!==this.h,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.p),this.p=null,this.h=null},t.prototype.I=function(){var t=this.auth&&this.auth.getUid();return Te(null===t||"string"==typeof t,"Received invalid UID: "+t),new i(t)},t}(),h=function(){function t(t,e){this.T=t,this.D=e,this.type="FirstParty",this.user=i.s}return Object.defineProperty(t.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.D},e=this.T.auth.R([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),t}(),f=function(){function t(t,e){this.T=t,this.D=e}return t.prototype.getToken=function(){return Promise.resolve(new h(this.T,this.D))},t.prototype.v=function(t){t(i.s)},t.prototype.m=function(){},t.prototype.l=function(){},t}();
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function l(t){if(!t)return new u;switch(t.type){case"gapi":var e=t.S;return Te(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new f(e,t.D||"0");case"provider":return t.S;default:throw new s(o.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var p=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new s(o.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new s(o.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new s(o.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new s(o.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.A=function(t){return this.seconds===t.seconds?Ne(this.nanoseconds,t.nanoseconds):Ne(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),d=function(){function t(t){this.timestamp=t}return t.C=function(e){var n=Math.floor(e/1e6);return new t(new p(n,e%1e6*1e3))},t.P=function(e){return new t(e)},t.V=function(){return t.MIN},t.prototype.k=function(t){return this.timestamp.A(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.N=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.O=function(){return this.timestamp},t.MIN=new t(new p(0,0)),t}(),v=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Ie("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&Ie("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.F(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.U(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.j=function(t){return t=void 0===t?1:t,Te(this.length>=t,"Can't call popFirst() with less segments"),this.U(this.segments,this.offset+t,this.length-t)},t.prototype.L=function(){return Te(!this.M(),"Can't call popLast() on empty path"),this.U(this.segments,this.offset,this.length-1)},t.prototype.q=function(){return Te(!this.M(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.B=function(){return this.get(this.length-1)},t.prototype.get=function(t){return Te(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.M=function(){return 0===this.length},t.prototype.G=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.K=function(){return this.segments.slice(this.offset,this.limit())},t.F=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe.__extends(e,t),e.prototype.U=function(t,n,r){return new e(t,n,r)},e.prototype.J=function(){return this.K().join("/")},e.prototype.toString=function(){return this.J()},e.H=function(t){if(t.indexOf("//")>=0)throw new s(o.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e.Y=new e([]),e}(v),g=/^[_a-zA-Z][_a-zA-Z0-9]*$/,m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe.__extends(e,t),e.prototype.U=function(t,n,r){return new e(t,n,r)},e.X=function(t){return g.test(t)},e.prototype.J=function(){return this.K().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.X(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.J()},e.prototype.$=function(){return 1===this.length&&"__name__"===this.get(0)},e.Z=function(){return new e(["__name__"])},e.tt=function(t){for(var n=[],r="",i=0,a=function(){if(0===r.length)throw new s(o.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},u=!1;i<t.length;){var c=t[i];if("\\"===c){if(i+1===t.length)throw new s(o.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var h=t[i+1];if("\\"!==h&&"."!==h&&"`"!==h)throw new s(o.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=h,i+=2}else"`"===c?(u=!u,i++):"."!==c||u?(r+=c,i++):(a(),i++)}if(a(),u)throw new s(o.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.Y=new e([]),e}(v),w=function(){function t(e){this.path=e,Te(t.nt(e),"Invalid DocumentKey with an odd number of segments: "+e.K().join("/"))}return t.it=function(e){return new t(y.H(e).j(5))},t.prototype.et=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===y.F(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.F=function(t,e){return y.F(t.path,e.path)},t.nt=function(t){return t.length%2==0},t.rt=function(e){return new t(new y(e.slice()))},t.EMPTY=new t(new y([])),t}(),b=function(){function t(t,e){this.F=t,this.root=e||_.EMPTY}return t.prototype.ut=function(e,n){return new t(this.F,this.root.ut(e,n,this.F).copy(null,null,_.st,null,null))},t.prototype.remove=function(e){return new t(this.F,this.root.remove(e,this.F).copy(null,null,_.st,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.M();){var n=this.F(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.M();){var r=this.F(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.M=function(){return this.root.M()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.ot=function(){return this.root.ot()},t.prototype.ht=function(){return this.root.ht()},t.prototype.ct=function(t){return this.root.ct(t)},t.prototype.forEach=function(t){this.ct((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ct((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.at=function(t){return this.root.at(t)},t.prototype.ft=function(){return new E(this.root,null,this.F,!1)},t.prototype.lt=function(t){return new E(this.root,t,this.F,!1)},t.prototype.dt=function(){return new E(this.root,null,this.F,!0)},t.prototype.vt=function(t){return new E(this.root,t,this.F,!0)},t}(),E=function(){function t(t,e,n,r){this.wt=r,this.pt=[];for(var i=1;!t.M();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.pt.push(t);break}this.pt.push(t),t=this.wt?t.right:t.left}}return t.prototype.bt=function(){Te(this.pt.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.pt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.M();)this.pt.push(t),t=t.right;else for(t=t.right;!t.M();)this.pt.push(t),t=t.left;return e},t.prototype.gt=function(){return this.pt.length>0},t.prototype.yt=function(){if(0===this.pt.length)return null;var t=this.pt[this.pt.length-1];return{key:t.key,value:t.value}},t}(),_=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.M=function(){return!1},t.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},t.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},t.prototype.min=function(){return this.left.M()?this:this.left.min()},t.prototype.ot=function(){return this.min().key},t.prototype.ht=function(){return this.right.M()?this.key:this.right.ht()},t.prototype.ut=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ut(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ut(t,e,n)))._t()},t.prototype.It=function(){if(this.left.M())return t.EMPTY;var e=this;return e.left.Tt()||e.left.left.Tt()||(e=e.Et()),(e=e.copy(null,null,null,e.left.It(),null))._t()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.M()||i.left.Tt()||i.left.left.Tt()||(i=i.Et()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Tt()&&(i=i.Dt()),i.right.M()||i.right.Tt()||i.right.left.Tt()||(i=i.Rt()),0===n(e,i.key)){if(i.right.M())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.It())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i._t()},t.prototype.Tt=function(){return this.color},t.prototype._t=function(){var t=this;return t.right.Tt()&&!t.left.Tt()&&(t=t.St()),t.left.Tt()&&t.left.left.Tt()&&(t=t.Dt()),t.left.Tt()&&t.right.Tt()&&(t=t.At()),t},t.prototype.Et=function(){var t=this.At();return t.right.left.Tt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Dt())).St()).At()),t},t.prototype.Rt=function(){var t=this.At();return t.left.left.Tt()&&(t=(t=t.Dt()).At()),t},t.prototype.St=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.Dt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.At=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ct=function(){var t=this.Pt();return Math.pow(2,t)<=this.size+1},t.prototype.Pt=function(){if(this.Tt()&&this.left.Tt())throw Ie("Red node has red child("+this.key+","+this.value+")");if(this.right.Tt())throw Ie("Right child of ("+this.key+","+this.value+") is red");var t=this.left.Pt();if(t!==this.right.Pt())throw Ie("Black depths differ");return t+(this.Tt()?0:1)},t.EMPTY=null,t.RED=!0,t.st=!1,t}(),I=function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Ie("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Ie("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Ie("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Ie("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Ie("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.ut=function(t,e,n){return new _(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.M=function(){return!0},t.prototype.ct=function(t){return!1},t.prototype.at=function(t){return!1},t.prototype.ot=function(){return null},t.prototype.ht=function(){return null},t.prototype.Tt=function(){return!1},t.prototype.Ct=function(){return!0},t.prototype.Pt=function(){return 0},t}();_.EMPTY=new I;
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var T=function(){function t(t){this.F=t,this.data=new b(this.F)}return t.Vt=function(e){var n=new t(e.F);return e.forEach((function(t){n=n.add(t)})),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.ot()},t.prototype.last=function(){return this.data.ht()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ct((function(e,n){return t(e),!1}))},t.prototype.kt=function(t,e){for(var n=this.data.lt(t[0]);n.gt();){var r=n.bt();if(this.F(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Nt=function(t,e){var n;for(n=void 0!==e?this.data.lt(e):this.data.ft();n.gt();)if(!t(n.bt().key))return},t.prototype.Ot=function(t){var e=this.data.lt(t);return e.gt()?e.bt().key:null},t.prototype.ft=function(){return new A(this.data.ft())},t.prototype.lt=function(t){return new A(this.data.lt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).ut(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.M=function(){return this.data.M()},t.prototype.Ft=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.ft(),r=e.data.ft();n.gt();){var i=n.bt().key,o=r.bt().key;if(0!==this.F(i,o))return!1}return!0},t.prototype.K=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.F);return n.data=e,n},t}(),A=function(){function t(t){this.Ut=t}return t.prototype.bt=function(){return this.Ut.bt().key},t.prototype.gt=function(){return this.Ut.gt()},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function N(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function S(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function k(t){for(var e in Te(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var R=function(){function t(t){this.jt=t}return t.fromBase64String=function(e){return new t(ye.xt().atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return ye.xt().btoa(this.jt)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(this.jt)},t.prototype.Lt=function(){return 2*this.jt.length},t.prototype.k=function(t){return Ne(this.jt,t.jt)},t.prototype.isEqual=function(t){return this.jt===t.jt},t.Mt=new t(""),t}();function D(t){return null==t}function O(t){return-0===t&&1/t==-1/0}function x(t){return"number"==typeof t&&Number.isInteger(t)&&!O(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function C(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function P(t){var e=q(t.mapValue.fields.__local_write_time__.timestampValue);return new p(e.seconds,e.nanos)}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var L=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function M(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?C(t)?4:10:Ie("Invalid value type: "+JSON.stringify(t))}function U(t,e){var n=M(t);if(n!==M(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return P(t).isEqual(P(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=q(t.timestampValue),r=q(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return G(t.bytesValue).isEqual(G(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return z(t.geoPointValue.latitude)===z(e.geoPointValue.latitude)&&z(t.geoPointValue.longitude)===z(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return z(t.integerValue)===z(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=z(t.doubleValue),r=z(e.doubleValue);return n===r?O(n)===O(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Se(t.arrayValue.values||[],e.arrayValue.values||[],U);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(N(n)!==N(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!U(n[i],r[i])))return!1;return!0}(t,e);default:return Ie("Unexpected value type: "+JSON.stringify(t))}}function j(t,e){return void 0!==(t.values||[]).find((function(t){return U(t,e)}))}function B(t,e){var n=M(t),r=M(e);if(n!==r)return Ne(n,r);switch(n){case 0:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=z(t.integerValue||t.doubleValue),r=z(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return F(t.timestampValue,e.timestampValue);case 4:return F(P(t),P(e));case 5:return Ne(t.stringValue,e.stringValue);case 6:return function(t,e){var n=G(t),r=G(e);return n.k(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ne(n[i],r[i]);if(0!==o)return o}return Ne(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Ne(z(t.latitude),z(e.latitude));return 0!==n?n:Ne(z(t.longitude),z(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=B(n[i],r[i]);if(o)return o}return Ne(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Ne(r[s],o[s]);if(0!==a)return a;var u=B(n[r[s]],i[o[s]]);if(0!==u)return u}return Ne(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ie("Invalid value type: "+n)}}function F(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ne(t,e);var n=q(t),r=q(e),i=Ne(n.seconds,r.seconds);return 0!==i?i:Ne(n.nanos,r.nanos)}function V(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(i=e.timestampValue,"time("+(o=q(i)).seconds+","+o.nanos+")"):"stringValue"in e?e.stringValue:"bytesValue"in e?G(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,w.it(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):Ie("Invalid value type: "+JSON.stringify(e));var n,r,i,o}(t)}function q(t){if(Te(!!t,"Cannot normalize null or undefined timestamp."),"string"==typeof t){var e=0,n=L.exec(t);if(Te(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:z(t.seconds),nanos:e=z(t.nanos)}}function z(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function G(t){return"string"==typeof t?R.fromBase64String(t):R.fromUint8Array(t)}function $(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function W(t){return!!t&&"integerValue"in t}function Y(t){return W(t)||function(t){return!!t&&"doubleValue"in t}(t)}function H(t){return!!t&&"arrayValue"in t}function Q(t){return!!t&&"referenceValue"in t}function K(t){return!!t&&"nullValue"in t}function J(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function X(t){return!!t&&"mapValue"in t}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Z=function(){function t(){}return t.prototype.qt=function(t,e){return function(t,e){var n,r={fields:(n={},n.__type__={stringValue:"server_timestamp"},n.__local_write_time__={timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}},n)};return e&&(r.fields.__previous_value__=e),{mapValue:r}}(e,t)},t.prototype.Bt=function(t,e){return e},t.prototype.Qt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),tt=function(){function t(t){this.elements=t}return t.prototype.qt=function(t,e){return this.apply(t)},t.prototype.Bt=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=rt(t),n=function(t){e.some((function(e){return U(e,t)}))||e.push(t)},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.Qt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Se(this.elements,e.elements,U)},t}(),et=function(){function t(t){this.elements=t}return t.prototype.qt=function(t,e){return this.apply(t)},t.prototype.Bt=function(t,e){return this.apply(t)},t.prototype.apply=function(t){for(var e=rt(t),n=function(t){e=e.filter((function(e){return!U(e,t)}))},r=0,i=this.elements;r<i.length;r++)n(i[r]);return{arrayValue:{values:e}}},t.prototype.Qt=function(t){return null},t.prototype.isEqual=function(e){return e instanceof t&&Se(this.elements,e.elements,U)},t}(),nt=function(){function t(t,e){this.serializer=t,this.Gt=e,Te(Y(e),"NumericIncrementTransform transform requires a NumberValue")}return t.prototype.qt=function(t,e){var n=this.Qt(t),r=this.asNumber(n)+this.asNumber(this.Gt);return W(n)&&W(this.Gt)?this.serializer.Wt(r):this.serializer.zt(r)},t.prototype.Bt=function(t,e){return Te(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},t.prototype.Qt=function(t){return Y(t)?t:{integerValue:0}},t.prototype.isEqual=function(e){return e instanceof t&&U(this.Gt,e.Gt)},t.prototype.asNumber=function(t){return z(t.integerValue||t.doubleValue)},t}();function rt(t){return H(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var it,ot,st=function(){function t(t){this.fields=t}return t.Kt=function(e){return new t(e)},t.Jt=function(e){var n=new T(m.F);return e.forEach((function(t){return n=n.add(t)})),new t(n)},t.prototype.Ht=function(t){var e=!1;return this.fields.forEach((function(n){n.G(t)&&(e=!0)})),e},t.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},t}(),at=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),ut=function(t,e){this.version=t,this.transformResults=e},ct=function(){function t(t,e){this.updateTime=t,this.exists=e,Te(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Yt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.Xt=function(t){return void 0!==this.updateTime?t instanceof wt&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof wt:(Te(this.Yt,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,!((null!=e?!n||!e.isEqual(n):e!==n)||this.exists!==t.exists);var e,n},t.NONE=new t,t}(),ht=function(){function t(){}return t.prototype.$t=function(t){null!=t&&Te(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.Zt=function(t){return t instanceof wt?t.version:d.MIN},t}(),ft=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.tn=r,i.type=0,i}return Fe.__extends(e,t),e.prototype.Bt=function(t,e){this.$t(t),Te(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new wt(this.key,n,this.value,{hasCommittedMutations:!0})},e.prototype.qt=function(t,e,n){if(this.$t(t),!this.tn.Xt(t))return t;var r=ht.Zt(t);return new wt(this.key,r,this.value,{nn:!0})},e.prototype.in=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.tn.isEqual(t.tn)},e}(ht),lt=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.en=r,o.tn=i,o.type=1,o}return Fe.__extends(e,t),e.prototype.Bt=function(t,e){if(this.$t(t),Te(null==e.transformResults,"Transform results received by PatchMutation."),!this.tn.Xt(t))return new Et(this.key,e.version);var n=this.rn(t);return new wt(this.key,e.version,n,{hasCommittedMutations:!0})},e.prototype.qt=function(t,e,n){if(this.$t(t),!this.tn.Xt(t))return t;var r=ht.Zt(t),i=this.rn(t);return new wt(this.key,r,i,{nn:!0})},e.prototype.in=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.en.isEqual(t.en)&&this.tn.isEqual(t.tn)},e.prototype.rn=function(t){var e;return e=t instanceof wt?t.data():yt.EMPTY,this.un(e)},e.prototype.un=function(t){var e=this,n=t.sn();return this.en.fields.forEach((function(t){if(!t.M()){var r=e.data.field(t);null!==r?n.set(t,r):n.delete(t)}})),n.on()},e}(ht),pt=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=2,r.tn=ct.exists(!0),r}return Fe.__extends(e,t),e.prototype.Bt=function(t,e){if(this.$t(t),Te(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.tn.Xt(t))return new Et(this.key,e.version);var n=this.hn(t),r=this.cn(t,e.transformResults),i=e.version,o=this.an(n.data(),r);return new wt(this.key,i,o,{hasCommittedMutations:!0})},e.prototype.qt=function(t,e,n){if(this.$t(t),!this.tn.Xt(t))return t;var r=this.hn(t),i=this.fn(n,t,e),o=this.an(r.data(),i);return new wt(this.key,r.version,o,{nn:!0})},e.prototype.in=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof wt?t.field(i.field):void 0,s=i.transform.Qt(o||null);null!=s&&(e=null==e?yt.ln().set(i.field,s):e.set(i.field,s))}return e?e.on():null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&Se(this.fieldTransforms,t.fieldTransforms,(function(t,e){return t.isEqual(e)}))&&this.tn.isEqual(t.tn)},e.prototype.hn=function(t){return Te(t instanceof wt,"Unknown MaybeDocument type "+t),Te(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},e.prototype.cn=function(t,e){var n=[];Te(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof wt&&(s=t.field(i.field)),n.push(o.Bt(s,e[r]))}return n},e.prototype.fn=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],a=s.transform,u=null;e instanceof wt&&(u=e.field(s.field)),null===u&&n instanceof wt&&(u=n.field(s.field)),r.push(a.qt(u,t))}return r},e.prototype.an=function(t,e){Te(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=t.sn(),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.on()},e}(ht),dt=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.tn=n,r.type=3,r}return Fe.__extends(e,t),e.prototype.Bt=function(t,e){return this.$t(t),Te(null==e.transformResults,"Transform results received by DeleteMutation."),new bt(this.key,e.version,{hasCommittedMutations:!0})},e.prototype.qt=function(t,e,n){return this.$t(t),this.tn.Xt(t)?(t&&Te(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new bt(this.key,d.V())):t},e.prototype.in=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.tn.isEqual(t.tn)},e}(ht),vt=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.tn=n,r.type=4,r}return Fe.__extends(e,t),e.prototype.Bt=function(t,e){Ie("VerifyMutation should only be used in Transactions.")},e.prototype.qt=function(t,e,n){Ie("VerifyMutation should only be used in Transactions.")},e.prototype.in=function(t){Ie("VerifyMutation should only be used in Transactions.")},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.tn.isEqual(t.tn)},e}(ht),yt=function(){function t(t){this.proto=t,Te(!C(t),"ServerTimestamps should be converted to ServerTimestampValue")}return t.ln=function(){return t.EMPTY.sn()},t.prototype.field=function(t){if(t.M())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!X(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.B()])||null},t.prototype.en=function(){return this.dn(this.proto.mapValue)},t.prototype.dn=function(t){var e=this,n=new T(m.F);return S(t.fields||{},(function(t,r){var i=new m([t]);if(10===M(r)){var o=e.dn(r.mapValue).fields;o.M()?n=n.add(i):o.forEach((function(t){n=n.add(i.child(t))}))}else n=n.add(i)})),st.Kt(n)},t.prototype.isEqual=function(t){return U(this.proto,t.proto)},t.prototype.sn=function(){return new gt(this)},t.EMPTY=new t({mapValue:{}}),t}(),gt=function(){function t(t){this.vn=t,this.wn=new Map}return t.prototype.set=function(t,e){return Te(!t.M(),"Cannot set field for empty path on ObjectValue"),this.mn(t,e),this},t.prototype.delete=function(t){return Te(!t.M(),"Cannot delete field for empty path on ObjectValue"),this.mn(t,null),this},t.prototype.mn=function(t,e){for(var n=this.wn,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===M(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.B(),e)},t.prototype.on=function(){var t=this.pn(m.Y,this.wn);return null!=t?new yt(t):this.vn},t.prototype.pn=function(t,e){var n=this,r=!1,i=this.vn.field(t),o=X(i)?Fe.__assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.pn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}(),mt=function(){function t(t,e){this.key=t,this.version=e}return t.bn=function(t,e){return w.F(t.key,e.key)},t}(),wt=function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o.gn=r,o.nn=!!i.nn,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return Fe.__extends(e,t),e.prototype.field=function(t){return this.gn.field(t)},e.prototype.data=function(){return this.gn},e.prototype.yn=function(){return this.gn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.nn===t.nn&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gn.isEqual(t.gn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gn.toString()+", {hasLocalMutations: "+this.nn+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.nn||this.hasCommittedMutations},enumerable:!0,configurable:!0}),e._n=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?B(r,i):Ie("Trying to compare documents on fields that don't exist")},e}(mt),bt=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;return i.hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return Fe.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(mt),Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(mt),_t=function(){function t(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.In=null}return t.prototype.canonicalId=function(){if(null===this.In){var t=this.path.J();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map((function(t){return t.canonicalId()})).join(","),t+="|ob:",t+=this.orderBy.map((function(t){return t.canonicalId()})).join(","),D(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.In=t}return this.In},t.prototype.toString=function(){var t=this.path.J();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),D(this.limit)||(t+=", limit: "+this.limit),this.orderBy.length>0&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},t.prototype.Tn=function(){return w.nt(this.path)&&null===this.collectionGroup&&0===this.filters.length},t}(),It=function(){function t(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.En=n,this.filters=r,this.limit=i,this.Dn=o,this.startAt=s,this.endAt=a,this.Rn=null,this.Sn=null,this.startAt&&this.An(this.startAt),this.endAt&&this.An(this.endAt)}return t.Cn=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.Rn){var t=this.Pn(),e=this.Vn();if(null!==t&&null===e)t.$()?this.Rn=[Pt]:this.Rn=[new Ct(t),Pt];else{Te(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.Rn=[];for(var n=!1,r=0,i=this.En;r<i.length;r++){var o=i[r];this.Rn.push(o),o.field.$()&&(n=!0)}if(!n){var s=this.En.length>0?this.En[this.En.length-1].dir:Ot.ASCENDING;this.Rn.push(s===Ot.ASCENDING?Pt:Lt)}}}return this.Rn},enumerable:!0,configurable:!0}),t.prototype.kn=function(e){Te(null==this.Pn()||!(e instanceof At)||!e.Nn()||e.field.isEqual(this.Pn()),"Query must only have one inequality field."),Te(!this.Tn(),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.collectionGroup,this.En.slice(),n,this.limit,this.Dn,this.startAt,this.endAt)},t.prototype.On=function(e){Te(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.En.concat([e]);return new t(this.path,this.collectionGroup,n,this.filters.slice(),this.limit,this.Dn,this.startAt,this.endAt)},t.prototype.Fn=function(e){return new t(this.path,this.collectionGroup,this.En.slice(),this.filters.slice(),e,"F",this.startAt,this.endAt)},t.prototype.Un=function(e){return new t(this.path,this.collectionGroup,this.En.slice(),this.filters.slice(),e,"L",this.startAt,this.endAt)},t.prototype.jn=function(e){return new t(this.path,this.collectionGroup,this.En.slice(),this.filters.slice(),this.limit,this.Dn,e,this.endAt)},t.prototype.xn=function(e){return new t(this.path,this.collectionGroup,this.En.slice(),this.filters.slice(),this.limit,this.Dn,this.startAt,e)},t.prototype.Ln=function(e){return new t(e,null,this.En.slice(),this.filters.slice(),this.limit,this.Dn,this.startAt,this.endAt)},t.prototype.Mn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.En.length||1===this.En.length&&this.En[0].field.$())},t.prototype.canonicalId=function(){return this.qn().canonicalId()+"|lt:"+this.Dn},t.prototype.toString=function(){return"Query(target="+this.qn().toString()+"; limitType="+this.Dn+")"},t.prototype.isEqual=function(t){return this.qn().isEqual(t.qn())&&this.Dn===t.Dn},t.prototype.Bn=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.$()}return Te(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.Qn(t)&&this.Gn(t)&&this.Wn(t)&&this.zn(t)},t.prototype.Kn=function(){return!D(this.limit)&&"F"===this.Dn},t.prototype.Jn=function(){return!D(this.limit)&&"L"===this.Dn},t.prototype.Vn=function(){return this.En.length>0?this.En[0].field:null},t.prototype.Pn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof At&&n.Nn())return n.field}return null},t.prototype.Hn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof At&&t.indexOf(r.op)>=0)return r.op}return null},t.prototype.Tn=function(){return this.qn().Tn()},t.prototype.Yn=function(){return null!==this.collectionGroup},t.prototype.qn=function(){if(!this.Sn)if("F"===this.Dn)this.Sn=new _t(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===Ot.DESCENDING?Ot.ASCENDING:Ot.DESCENDING;t.push(new Ct(r.field,i))}var o=this.endAt?new xt(this.endAt.position,!this.endAt.before):null,s=this.startAt?new xt(this.startAt.position,!this.startAt.before):null;this.Sn=new _t(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Sn},t.prototype.Qn=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.G(e):w.nt(this.path)?this.path.isEqual(e):this.path.W(e)},t.prototype.Gn=function(t){for(var e=0,n=this.En;e<n.length;e++){var r=n[e];if(!r.field.$()&&null===t.field(r.field))return!1}return!0},t.prototype.Wn=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},t.prototype.zn=function(t){return!(this.startAt&&!this.startAt.Xn(this.orderBy,t)||this.endAt&&this.endAt.Xn(this.orderBy,t))},t.prototype.An=function(t){Te(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),Tt=function(){function t(t){this.name=t}return t.H=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;case"in":return t.IN;case"array-contains-any":return t.ARRAY_CONTAINS_ANY;default:return Ie("Unknown FieldFilter operator: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t.IN=new t("in"),t.ARRAY_CONTAINS_ANY=new t("array-contains-any"),t}(),At=function(t){function e(e,n,r){var i=t.call(this)||this;return i.field=e,i.op=n,i.value=r,i}return Fe.__extends(e,t),e.create=function(t,n,r){if(t.$())return n===Tt.IN?(Te(H(r),"Comparing on key with IN, but filter value not an ArrayValue"),Te((r.arrayValue.values||[]).every((function(t){return Q(t)})),"Comparing on key with IN, but an array value was not a RefValue"),new St(t,r)):(Te(Q(r),"Comparing on key, but filter value not a RefValue"),Te(n!==Tt.ARRAY_CONTAINS&&n!==Tt.ARRAY_CONTAINS_ANY,"'"+n.toString()+"' queries don't make sense on document keys."),new Nt(t,n,r));if(K(r)){if(n!==Tt.EQUAL)throw new s(o.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(J(r)){if(n!==Tt.EQUAL)throw new s(o.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return n===Tt.ARRAY_CONTAINS?new kt(t,r):n===Tt.IN?(Te(H(r),"IN filter has invalid value: "+r.toString()),new Rt(t,r)):n===Tt.ARRAY_CONTAINS_ANY?(Te(H(r),"ARRAY_CONTAINS_ANY filter has invalid value: "+r.toString()),new Dt(t,r)):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&M(this.value)===M(e)&&this.$n(B(e,this.value))},e.prototype.$n=function(t){switch(this.op){case Tt.LESS_THAN:return t<0;case Tt.LESS_THAN_OR_EQUAL:return t<=0;case Tt.EQUAL:return 0===t;case Tt.GREATER_THAN:return t>0;case Tt.GREATER_THAN_OR_EQUAL:return t>=0;default:return Ie("Unknown FieldFilter operator: "+this.op)}},e.prototype.Nn=function(){return[Tt.LESS_THAN,Tt.LESS_THAN_OR_EQUAL,Tt.GREATER_THAN,Tt.GREATER_THAN_OR_EQUAL].indexOf(this.op)>=0},e.prototype.canonicalId=function(){return this.field.J()+this.op.toString()+V(this.value)},e.prototype.isEqual=function(t){return t instanceof e&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&U(this.value,t.value)},e.prototype.toString=function(){return this.field.J()+" "+this.op+" "+V(this.value)},e}((function(){})),Nt=function(t){function e(e,n,r){var i=t.call(this,e,n,r)||this;return Te(Q(r),"KeyFieldFilter expects a ReferenceValue"),i.key=w.it(r.referenceValue),i}return Fe.__extends(e,t),e.prototype.matches=function(t){var e=w.F(t.key,this.key);return this.$n(e)},e}(At),St=function(t){function e(e,n){var r=t.call(this,e,Tt.IN,n)||this;return Te(H(n),"KeyFieldInFilter expects an ArrayValue"),r.keys=(n.arrayValue.values||[]).map((function(t){return Te(Q(t),"Comparing on key with IN, but an array value was not a ReferenceValue"),w.it(t.referenceValue)})),r}return Fe.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(At),kt=function(t){function e(e,n){return t.call(this,e,Tt.ARRAY_CONTAINS,n)||this}return Fe.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return H(e)&&j(e.arrayValue,this.value)},e}(At),Rt=function(t){function e(e,n){var r=t.call(this,e,Tt.IN,n)||this;return Te(H(n),"InFilter expects an ArrayValue"),r}return Fe.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&j(this.value.arrayValue,e)},e}(At),Dt=function(t){function e(e,n){var r=t.call(this,e,Tt.ARRAY_CONTAINS_ANY,n)||this;return Te(H(n),"ArrayContainsAnyFilter expects an ArrayValue"),r}return Fe.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!H(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return j(e.value.arrayValue,t)}))},e}(At),Ot=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),xt=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map((function(t){return V(t)})).join(",")},t.prototype.Xn=function(t,e){Te(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.$())Te(Q(o),"Bound has a non-key value where the key path is being used."),n=w.F(w.it(o.referenceValue),e.key);else{var s=e.field(i.field);Te(null!==s,"Field should exist since document matched the orderBy already."),n=B(o,s)}if(i.dir===Ot.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!U(this.position[e],t.position[e]))return!1;return!0},t}(),Ct=function(){function t(t,e){this.field=t,void 0===e&&(e=Ot.ASCENDING),this.dir=e,this.Zn=t.$()}return t.prototype.compare=function(t,e){var n=this.Zn?wt.bn(t,e):wt._n(this.field,t,e);switch(this.dir){case Ot.ASCENDING:return n;case Ot.DESCENDING:return-1*n;default:return Ie("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.J()+this.dir.toString()},t.prototype.toString=function(){return this.field.J()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),Pt=new Ct(m.Z(),Ot.ASCENDING),Lt=new Ct(m.Z(),Ot.DESCENDING),Mt=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=d.MIN),void 0===o&&(o=d.MIN),void 0===s&&(s=R.Mt),this.target=t,this.targetId=e,this.ti=n,this.sequenceNumber=r,this.ni=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.ii=function(e){return new t(this.target,this.targetId,this.ti,e,this.ni,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.ei=function(e,n){return new t(this.target,this.targetId,this.ti,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.ri=function(e){return new t(this.target,this.targetId,this.ti,this.sequenceNumber,this.ni,e,this.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.ti===t.ti&&this.sequenceNumber===t.sequenceNumber&&this.ni.isEqual(t.ni)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken.isEqual(t.resumeToken)&&this.target.isEqual(t.target)},t}(),Ut=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}();function jt(t){switch(t){case o.OK:return Ie("Treated status OK as error");case o.CANCELLED:case o.UNKNOWN:case o.DEADLINE_EXCEEDED:case o.RESOURCE_EXHAUSTED:case o.INTERNAL:case o.UNAVAILABLE:case o.UNAUTHENTICATED:return!1;case o.INVALID_ARGUMENT:case o.NOT_FOUND:case o.ALREADY_EXISTS:case o.PERMISSION_DENIED:case o.FAILED_PRECONDITION:case o.ABORTED:case o.OUT_OF_RANGE:case o.UNIMPLEMENTED:case o.DATA_LOSS:return!0;default:return Ie("Unknown status code: "+t)}}function Bt(t){if(void 0===t)return Ee("GRPC error has no .code"),o.UNKNOWN;switch(t){case it.OK:return o.OK;case it.CANCELLED:return o.CANCELLED;case it.UNKNOWN:return o.UNKNOWN;case it.DEADLINE_EXCEEDED:return o.DEADLINE_EXCEEDED;case it.RESOURCE_EXHAUSTED:return o.RESOURCE_EXHAUSTED;case it.INTERNAL:return o.INTERNAL;case it.UNAVAILABLE:return o.UNAVAILABLE;case it.UNAUTHENTICATED:return o.UNAUTHENTICATED;case it.INVALID_ARGUMENT:return o.INVALID_ARGUMENT;case it.NOT_FOUND:return o.NOT_FOUND;case it.ALREADY_EXISTS:return o.ALREADY_EXISTS;case it.PERMISSION_DENIED:return o.PERMISSION_DENIED;case it.FAILED_PRECONDITION:return o.FAILED_PRECONDITION;case it.ABORTED:return o.ABORTED;case it.OUT_OF_RANGE:return o.OUT_OF_RANGE;case it.UNIMPLEMENTED:return o.UNIMPLEMENTED;case it.DATA_LOSS:return o.DATA_LOSS;default:return Ie("Unknown status code: "+t)}}(ot=it||(it={}))[ot.OK=0]="OK",ot[ot.CANCELLED=1]="CANCELLED",ot[ot.UNKNOWN=2]="UNKNOWN",ot[ot.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ot[ot.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ot[ot.NOT_FOUND=5]="NOT_FOUND",ot[ot.ALREADY_EXISTS=6]="ALREADY_EXISTS",ot[ot.PERMISSION_DENIED=7]="PERMISSION_DENIED",ot[ot.UNAUTHENTICATED=16]="UNAUTHENTICATED",ot[ot.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ot[ot.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ot[ot.ABORTED=10]="ABORTED",ot[ot.OUT_OF_RANGE=11]="OUT_OF_RANGE",ot[ot.UNIMPLEMENTED=12]="UNIMPLEMENTED",ot[ot.INTERNAL=13]="INTERNAL",ot[ot.UNAVAILABLE=14]="UNAVAILABLE",ot[ot.DATA_LOSS=15]="DATA_LOSS";
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
var Ft=new b(w.F);function Vt(){return Ft}function qt(){return Vt()}var zt=new b(w.F);function Gt(){return zt}var $t=new b(w.F);function Wt(){return $t}var Yt=new T(w.F);function Ht(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Yt,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Qt=new T(Ne);function Kt(){return Qt}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Jt=function(){function t(t){this.F=t?function(e,n){return t(e,n)||w.F(e.key,n.key)}:function(t,e){return w.F(t.key,e.key)},this.ui=Gt(),this.si=new b(this.F)}return t.oi=function(e){return new t(e.F)},t.prototype.has=function(t){return null!=this.ui.get(t)},t.prototype.get=function(t){return this.ui.get(t)},t.prototype.first=function(){return this.si.ot()},t.prototype.last=function(){return this.si.ht()},t.prototype.M=function(){return this.si.M()},t.prototype.indexOf=function(t){var e=this.ui.get(t);return e?this.si.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.si.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.si.ct((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ui.ut(t.key,t),e.si.ut(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ui.remove(t),this.si.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.si.ft(),r=e.si.ft();n.gt();){var i=n.bt().key,o=r.bt().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.F=this.F,r.ui=e,r.si=n,r},t}(),Xt=function(){function t(){this.hi=new b(w.F)}return t.prototype.track=function(t){var e=t.doc.key,n=this.hi.get(e);n?0!==t.type&&3===n.type?this.hi=this.hi.ut(e,t):3===t.type&&1!==n.type?this.hi=this.hi.ut(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.hi=this.hi.ut(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.hi=this.hi.ut(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.hi=this.hi.remove(e):1===t.type&&2===n.type?this.hi=this.hi.ut(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.hi=this.hi.ut(e,{type:2,doc:t.doc}):Ie("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.hi=this.hi.ut(e,t)},t.prototype.ci=function(){var t=[];return this.hi.ct((function(e,n){t.push(n)})),t},t}(),Zt=function(){function t(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.ai=n,this.docChanges=r,this.fi=i,this.fromCache=o,this.li=s,this.di=a}return t.vi=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Jt.oi(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.fi.M()},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.li===t.li&&this.fi.isEqual(t.fi)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ai.isEqual(t.ai)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),te=function(){function t(t,e,n,r,i){this.ni=t,this.wi=e,this.mi=n,this.pi=r,this.bi=i}return t.gi=function(e,n){var r=new Map;return r.set(e,ee.yi(e,n)),new t(d.MIN,r,Kt(),Vt(),Ht())},t}(),ee=function(){function t(t,e,n,r,i){this.resumeToken=t,this._i=e,this.Ii=n,this.Ti=r,this.Ei=i}return t.yi=function(e,n){return new t(R.Mt,n,Ht(),Ht(),Ht())},t}(),ne=function(t,e,n,r){this.Di=t,this.removedTargetIds=e,this.key=n,this.Ri=r},re=function(t,e){this.targetId=t,this.Si=e},ie=function(t,e,n,r){void 0===n&&(n=R.Mt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},oe=function(){function t(){this.Ai=0,this.Ci=ue(),this.Pi=R.Mt,this.Vi=!1,this.ki=!0}return Object.defineProperty(t.prototype,"_i",{get:function(){return this.Vi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Pi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Ni",{get:function(){return 0!==this.Ai},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oi",{get:function(){return this.ki},enumerable:!0,configurable:!0}),t.prototype.Fi=function(t){t.Lt()>0&&(this.ki=!0,this.Pi=t)},t.prototype.Ui=function(){var t=Ht(),e=Ht(),n=Ht();return this.Ci.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Ie("Encountered invalid change type: "+i)}})),new ee(this.Pi,this.Vi,t,e,n)},t.prototype.ji=function(){this.ki=!1,this.Ci=ue()},t.prototype.xi=function(t,e){this.ki=!0,this.Ci=this.Ci.ut(t,e)},t.prototype.Li=function(t){this.ki=!0,this.Ci=this.Ci.remove(t)},t.prototype.Mi=function(){this.Ai+=1},t.prototype.qi=function(){this.Ai-=1},t.prototype.Bi=function(){this.ki=!0,this.Vi=!0},t}(),se=function(){function t(t){this.Qi=t,this.Gi=new Map,this.Wi=Vt(),this.zi=ae(),this.Ki=new T(Ne)}return t.prototype.Ji=function(t){for(var e=0,n=t.Di;e<n.length;e++){var r=n[e];t.Ri instanceof wt?this.Hi(r,t.Ri):t.Ri instanceof bt&&this.Yi(r,t.key,t.Ri)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Yi(r,t.key,t.Ri)},t.prototype.Xi=function(t){var e=this;this.$i(t,(function(n){var r=e.Zi(n);switch(t.state){case 0:e.te(n)&&r.Fi(t.resumeToken);break;case 1:r.qi(),r.Ni||r.ji(),r.Fi(t.resumeToken);break;case 2:r.qi(),r.Ni||e.removeTarget(n),Te(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case 3:e.te(n)&&(r.Bi(),r.Fi(t.resumeToken));break;case 4:e.te(n)&&(e.ne(n),r.Fi(t.resumeToken));break;default:Ie("Unknown target watch change state: "+t.state)}}))},t.prototype.$i=function(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Gi.forEach((function(t,n){return e(n)}))},t.prototype.ie=function(t){var e=t.targetId,n=t.Si.count,r=this.ee(e);if(r){var i=r.target;if(i.Tn())if(0===n){var o=new w(i.path);this.Yi(e,o,new bt(o,d.V()))}else Te(1===n,"Single document existence filter with count: "+n);else this.re(e)!==n&&(this.ne(e),this.Ki=this.Ki.add(e))}},t.prototype.ue=function(t){var e=this,n=new Map;this.Gi.forEach((function(r,i){var o=e.ee(i);if(o){if(r._i&&o.target.Tn()){var s=new w(o.target.path);null!==e.Wi.get(s)||e.se(i,s)||e.Yi(i,s,new bt(s,t))}r.Oi&&(n.set(i,r.Ui()),r.ji())}}));var r=Ht();this.zi.forEach((function(t,n){var i=!0;n.Nt((function(t){var n=e.ee(t);return!n||2===n.ti||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new te(t,n,this.Ki,this.Wi,r);return this.Wi=Vt(),this.zi=ae(),this.Ki=new T(Ne),i},t.prototype.Hi=function(t,e){if(this.te(t)){var n=this.se(t,e.key)?2:0;this.Zi(t).xi(e.key,n),this.Wi=this.Wi.ut(e.key,e),this.zi=this.zi.ut(e.key,this.oe(e.key).add(t))}},t.prototype.Yi=function(t,e,n){if(this.te(t)){var r=this.Zi(t);this.se(t,e)?r.xi(e,1):r.Li(e),this.zi=this.zi.ut(e,this.oe(e).delete(t)),n&&(this.Wi=this.Wi.ut(e,n))}},t.prototype.removeTarget=function(t){this.Gi.delete(t)},t.prototype.re=function(t){var e=this.Zi(t).Ui();return this.Qi.he(t).size+e.Ii.size-e.Ei.size},t.prototype.Mi=function(t){this.Zi(t).Mi()},t.prototype.Zi=function(t){var e=this.Gi.get(t);return e||(e=new oe,this.Gi.set(t,e)),e},t.prototype.oe=function(t){var e=this.zi.get(t);return e||(e=new T(Ne),this.zi=this.zi.ut(t,e)),e},t.prototype.te=function(t){var e=null!==this.ee(t);return e||be("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ee=function(t){var e=this.Gi.get(t);return e&&e.Ni?null:this.Qi.ce(t)},t.prototype.ne=function(t){var e=this;Te(!this.Gi.get(t).Ni,"Should only reset active targets"),this.Gi.set(t,new oe),this.Qi.he(t).forEach((function(n){e.Yi(t,n,null)}))},t.prototype.se=function(t,e){return this.Qi.he(t).has(e)},t}();
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ae(){return new b(w.F)}function ue(){return new b(w.F)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ce,he,fe=((ce={})[Ot.ASCENDING.name]="ASCENDING",ce[Ot.DESCENDING.name]="DESCENDING",ce),le=((he={})[Tt.LESS_THAN.name]="LESS_THAN",he[Tt.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",he[Tt.GREATER_THAN.name]="GREATER_THAN",he[Tt.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",he[Tt.EQUAL.name]="EQUAL",he[Tt.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",he[Tt.IN.name]="IN",he[Tt.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",he);function pe(t,e){Te(!D(t),e+" is missing")}var de=function(){function t(t,e){this.ae=t,this.options=e}return t.prototype.fe=function(t){var e=void 0===t.code?o.UNKNOWN:Bt(t.code);return new s(e,t.message||"")},t.prototype.le=function(t){return this.options.de||D(t)?t:{value:t}},t.prototype.ve=function(t){var e;return D(e="object"==typeof t?t.value:t)?null:e},t.prototype.Wt=function(t){return{integerValue:""+t}},t.prototype.zt=function(t){if(this.options.de){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:O(t)?"-0":t}},t.prototype.we=function(t){return x(t)?this.Wt(t):this.zt(t)},t.prototype.O=function(t){return this.options.de?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},t.prototype.P=function(t){var e=q(t);return new p(e.seconds,e.nanos)},t.prototype.me=function(t){return this.options.de?t.toBase64():t.toUint8Array()},t.prototype.pe=function(t){return this.options.de?(Te(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),R.fromBase64String(t||"")):(Te(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),R.fromUint8Array(t||new Uint8Array))},t.prototype.toVersion=function(t){return this.O(t.O())},t.prototype.fromVersion=function(t){return Te(!!t,"Trying to deserialize version that isn't set"),d.P(this.P(t))},t.prototype.be=function(t,e){return this.ge(e||this.ae).child("documents").child(t).J()},t.prototype.ye=function(t){var e=y.H(t);return Te(ve(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype._e=function(t){return this.be(t.path)},t.prototype.it=function(t){var e=this.ye(t);return Te(e.get(1)===this.ae.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.ae.projectId),Te(!e.get(3)&&!this.ae.database||e.get(3)===this.ae.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.ae.database),new w(this.Ie(e))},t.prototype.Te=function(t){return this.be(t)},t.prototype.Ee=function(t){var e=this.ye(t);return 4===e.length?y.Y:this.Ie(e)},Object.defineProperty(t.prototype,"De",{get:function(){return new y(["projects",this.ae.projectId,"databases",this.ae.database]).J()},enumerable:!0,configurable:!0}),t.prototype.ge=function(t){return new y(["projects",t.projectId,"databases",t.database])},t.prototype.Ie=function(t){return Te(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.j(5)},t.prototype.Re=function(t,e){return{name:this._e(t),fields:e.proto.mapValue.fields}},t.prototype.Se=function(t){return Te(!t.nn,"Can't serialize documents with mutations."),{name:this._e(t.key),fields:t.yn().mapValue.fields,updateTime:this.O(t.version.O())}},t.prototype.Ae=function(t,e){var n=this.it(t.name),r=this.fromVersion(t.updateTime),i=new yt({mapValue:{fields:t.fields}});return new wt(n,r,i,{hasCommittedMutations:!!e})},t.prototype.Ce=function(t){Te(!!t.found,"Tried to deserialize a found document from a missing document."),pe(t.found.name,"doc.found.name"),pe(t.found.updateTime,"doc.found.updateTime");var e=this.it(t.found.name),n=this.fromVersion(t.found.updateTime),r=new yt({mapValue:{fields:t.found.fields}});return new wt(e,n,r,{})},t.prototype.Pe=function(t){Te(!!t.missing,"Tried to deserialize a missing document from a found document."),Te(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.it(t.missing),n=this.fromVersion(t.readTime);return new bt(e,n)},t.prototype.Ve=function(t){return"found"in t?this.Ce(t):"missing"in t?this.Pe(t):Ie("invalid batch get response: "+JSON.stringify(t))},t.prototype.ke=function(t){var e;if("targetChange"in t){pe(t.targetChange,"targetChange");var n=this.Ne(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],i=this.pe(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.fe(o);e=new ie(n,r,i,s||null)}else if("documentChange"in t){pe(t.documentChange,"documentChange");var a=t.documentChange;pe(a.document,"documentChange.name"),pe(a.document.name,"documentChange.document.name"),pe(a.document.updateTime,"documentChange.document.updateTime");var u=this.it(a.document.name),c=this.fromVersion(a.document.updateTime),h=new yt({mapValue:{fields:a.document.fields}}),f=new wt(u,c,h,{}),l=a.targetIds||[],p=a.removedTargetIds||[];e=new ne(l,p,f.key,f)}else if("documentDelete"in t){pe(t.documentDelete,"documentDelete");var v=t.documentDelete;pe(v.document,"documentDelete.document"),u=this.it(v.document),c=v.readTime?this.fromVersion(v.readTime):d.V(),f=new bt(u,c),p=v.removedTargetIds||[],e=new ne([],p,f.key,f)}else if("documentRemove"in t){pe(t.documentRemove,"documentRemove");var y=t.documentRemove;pe(y.document,"documentRemove"),u=this.it(y.document),p=y.removedTargetIds||[],e=new ne([],p,u,null)}else{if(!("filter"in t))return Ie("Unknown change type "+JSON.stringify(t));pe(t.filter,"filter");var g=t.filter;pe(g.targetId,"filter.targetId");var m=g.count||0,w=new Ut(m),b=g.targetId;e=new re(b,w)}return e},t.prototype.Ne=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ie("Got unexpected TargetChange.state: "+t)},t.prototype.Oe=function(t){if(!("targetChange"in t))return d.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?d.MIN:e.readTime?this.fromVersion(e.readTime):d.MIN},t.prototype.Fe=function(t){var e,n=this;if(t instanceof ft)e={update:this.Re(t.key,t.value)};else if(t instanceof dt)e={delete:this._e(t.key)};else if(t instanceof lt)e={update:this.Re(t.key,t.data),updateMask:this.Ue(t.en)};else if(t instanceof pt)e={transform:{document:this._e(t.key),fieldTransforms:t.fieldTransforms.map((function(t){return n.je(t)}))}};else{if(!(t instanceof vt))return Ie("Unknown mutation type "+t.type);e={verify:this._e(t.key)}}return t.tn.Yt||(e.currentDocument=this.xe(t.tn)),e},t.prototype.Le=function(t){var e=this,n=t.currentDocument?this.Me(t.currentDocument):ct.NONE;if(t.update){pe(t.update.name,"name");var r=this.it(t.update.name),i=new yt({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.qe(t.updateMask);return new lt(r,i,o,n)}return new ft(r,i,n)}if(t.delete)return r=this.it(t.delete),new dt(r,n);if(t.transform){r=this.it(t.transform.document);var s=t.transform.fieldTransforms.map((function(t){return e.Be(t)}));return Te(!0===n.exists,'Transforms only support precondition "exists == true"'),new pt(r,s)}return t.verify?(r=this.it(t.verify),new vt(r,n)):Ie("unknown mutation proto: "+JSON.stringify(t))},t.prototype.xe=function(t){return Te(!t.Yt,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ie("Unknown precondition")},t.prototype.Me=function(t){return void 0!==t.updateTime?ct.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?ct.exists(t.exists):ct.NONE},t.prototype.Qe=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(d.MIN)&&(n=this.fromVersion(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new ut(n,r)},t.prototype.Ge=function(t,e){var n=this;return t&&t.length>0?(Te(void 0!==e,"Received a write result without a commit time"),t.map((function(t){return n.Qe(t,e)}))):[]},t.prototype.je=function(t){var e=t.transform;if(e instanceof Z)return{fieldPath:t.field.J(),setToServerValue:"REQUEST_TIME"};if(e instanceof tt)return{fieldPath:t.field.J(),appendMissingElements:{values:e.elements}};if(e instanceof et)return{fieldPath:t.field.J(),removeAllFromArray:{values:e.elements}};if(e instanceof nt)return{fieldPath:t.field.J(),increment:e.Gt};throw Ie("Unknown transform: "+t.transform)},t.prototype.Be=function(t){var e=null;if("setToServerValue"in t)Te("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),e=Z.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new tt(n)}else"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],e=new et(n)):"increment"in t?e=new nt(this,t.increment):Ie("Unknown transform proto: "+JSON.stringify(t));var r=m.tt(t.fieldPath);return new at(r,e)},t.prototype.We=function(t){return{documents:[this.Te(t.path)]}},t.prototype.ze=function(t){var e=t.documents.length;Te(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return It.Cn(this.Ee(n)).qn()},t.prototype.Ke=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(Te(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.Te(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(Te(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.Te(n.L()),e.structuredQuery.from=[{collectionId:n.B()}]);var r=this.Je(t.filters);r&&(e.structuredQuery.where=r);var i=this.He(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.le(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Ye(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Ye(t.endAt)),e},t.prototype.Xe=function(t){var e=this.Ee(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Te(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.$e(n.where));var a=[];n.orderBy&&(a=this.Ze(n.orderBy));var u=null;n.limit&&(u=this.ve(n.limit));var c=null;n.startAt&&(c=this.tr(n.startAt));var h=null;return n.endAt&&(h=this.tr(n.endAt)),new It(e,i,a,s,u,"F",c,h).qn()},t.prototype.nr=function(t){var e=this.ir(t.ti);return null==e?null:{"goog-listen-tags":e}},t.prototype.ir=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ie("Unrecognized query purpose: "+t)}},t.prototype.qn=function(t){var e,n=t.target;return(e=n.Tn()?{documents:this.We(n)}:{query:this.Ke(n)}).targetId=t.targetId,t.resumeToken.Lt()>0&&(e.resumeToken=this.me(t.resumeToken)),e},t.prototype.Je=function(t){var e=this;if(0!==t.length){var n=t.map((function(t){return t instanceof At?e.er(t):Ie("Unrecognized filter: "+JSON.stringify(t))}));return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.$e=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.rr(t)]:void 0!==t.fieldFilter?[this.ur(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return e.$e(t)})).reduce((function(t,e){return t.concat(e)})):Ie("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.He=function(t){var e=this;if(0!==t.length)return t.map((function(t){return e.sr(t)}))},t.prototype.Ze=function(t){var e=this;return t.map((function(t){return e.or(t)}))},t.prototype.Ye=function(t){return{before:t.before,values:t.position}},t.prototype.tr=function(t){var e=!!t.before,n=t.values||[];return new xt(n,e)},t.prototype.hr=function(t){return fe[t.name]},t.prototype.cr=function(t){switch(t){case"ASCENDING":return Ot.ASCENDING;case"DESCENDING":return Ot.DESCENDING;default:return}},t.prototype.ar=function(t){return le[t.name]},t.prototype.lr=function(t){switch(t){case"EQUAL":return Tt.EQUAL;case"GREATER_THAN":return Tt.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Tt.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Tt.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Tt.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Tt.ARRAY_CONTAINS;case"IN":return Tt.IN;case"ARRAY_CONTAINS_ANY":return Tt.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return Ie("Unspecified operator");default:return Ie("Unknown operator")}},t.prototype.dr=function(t){return{fieldPath:t.J()}},t.prototype.vr=function(t){return m.tt(t.fieldPath)},t.prototype.sr=function(t){return{field:this.dr(t.field),direction:this.hr(t.dir)}},t.prototype.or=function(t){return new Ct(this.vr(t.field),this.cr(t.direction))},t.prototype.ur=function(t){return At.create(this.vr(t.fieldFilter.field),this.lr(t.fieldFilter.op),t.fieldFilter.value)},t.prototype.er=function(t){if(t.op===Tt.EQUAL){if(J(t.value))return{unaryFilter:{field:this.dr(t.field),op:"IS_NAN"}};if(K(t.value))return{unaryFilter:{field:this.dr(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.dr(t.field),op:this.ar(t.op),value:t.value}}},t.prototype.rr=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.vr(t.unaryFilter.field);return At.create(e,Tt.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.vr(t.unaryFilter.field);return At.create(n,Tt.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ie("Unspecified filter");default:return Ie("Unknown filter")}},t.prototype.Ue=function(t){var e=[];return t.fields.forEach((function(t){return e.push(t.J())})),{fieldPaths:e}},t.prototype.qe=function(t){var e=(t.fieldPaths||[]).map((function(t){return m.tt(t)}));return st.Jt(e)},t}();function ve(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var ye=function(){function t(){}return t.wr=function(e){t.platform&&Ie("Platform already defined"),t.platform=e},t.xt=function(){return t.platform||Ie("Platform not set"),t.platform},t}(),ge=new Xe.Logger("@firebase/firestore");
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function me(){return ge.logLevel}function we(t){ge.logLevel=t}function be(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ge.logLevel<=Xe.LogLevel.DEBUG){var i=e.map(_e);ge.error.apply(ge,Fe.__spreadArrays(["Firestore ("+r+"): "+t],i))}}function Ee(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ge.logLevel<=Xe.LogLevel.ERROR){var i=e.map(_e);ge.error.apply(ge,Fe.__spreadArrays(["Firestore ("+r+"): "+t],i))}}function _e(t){if("string"==typeof t)return t;var e=ye.xt();try{return e.mr(t)}catch(e){return t}}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function Ie(t){var e="FIRESTORE ("+r+") INTERNAL ASSERTION FAILED: "+t;throw Ee(e),new Error(e)}function Te(t,e){t||Ie(e)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ae=function(){function t(){}return t.pr=function(){for(var t="";t.length<20;)for(var e=ye.xt().randomBytes(40),n=0,r=Array.from(e);n<r.length;n++){var i=r[n];t.length<20&&i<=247&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i%62))}return Te(20===t.length,"Invalid auto ID: "+t),t},t}();function Ne(t,e){return t<e?-1:t>e?1:0}function Se(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function ke(t){return t+"\0"}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Re=function(t,e,n,r,i){this.ae=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},De=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"br",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.k=function(t){return Ne(this.projectId,t.projectId)||Ne(this.database,t.database)},t}(),Oe=function(){function t(t,e,n,r){this.batchId=t,this.gr=e,this.baseMutations=n,this.mutations=r,Te(r.length>0,"Cannot create an empty mutation batch")}return t.prototype.Bt=function(t,e,n){e&&Te(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.yr;Te(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.Bt(e,s)}}return e},t.prototype.qt=function(t,e){e&&Te(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(a=r[n]).key.isEqual(t)&&(e=a.qt(e,e,this.gr));for(var i=e,o=0,s=this.mutations;o<s.length;o++){var a;(a=s[o]).key.isEqual(t)&&(e=a.qt(e,i,this.gr))}return e},t.prototype._r=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.qt(r.key,t.get(r.key));i&&(n=n.ut(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Ht())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Se(this.mutations,t.mutations,(function(t,e){return t.isEqual(e)}))&&Se(this.baseMutations,t.baseMutations,(function(t,e){return t.isEqual(e)}))},t}(),xe=function(){function t(t,e,n,r,i){this.batch=t,this.Ir=e,this.yr=n,this.streamToken=r,this.Tr=i}return t.from=function(e,n,r,i){Te(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=Wt(),s=e.mutations,a=0;a<s.length;a++)o=o.ut(s[a].key,r[a].version);return new t(e,n,r,i,o)},t}(),Ce=function(){function t(t){this.Er=t,this.Dr={}}return t.prototype.get=function(t){var e=this.Er(t),n=this.Dr[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(s.isEqual(t))return a}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Er(t),r=this.Dr[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.Dr[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Er(t),n=this.Dr[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.Dr[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){S(this.Dr,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];t(s,a)}}))},t.prototype.M=function(){return k(this.Dr)},t}(),Pe=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.Rr=n,this.Sr=r}return t.Ar=function(e,n){for(var r=Ht(),i=Ht(),o=0,s=n.docChanges;o<s.length;o++){var a=s[o];switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Le=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.Cr=function(t){return n.Pr(t)},this.Vr=function(t){return e.kr(t)})}return t.prototype.Pr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.Vr&&this.Vr(t),t},t.Nr=-1,t}(),Me=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Ue=function(){function t(t,e,n,r,i){this.Or=t,this.Fr=e,this.Ur=n,this.op=r,this.jr=i,this.xr=new Me,this.then=this.xr.promise.then.bind(this.xr.promise),this.catch=this.xr.promise.catch.bind(this.xr.promise),this.xr.promise.catch((function(t){}))}return t.Lr=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.Mr=setTimeout((function(){return e.qr()}),t)},t.prototype.Br=function(){return this.qr()},t.prototype.cancel=function(t){null!==this.Mr&&(this.clearTimeout(),this.xr.reject(new s(o.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.qr=function(){var t=this;this.Or.Qr((function(){return null!==t.Mr?(t.clearTimeout(),t.op().then((function(e){return t.xr.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.Mr&&(this.jr(this),clearTimeout(this.Mr),this.Mr=null)},t}(),je=function(){function t(){this.Gr=Promise.resolve(),this.Wr=!1,this.zr=[],this.Kr=null,this.Jr=!1,this.Hr=[]}return Object.defineProperty(t.prototype,"Yr",{get:function(){return this.Wr},enumerable:!0,configurable:!0}),t.prototype.Qr=function(t){this.enqueue(t)},t.prototype.Xr=function(t){this.$r(),this.Zr(t)},t.prototype.tu=function(t){return this.$r(),this.Zr(t)},t.prototype.nu=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(e){switch(e.label){case 0:return this.$r(),this.Wr?[3,2]:(this.Wr=!0,[4,this.tu(t)]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},t.prototype.enqueue=function(t){return this.$r(),this.Wr?new Promise((function(t){})):this.Zr(t)},t.prototype.Zr=function(t){var e=this,n=this.Gr.then((function(){return e.Jr=!0,t().catch((function(t){e.Kr=t,e.Jr=!1;var n=t.stack||t.message||"";throw Ee("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout((function(){throw t}),0),t})).then((function(t){return e.Jr=!1,t}))}));return this.Gr=n,n},t.prototype.iu=function(t,e,n){var r=this;this.$r(),Te(e>=0,"Attempted to schedule an operation with a negative delay of "+e),this.Hr.indexOf(t)>-1&&(e=0);var i=Ue.Lr(this,t,e,n,(function(t){return r.eu(t)}));return this.zr.push(i),i},t.prototype.$r=function(){this.Kr&&Ie("AsyncQueue is already failed: "+(this.Kr.stack||this.Kr.message))},t.prototype.ru=function(){Te(this.Jr,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.uu=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t;return Fe.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.Gr];case 1:e.sent(),e.label=2;case 2:if(t!==this.Gr)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.su=function(t){for(var e=0,n=this.zr;e<n.length;e++)if(n[e].Fr===t)return!0;return!1},t.prototype.ou=function(t){var e=this;return this.uu().then((function(){Te("all"===t||e.su(t),"Attempted to drain to missing operation "+t),e.zr.sort((function(t,e){return t.Ur-e.Ur}));for(var n=0,r=e.zr;n<r.length;n++){var i=r[n];if(i.Br(),"all"!==t&&i.Fr===t)break}return e.uu()}))},t.prototype.hu=function(t){this.Hr.push(t)},t.prototype.eu=function(t){var e=this.zr.indexOf(t);Te(e>=0,"Delayed operation not found."),this.zr.splice(e,1)},t}(),Be=function(){function t(t){var e=this;this.cu=null,this.au=null,this.result=void 0,this.error=void 0,this.fu=!1,this.lu=!1,t((function(t){e.fu=!0,e.result=t,e.cu&&e.cu(t)}),(function(t){e.fu=!0,e.error=t,e.au&&e.au(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.lu&&Ie("Called next() or catch() twice for PersistencePromise"),this.lu=!0,this.fu?this.error?this.du(n,this.error):this.vu(e,this.result):new t((function(t,i){r.cu=function(n){r.vu(e,n).next(t,i)},r.au=function(e){r.du(n,e).next(t,i)}}))},t.prototype.wu=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.mu=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.vu=function(e,n){return e?this.mu((function(){return e(n)})):t.resolve(n)},t.prototype.du=function(e,n){return e?this.mu((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.pu=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.bu=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.pu(r)},t}();
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ze(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ne(n,i);return 0===s?Ne(r,o):s}var Ge=function(){function t(t){this.gu=t,this.buffer=new T(ze),this.yu=0}return t.prototype._u=function(){return++this.yu},t.prototype.Iu=function(t){var e=[t,this._u()];if(this.buffer.size<this.gu)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ze(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),t}(),$e={Tu:!1,Eu:0,Du:0,Ru:0},We=function(){function t(t,e,n){this.Su=t,this.Au=e,this.Cu=n}return t.Pu=function(e){return new t(e,t.Vu,t.ku)},t.Nu=-1,t.Ou=1048576,t.Fu=41943040,t.Vu=10,t.ku=1e3,t.Uu=new t(t.Fu,t.Vu,t.ku),t.DISABLED=new t(t.Nu,0,0),t}(),Ye=function(){function t(t,e){this.ju=t,this.Or=e,this.xu=!1,this.Lu=null}return t.prototype.start=function(t){Te(null===this.Lu,"Cannot start an already started LruScheduler"),this.ju.params.Su!==We.Nu&&this.Mu(t)},t.prototype.stop=function(){this.Lu&&(this.Lu.cancel(),this.Lu=null)},Object.defineProperty(t.prototype,"qu",{get:function(){return null!==this.Lu},enumerable:!0,configurable:!0}),t.prototype.Mu=function(t){var e=this;Te(null===this.Lu,"Cannot schedule GC while a task is pending");var n=this.xu?3e5:6e4;be("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.Lu=this.Or.iu("lru_garbage_collection",n,(function(){return e.Lu=null,e.xu=!0,t.Bu(e.ju).then((function(){return e.Mu(t)})).catch(en)}))},t}(),He=function(){function t(t,e){this.Qu=t,this.params=e}return t.prototype.Gu=function(t,e){return this.Qu.Wu(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.zu=function(t,e){var n=this;if(0===e)return Be.resolve(Le.Nr);var r=new Ge(e);return this.Qu.$i(t,(function(t){return r.Iu(t.sequenceNumber)})).next((function(){return n.Qu.Ku(t,(function(t){return r.Iu(t)}))})).next((function(){return r.maxValue}))},t.prototype.Ju=function(t,e,n){return this.Qu.Ju(t,e,n)},t.prototype.Hu=function(t,e){return this.Qu.Hu(t,e)},t.prototype.Yu=function(t,e){var n=this;return this.params.Su===We.Nu?(be("LruGarbageCollector","Garbage collection skipped; disabled"),Be.resolve($e)):this.Xu(t).next((function(r){return r<n.params.Su?(be("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Su),$e):n.$u(t,e)}))},t.prototype.Xu=function(t){return this.Qu.Xu(t)},t.prototype.$u=function(t,e){var n,r,i,o,s,a,u,c=this,h=Date.now();return this.Gu(t,this.params.Au).next((function(e){return e>c.params.Cu?(be("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Cu+" from "+e),r=c.params.Cu):r=e,o=Date.now(),c.zu(t,r)})).next((function(r){return n=r,s=Date.now(),c.Ju(t,n,e)})).next((function(e){return i=e,a=Date.now(),c.Hu(t,n)})).next((function(t){return u=Date.now(),me()<=Xe.LogLevel.DEBUG&&be("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(a-s)+"ms\n\tRemoved "+t+" documents in "+(u-a)+"ms\nTotal Duration: "+(u-h)+"ms"),Be.resolve({Tu:!0,Eu:r,Du:i,Ru:t})}))},t}(),Qe=function(){function t(){this.Zu=new T(Ke.bn),this.ts=new T(Ke.ns)}return t.prototype.M=function(){return this.Zu.M()},t.prototype.es=function(t,e){var n=new Ke(t,e);this.Zu=this.Zu.add(n),this.ts=this.ts.add(n)},t.prototype.rs=function(t,e){var n=this;t.forEach((function(t){return n.es(t,e)}))},t.prototype.us=function(t,e){this.ss(new Ke(t,e))},t.prototype.os=function(t,e){var n=this;t.forEach((function(t){return n.us(t,e)}))},t.prototype.hs=function(t){var e=this,n=w.EMPTY,r=new Ke(n,t),i=new Ke(n,t+1),o=[];return this.ts.kt([r,i],(function(t){e.ss(t),o.push(t.key)})),o},t.prototype.cs=function(){var t=this;this.Zu.forEach((function(e){return t.ss(e)}))},t.prototype.ss=function(t){this.Zu=this.Zu.delete(t),this.ts=this.ts.delete(t)},t.prototype.as=function(t){var e=w.EMPTY,n=new Ke(e,t),r=new Ke(e,t+1),i=Ht();return this.ts.kt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.fs=function(t){var e=new Ke(t,0),n=this.Zu.Ot(e);return null!==n&&t.isEqual(n.key)},t}(),Ke=function(){function t(t,e){this.key=t,this.ls=e}return t.bn=function(t,e){return w.F(t.key,e.key)||Ne(t.ls,e.ls)},t.ns=function(t,e){return Ne(t.ls,e.ls)||w.F(t.key,e.key)},t}(),Je=function(){function t(){this.ds=new Ce((function(t){return t.toString()})),this.vs=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return Te(void 0!==this.ws,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this.ws},set:function(t){Te(void 0===this.ws||this.ws.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this.ws=t},enumerable:!0,configurable:!0}),t.prototype.ms=function(t,e){this.ps(),this.readTime=e,this.ds.set(t.key,t)},t.prototype.bs=function(t,e){this.ps(),e&&(this.readTime=e),this.ds.set(t,null)},t.prototype.gs=function(t,e){this.ps();var n=this.ds.get(e);return void 0!==n?Be.resolve(n):this.ys(t,e)},t.prototype.getEntries=function(t,e){return this._s(t,e)},t.prototype.apply=function(t){return this.ps(),this.vs=!0,this.Is(t)},t.prototype.ps=function(){Te(!this.vs,"Changes have already been applied.")},t}(),tn=function(){function t(t,e,n){this.persistence=t,this.Ts=e,this.Es=new Qe,this.Ds=new b(Ne),this.Rs=new Ce((function(t){return t.canonicalId()})),this.Ss=d.MIN,Te(t.qu,"LocalStore was passed an unstarted persistence implementation"),this.persistence.Cs.As(this.Es),this.Ps=t.Vs(n),this.ks=t.Ns(),this.Os=t.Fs(),this.Us=new vn(this.ks,this.Ps,this.persistence.js()),this.Ts.xs(this.Us)}return t.prototype.start=function(){return this.Ls()},t.prototype.Ms=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n,r,i=this;return Fe.__generator(this,(function(o){switch(o.label){case 0:return e=this.Ps,n=this.Us,[4,this.persistence.runTransaction("Handle user change","readonly",(function(r){var o;return i.Ps.qs(r).next((function(s){return o=s,e=i.persistence.Vs(t),n=new vn(i.ks,e,i.persistence.js()),e.qs(r)})).next((function(t){for(var e=[],i=[],s=Ht(),a=0,u=o;a<u.length;a++){var c=u[a];e.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=t;p<d.length;p++){c=d[p],i.push(c.batchId);for(var v=0,y=c.mutations;v<y.length;v++)l=y[v],s=s.add(l.key)}return n.Bs(r,s).next((function(t){return{Qs:t,Gs:e,Ws:i}}))}))}))];case 1:return r=o.sent(),this.Ps=e,this.Us=n,this.Ts.xs(this.Us),[2,r]}}))}))},t.prototype.zs=function(t){var e,n=this,r=p.now(),i=t.reduce((function(t,e){return t.add(e.key)}),Ht());return this.persistence.runTransaction("Locally write mutations","readwrite",(function(o){return n.Us.Bs(o,i).next((function(i){e=i;for(var s=[],a=0,u=t;a<u.length;a++){var c=u[a],h=c.in(e.get(c.key));null!=h&&s.push(new lt(c.key,h,h.en(),ct.exists(!0)))}return n.Ps.Ks(o,r,s,t)}))})).then((function(t){var n=t._r(e);return{batchId:t.batchId,ds:n}}))},t.prototype.Js=function(t){var e=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",(function(n){return e.Ps.Hs(n,t).next((function(t){return t?e.Us.Bs(n,t):Be.resolve(null)}))}))},t.prototype.Ys=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(n){var r=t.batch.keys(),i=e.ks.Xs({$s:!0});return e.Ps.Ys(n,t.batch,t.streamToken).next((function(){return e.Zs(n,t,i)})).next((function(){return i.apply(n)})).next((function(){return e.Ps.to(n)})).next((function(){return e.Us.Bs(n,r)}))}))},t.prototype.no=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",(function(n){var r;return e.Ps.io(n,t).next((function(t){return Te(null!==t,"Attempt to reject nonexistent batch!"),r=t.keys(),e.Ps.eo(n,t)})).next((function(){return e.Ps.to(n)})).next((function(){return e.Us.Bs(n,r)}))}))},t.prototype.ro=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.Ps.ro(e)}))},t.prototype.uo=function(){var t=this;return this.persistence.runTransaction("Get last stream token","readonly",(function(e){return t.Ps.uo(e)}))},t.prototype.so=function(t){var e=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",(function(n){return e.Ps.so(n,t)}))},t.prototype.oo=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Os.oo(e)}))},t.prototype.ho=function(e){var n=this,r=e.ni,i=this.Ds;return this.persistence.runTransaction("Apply remote event","readwrite-primary",(function(o){var s=n.ks.Xs({$s:!0});i=n.Ds;var a=[];e.wi.forEach((function(e,s){var u=i.get(s);if(u){a.push(n.Os.co(o,e.Ei,s).next((function(){return n.Os.ao(o,e.Ii,s)})));var c=e.resumeToken;if(c.Lt()>0){var h=u.ei(c,r).ii(o.fo);i=i.ut(s,h),t.lo(u,h,e)&&a.push(n.Os.do(o,h))}}}));var u=Vt(),c=Ht();if(e.pi.forEach((function(t,e){c=c.add(t)})),a.push(s.getEntries(o,c).next((function(t){e.pi.forEach((function(i,c){var h=t.get(i);c instanceof bt&&c.version.isEqual(d.MIN)?(s.bs(i,r),u=u.ut(i,c)):null==h||c.version.k(h.version)>0||0===c.version.k(h.version)&&h.hasPendingWrites?(Te(!d.MIN.isEqual(r),"Cannot add a document when the remote version is zero"),s.ms(c,r),u=u.ut(i,c)):be("LocalStore","Ignoring outdated watch update for ",i,". Current version:",h.version," Watch version:",c.version),e.bi.has(i)&&a.push(n.persistence.Cs.vo(o,i))}))}))),!r.isEqual(d.MIN)){var h=n.Os.oo(o).next((function(t){return Te(r.k(t)>=0,"Watch stream reverted to previous snapshot?? "+r+" < "+t),n.Os.wo(o,o.fo,r)}));a.push(h)}return Be.pu(a).next((function(){return s.apply(o)})).next((function(){return n.Us.mo(o,u)}))})).then((function(t){return n.Ds=i,t}))},t.lo=function(t,e,n){return Te(e.resumeToken.Lt()>0,"Attempted to persist target data with no resume token"),0===t.resumeToken.Lt()||e.ni.N()-t.ni.N()>=this.po||n.Ii.size+n.Ti.size+n.Ei.size>0},t.prototype.bo=function(t){for(var e=this,n=0,r=t;n<r.length;n++){var i=r[n],o=i.targetId;if(this.Es.rs(i.Rr,o),this.Es.os(i.Sr,o),!i.fromCache){var s=this.Ds.get(o);Te(null!==s,"Can't set limbo-free snapshot version for unknown target: "+o);var a=s.ni,u=s.ri(a);this.Ds=this.Ds.ut(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(n){return Be.forEach(t,(function(t){return Be.forEach(t.Sr,(function(t){return e.persistence.Cs.us(n,t)}))}))}))},t.prototype.yo=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",(function(n){return void 0===t&&(t=-1),e.Ps._o(n,t)}))},t.prototype.Io=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",(function(n){return e.Us.To(n,t)}))},t.prototype.Eo=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite",(function(n){var r;return e.Os.Do(n,t).next((function(i){return i?(r=i,Be.resolve(r)):e.Os.Ro(n).next((function(i){return r=new Mt(t,i,0,n.fo),e.Os.So(n,r).next((function(){return r}))}))}))})).then((function(n){return null===e.Ds.get(n.targetId)&&(e.Ds=e.Ds.ut(n.targetId,n),e.Rs.set(t,n.targetId)),n}))},t.prototype.Do=function(t,e){var n=this.Rs.get(e);return void 0!==n?Be.resolve(this.Ds.get(n)):this.Os.Do(t,e)},t.prototype.Ao=function(t,e){var n=this,r=this.Ds.get(t);Te(null!==r,"Tried to release nonexistent target: "+t);var i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,(function(i){var o=n.Es.hs(t);return e?Be.resolve():Be.forEach(o,(function(t){return n.persistence.Cs.us(i,t)})).next((function(){n.persistence.Cs.removeTarget(i,r)}))})).then((function(){n.Ds=n.Ds.remove(t),n.Rs.delete(r.target)}))},t.prototype.Co=function(t,e){var n=this,r=d.MIN,i=Ht();return this.persistence.runTransaction("Execute query","readonly",(function(o){return n.Do(o,t.qn()).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.Os.Po(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.Ts.Vo(o,t,e?r:d.MIN,e?i:Ht())})).next((function(t){return{documents:t,ko:i}}))}))},t.prototype.No=function(t){var e=this;return this.persistence.runTransaction("Remote document keys","readonly",(function(n){return e.Os.Po(n,t)}))},t.prototype.Oo=function(){return this.persistence.Oo()},t.prototype.Fo=function(t){this.Ps.Uo(t)},t.prototype.jo=function(t){this.persistence.jo(t)},t.prototype.Zs=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=Be.resolve();return o.forEach((function(r){s=s.next((function(){return n.gs(t,r)})).next((function(t){var o=t,s=e.Tr.get(r);Te(null!==s,"ackVersions should contain every doc in the write."),(!o||o.version.k(s)<0)&&((o=i.Bt(r,o,e))?n.ms(o,e.Ir):Te(!t,"Mutation batch "+i+" applied to document "+t+" resulted in null"))}))})),s.next((function(){return r.Ps.eo(t,i)}))},t.prototype.Bu=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Yu(n,e.Ds)}))},t.prototype.xo=function(t){var e=this,n=this.Ds.get(t);return n?Promise.resolve(n.target):this.persistence.runTransaction("Get target data","readonly",(function(n){return e.Os.ce(n,t).next((function(t){return t?t.target:null}))}))},t.prototype.Lo=function(){var t=this;return this.persistence.runTransaction("Get new document changes","readonly",(function(e){return t.ks.Lo(e,t.Ss)})).then((function(e){var n=e.Mo,r=e.readTime;return t.Ss=r,n}))},t.prototype.Ls=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t,e=this;return Fe.__generator(this,(function(n){switch(n.label){case 0:return t=this,[4,this.persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return e.ks.qo(t)}))];case 1:return t.Ss=n.sent(),[2]}}))}))},t.po=3e8,t}();function en(t){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(e){if(t.code!==o.FAILED_PRECONDITION||t.message!==pn)throw t;return be("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function nn(t,e){return Te(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),"firestore_clients_"+t+"_"+e}function rn(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function on(t,e){return"firestore_targets_"+t+"_"+e}
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var sn=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r,Te(void 0!==r==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}return t.Bo=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),a=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(a=new s(i.error.code,i.error.message)),o?new t(e,n,i.state,a):(Ee("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Qo=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),an=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n,Te(void 0!==n==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}return t.Bo=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new s(r.error.code,r.error.message)),i?new t(e,r.state,o):(Ee("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Qo=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),un=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Bo=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Kt(),s=0;i&&s<r.activeTargetIds.length;++s)i=x(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Ee("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),cn=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Bo=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Ee("SharedClientState","Failed to parse online state: "+e),null)},t}(),hn=function(){function t(){this.activeTargetIds=Kt()}return t.prototype.Go=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Wo=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Qo=function(){var t={activeTargetIds:this.activeTargetIds.K(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),fn=function(){function t(e,n,r,i,a){if(this.zo=e,this.platform=n,this.persistenceKey=r,this.Ko=i,this.Jo=null,this.Ho=null,this.Cr=null,this.Yo={},this.Xo=this.$o.bind(this),this.qu=!1,this.Zo=[],!t.th(this.platform))throw new s(o.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=a,this.nh=nn(this.persistenceKey,this.Ko),this.ih=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Yo[this.Ko]=new hn,this.eh=new RegExp("^firestore_clients_"+u+"_([^_]*)$"),this.rh=new RegExp("^firestore_mutations_"+u+"_(\\d+)(?:_(.*))?$"),this.uh=new RegExp("^firestore_targets_"+u+"_(\\d+)$"),this.sh=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.platform.window.addEventListener("storage",this.Xo)}return t.th=function(t){return!(!t.window||null==t.window.localStorage)},t.prototype.start=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,a,u,c,h,f=this;return Fe.__generator(this,(function(l){switch(l.label){case 0:return Te(!this.qu,"WebStorageSharedClientState already started"),Te(null!==this.Jo,"syncEngine property must be set before calling start()"),Te(null!==this.Ho,"onlineStateHandler property must be set before calling start()"),[4,this.Jo.Oo()];case 1:for(t=l.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ko&&(i=this.getItem(nn(this.persistenceKey,r)))&&(o=un.Bo(r,i))&&(this.Yo[o.clientId]=o);for(this.oh(),(s=this.storage.getItem(this.sh))&&(a=this.hh(s))&&this.ah(a),u=0,c=this.Zo;u<c.length;u++)h=c[u],this.$o(h);return this.Zo=[],this.platform.window.addEventListener("unload",(function(){return f.shutdown()})),this.qu=!0,[2]}}))}))},t.prototype.kr=function(t){this.setItem(this.ih,JSON.stringify(t))},t.prototype.fh=function(){var t=Kt();return S(this.Yo,(function(e,n){t=t.Ft(n.activeTargetIds)})),t},t.prototype.lh=function(t){for(var e in this.Yo)if(this.Yo.hasOwnProperty(e)&&this.Yo[e].activeTargetIds.has(t))return!0;return!1},t.prototype.dh=function(t){this.vh(t,"pending")},t.prototype.wh=function(t,e,n){this.vh(t,e,n),this.mh(t)},t.prototype.ph=function(t){var e="not-current";if(this.lh(t)){var n=this.storage.getItem(on(this.persistenceKey,t));if(n){var r=an.Bo(t,n);r&&(e=r.state)}}return this.bh.Go(t),this.oh(),e},t.prototype.gh=function(t){this.bh.Wo(t),this.oh()},t.prototype.yh=function(t){return this.bh.activeTargetIds.has(t)},t.prototype._h=function(t){this.removeItem(on(this.persistenceKey,t))},t.prototype.Ih=function(t,e,n){this.Th(t,e,n)},t.prototype.Ms=function(t,e,n){var r=this;e.forEach((function(t){r.mh(t)})),this.currentUser=t,n.forEach((function(t){r.dh(t)}))},t.prototype.Eh=function(t){this.Dh(t)},t.prototype.shutdown=function(){this.qu&&(this.platform.window.removeEventListener("storage",this.Xo),this.removeItem(this.nh),this.qu=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return be("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){be("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){be("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.$o=function(t){var e=this;if(t.storageArea===this.storage){if(be("SharedClientState","EVENT",t.key,t.newValue),t.key===this.nh)return void Ee("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.zo.Qr((function(){return Fe.__awaiter(e,void 0,void 0,(function(){var e,n,r,i,o,s;return Fe.__generator(this,(function(a){if(!this.qu)return this.Zo.push(t),[2];if(null===t.key)return[2];if(this.eh.test(t.key)){if(null==t.newValue)return n=this.Rh(t.key),[2,this.Sh(n,null)];if(e=this.Ah(t.key,t.newValue))return[2,this.Sh(e.clientId,e)]}else if(this.rh.test(t.key)){if(null!==t.newValue&&(r=this.Ch(t.key,t.newValue)))return[2,this.Ph(r)]}else if(this.uh.test(t.key)){if(null!==t.newValue&&(i=this.Vh(t.key,t.newValue)))return[2,this.kh(i)]}else if(t.key===this.sh){if(null!==t.newValue&&(o=this.hh(t.newValue)))return[2,this.ah(o)]}else t.key===this.ih&&(Te(!!this.Cr,"Missing sequenceNumberHandler"),(s=function(t){var e=Le.Nr;if(null!=t)try{var n=JSON.parse(t);Te("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){Ee("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(t.newValue))!==Le.Nr&&this.Cr(s));return[2]}))}))}))}},Object.defineProperty(t.prototype,"bh",{get:function(){return this.Yo[this.Ko]},enumerable:!0,configurable:!0}),t.prototype.oh=function(){this.setItem(this.nh,this.bh.Qo())},t.prototype.vh=function(t,e,n){var r=new sn(this.currentUser,t,e,n),i=rn(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Qo())},t.prototype.mh=function(t){var e=rn(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Dh=function(t){var e={clientId:this.Ko,onlineState:t};this.storage.setItem(this.sh,JSON.stringify(e))},t.prototype.Th=function(t,e,n){var r=on(this.persistenceKey,t),i=new an(t,e,n);this.setItem(r,i.Qo())},t.prototype.Rh=function(t){var e=this.eh.exec(t);return e?e[1]:null},t.prototype.Ah=function(t,e){var n=this.Rh(t);return Te(null!==n,"Cannot parse client state key '"+t+"'"),un.Bo(n,e)},t.prototype.Ch=function(t,e){var n=this.rh.exec(t);Te(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),o=void 0!==n[2]?n[2]:null;return sn.Bo(new i(o),r,e)},t.prototype.Vh=function(t,e){var n=this.uh.exec(t);Te(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return an.Bo(r,e)},t.prototype.hh=function(t){return cn.Bo(t)},t.prototype.Ph=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(e){return t.user.uid!==this.currentUser.uid?(be("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2]):[2,this.Jo.Nh(t.batchId,t.state,t.error)]}))}))},t.prototype.kh=function(t){return this.Jo.Oh(t.targetId,t.state,t.error)},t.prototype.Sh=function(t,e){var n=this,r=this.fh();e?this.Yo[t]=e:delete this.Yo[t];var i=this.fh(),o=[],s=[];return i.forEach((function(t){return Fe.__awaiter(n,void 0,void 0,(function(){return Fe.__generator(this,(function(e){return r.has(t)||o.push(t),[2]}))}))})),r.forEach((function(t){return Fe.__awaiter(n,void 0,void 0,(function(){return Fe.__generator(this,(function(e){return i.has(t)||s.push(t),[2]}))}))})),this.Jo.Fh(o,s)},t.prototype.ah=function(t){this.Yo[t.clientId]&&this.Ho(t.onlineState)},t}(),ln=function(){function t(){this.Uh=new hn,this.jh={},this.Jo=null,this.Ho=null,this.Cr=null}return t.prototype.dh=function(t){},t.prototype.wh=function(t,e,n){},t.prototype.ph=function(t){return this.Uh.Go(t),this.jh[t]||"not-current"},t.prototype.Ih=function(t,e,n){this.jh[t]=e},t.prototype.gh=function(t){this.Uh.Wo(t)},t.prototype.yh=function(t){return this.Uh.activeTargetIds.has(t)},t.prototype._h=function(t){delete this.jh[t]},t.prototype.fh=function(){return this.Uh.activeTargetIds},t.prototype.lh=function(t){return this.Uh.activeTargetIds.has(t)},t.prototype.start=function(){return this.Uh=new hn,Promise.resolve()},t.prototype.Ms=function(t,e,n){},t.prototype.Eh=function(t){},t.prototype.shutdown=function(){},t.prototype.kr=function(t){},t}(),pn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",dn=function(){function t(){this.xh=[]}return t.prototype.Lh=function(t){this.xh.push(t)},t.prototype.Mh=function(){this.xh.forEach((function(t){return t()}))},t}(),vn=function(){function t(t,e,n){this.qh=t,this.Ps=e,this.Bh=n}return t.prototype.To=function(t,e){var n=this;return this.Ps.Qh(t,e).next((function(r){return n.Gh(t,e,r)}))},t.prototype.Gh=function(t,e,n){return this.qh.gs(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].qt(e,t);return t}))},t.prototype.Wh=function(t,e,n){var r=qt();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].qt(t,e);r=r.ut(t,e)})),r},t.prototype.Bs=function(t,e){var n=this;return this.qh.getEntries(t,e).next((function(e){return n.mo(t,e)}))},t.prototype.mo=function(t,e){var n=this;return this.Ps.zh(t,e).next((function(r){var i=n.Wh(t,e,r),o=Vt();return i.forEach((function(t,e){e||(e=new bt(t,d.V())),o=o.ut(t,e)})),o}))},t.prototype.Vo=function(t,e,n){return e.Tn()?this.Kh(t,e.path):e.Yn()?this.Jh(t,e,n):this.Hh(t,e,n)},t.prototype.Kh=function(t,e){return this.To(t,new w(e)).next((function(t){var e=Gt();return t instanceof wt&&(e=e.ut(t.key,t)),e}))},t.prototype.Jh=function(t,e,n){var r=this;Te(e.path.M(),"Currently we only support collection group queries at the root.");var i=e.collectionGroup,o=Gt();return this.Bh.Yh(t,i).next((function(s){return Be.forEach(s,(function(s){var a=e.Ln(s.child(i));return r.Hh(t,a,n).next((function(t){t.forEach((function(t,e){o=o.ut(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Hh=function(t,e,n){var r,i,o=this;return this.qh.Vo(t,e,n).next((function(n){return r=n,o.Ps.Xh(t,e)})).next((function(e){return i=e,o.$h(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,a=o.mutations;s<a.length;s++){var u=a[s],c=u.key,h=r.get(c),f=u.qt(h,h,o.gr);r=f instanceof wt?r.ut(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){e.matches(n)||(r=r.remove(t))})),r}))},t.prototype.$h=function(t,e,n){for(var r=Ht(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof lt&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.qh.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof wt&&(c=c.ut(t,e))})),c}))},t}(),yn=function(){function t(){}return t.prototype.xs=function(t){this.Zh=t},t.prototype.Vo=function(t,e,n,r){var i=this;return Te(void 0!==this.Zh,"setLocalDocumentsView() not called"),e.Mn()||n.isEqual(d.MIN)?this.tc(t,e):this.Zh.Bs(t,r).next((function(o){var s=i.nc(e,o);return(e.Kn()||e.Jn())&&i.ic(e.Dn,s,r,n)?i.tc(t,e):(me()<=Xe.LogLevel.DEBUG&&be("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),e.toString()),i.Zh.Vo(t,e,n).next((function(t){return s.forEach((function(e){t=t.ut(e.key,e)})),t})))}))},t.prototype.nc=function(t,e){var n=new T((function(e,n){return t.Bn(e,n)}));return e.forEach((function(e,r){r instanceof wt&&t.matches(r)&&(n=n.add(r))})),n},t.prototype.ic=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.k(r)>0)},t.prototype.tc=function(t,e){return me()<=Xe.LogLevel.DEBUG&&be("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Zh.Vo(t,e,d.MIN)},t}();
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function gn(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=wn(e)),e=mn(t.get(n),e);return wn(e)}function mn(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function wn(t){return t+""}function bn(t){var e=t.length;if(Te(e>=2,"Invalid path "+t),2===e)return Te(""===t.charAt(0)&&""===t.charAt(1),"Non-empty path "+t+" had length 2"),y.Y;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Ie('Invalid encoded resource path: "'+t+'"'),t.charAt(s+1)){case"":var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Ie('Invalid encoded resource path: "'+t+'"')}o=s+2}return new y(r)}
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var En=function(){function t(){this.ec=new _n}return t.prototype.rc=function(t,e){return this.ec.add(e),Be.resolve()},t.prototype.Yh=function(t,e){return Be.resolve(this.ec.getEntries(e))},t}(),_n=function(){function t(){this.index={}}return t.prototype.add=function(t){Te(t.length%2==1,"Expected a collection path.");var e=t.B(),n=t.L(),r=this.index[e]||new T(y.F),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.B(),n=t.L(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new T(y.F)).K()},t}(),In=function(){function t(t,e){this.Bh=t,this.Cs=e,this.Ps=[],this.uc=1,this.lastStreamToken=R.Mt,this.sc=new T(Ke.bn)}return t.prototype.oc=function(t){return Be.resolve(0===this.Ps.length)},t.prototype.Ys=function(t,e,n){var r=e.batchId,i=this.hc(r,"acknowledged");Te(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.Ps[i];return Te(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,Be.resolve()},t.prototype.uo=function(t){return Be.resolve(this.lastStreamToken)},t.prototype.so=function(t,e){return this.lastStreamToken=e,Be.resolve()},t.prototype.Ks=function(t,e,n,r){Te(0!==r.length,"Mutation batches should not be empty");var i=this.uc;this.uc++,this.Ps.length>0&&Te(this.Ps[this.Ps.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new Oe(i,e,n,r);this.Ps.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.sc=this.sc.add(new Ke(u.key,i)),this.Bh.rc(t,u.key.path.L())}return Be.resolve(o)},t.prototype.io=function(t,e){return Be.resolve(this.cc(e))},t.prototype.Hs=function(t,e){var n=this.cc(e);return Te(null!=n,"Failed to find local mutation batch."),Be.resolve(n.keys())},t.prototype._o=function(t,e){var n=e+1,r=this.ac(n),i=r<0?0:r;return Be.resolve(this.Ps.length>i?this.Ps[i]:null)},t.prototype.ro=function(){return Be.resolve(0===this.Ps.length?-1:this.uc-1)},t.prototype.qs=function(t){return Be.resolve(this.Ps.slice())},t.prototype.Qh=function(t,e){var n=this,r=new Ke(e,0),i=new Ke(e,Number.POSITIVE_INFINITY),o=[];return this.sc.kt([r,i],(function(t){Te(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.cc(t.ls);Te(null!==r,"Batches in the index must exist in the main table"),o.push(r)})),Be.resolve(o)},t.prototype.zh=function(t,e){var n=this,r=new T(Ne);return e.forEach((function(t){var e=new Ke(t,0),i=new Ke(t,Number.POSITIVE_INFINITY);n.sc.kt([e,i],(function(e){Te(t.isEqual(e.key),"For each key, should only iterate over a single key's batches"),r=r.add(e.ls)}))})),Be.resolve(this.fc(r))},t.prototype.Xh=function(t,e){Te(!e.Yn(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;w.nt(i)||(i=i.child(""));var o=new Ke(new w(i),0),s=new T(Ne);return this.sc.Nt((function(t){var e=t.key.path;return!!n.G(e)&&(e.length===r&&(s=s.add(t.ls)),!0)}),o),Be.resolve(this.fc(s))},t.prototype.fc=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.cc(t);null!==r&&n.push(r)})),n},t.prototype.eo=function(t,e){var n=this;Te(0===this.hc(e.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.Ps.shift();var r=this.sc;return Be.forEach(e.mutations,(function(i){var o=new Ke(i.key,e.batchId);return r=r.delete(o),n.Cs.lc(t,i.key)})).next((function(){n.sc=r}))},t.prototype.Uo=function(t){},t.prototype.fs=function(t,e){var n=new Ke(e,0),r=this.sc.Ot(n);return Be.resolve(e.isEqual(r&&r.key))},t.prototype.to=function(t){return 0===this.Ps.length&&Te(this.sc.M(),"Document leak -- detected dangling mutation references when queue is empty."),Be.resolve()},t.prototype.hc=function(t,e){var n=this.ac(t);return Te(n>=0&&n<this.Ps.length,"Batches must exist to be "+e),n},t.prototype.ac=function(t){return 0===this.Ps.length?0:t-this.Ps[0].batchId},t.prototype.cc=function(t){var e=this.ac(t);if(e<0||e>=this.Ps.length)return null;var n=this.Ps[e];return Te(n.batchId===t,"If found batch must match"),n},t}(),Tn=function(){function t(t,e){this.Bh=t,this.dc=e,this.docs=new b(w.F),this.size=0}return t.prototype.ms=function(t,e,n){Te(!n.isEqual(d.MIN),"Cannot add a document with a read time of zero");var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.dc(e);return this.docs=this.docs.ut(r,{vc:e,size:s,readTime:n}),this.size+=s-o,this.Bh.rc(t,r.path.L())},t.prototype.bs=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.gs=function(t,e){var n=this.docs.get(e);return Be.resolve(n?n.vc:null)},t.prototype.getEntries=function(t,e){var n=this,r=qt();return e.forEach((function(t){var e=n.docs.get(t);r=r.ut(t,e?e.vc:null)})),Be.resolve(r)},t.prototype.Vo=function(t,e,n){Te(!e.Yn(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=Gt(),i=new w(e.path.child("")),o=this.docs.lt(i);o.gt();){var s=o.bt(),a=s.key,u=s.value,c=u.vc,h=u.readTime;if(!e.path.G(a.path))break;h.k(n)<=0||c instanceof wt&&e.matches(c)&&(r=r.ut(c.key,c))}return Be.resolve(r)},t.prototype.wc=function(t,e){return Be.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Lo=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},t.prototype.qo=function(t){return Be.resolve(d.MIN)},t.prototype.Xs=function(e){return new t.mc(this)},t.prototype.pc=function(t){return Be.resolve(this.size)},t.mc=function(t){function e(e){var n=t.call(this)||this;return n.bc=e,n}return Fe.__extends(e,t),e.prototype.Is=function(t){var e=this,n=[];return this.ds.forEach((function(r,i){i?n.push(e.bc.ms(t,i,e.readTime)):e.bc.bs(r)})),Be.pu(n)},e.prototype.ys=function(t,e){return this.bc.gs(t,e)},e.prototype._s=function(t,e){return this.bc.getEntries(t,e)},e}(Je),t}(),An=function(){function t(t,e){this.gc=t,Te((1&t)===t,"Generator ID "+t+" contains more than 1 reserved bits"),this.yc(void 0!==e?e:this.gc)}return t.prototype.next=function(){var t=this._c;return this._c+=2,t},t.prototype.after=function(t){return this.yc(t+2),this.next()},t.prototype.yc=function(t){Te((1&t)===this.gc,"Cannot supply target ID from different generator ID"),this._c=t},t.Ic=function(){return new t(0,2)},t.Tc=function(){return new t(1)},t}(),Nn=function(){function t(t){this.persistence=t,this.Ec=new Ce((function(t){return t.canonicalId()})),this.lastRemoteSnapshotVersion=d.MIN,this.highestTargetId=0,this.Dc=0,this.Rc=new Qe,this.targetCount=0,this.Sc=An.Ic()}return t.prototype.$i=function(t,e){return this.Ec.forEach((function(t,n){return e(n)})),Be.resolve()},t.prototype.oo=function(t){return Be.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Ac=function(t){return Be.resolve(this.Dc)},t.prototype.Ro=function(t){var e=this.Sc.after(this.highestTargetId);return this.highestTargetId=e,Be.resolve(e)},t.prototype.wo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Dc&&(this.Dc=e),Be.resolve()},t.prototype.Cc=function(t){this.Ec.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.Dc&&(this.Dc=t.sequenceNumber)},t.prototype.So=function(t,e){return Te(!this.Ec.has(e.target),"Adding a target that already exists"),this.Cc(e),this.targetCount+=1,Be.resolve()},t.prototype.do=function(t,e){return Te(this.Ec.has(e.target),"Updating a non-existent target"),this.Cc(e),Be.resolve()},t.prototype.Pc=function(t,e){return Te(this.targetCount>0,"Removing a target from an empty cache"),Te(this.Ec.has(e.target),"Removing a non-existent target from the cache"),this.Ec.delete(e.target),this.Rc.hs(e.targetId),this.targetCount-=1,Be.resolve()},t.prototype.Ju=function(t,e,n){var r=this,i=0,o=[];return this.Ec.forEach((function(s,a){a.sequenceNumber<=e&&null===n.get(a.targetId)&&(r.Ec.delete(s),o.push(r.Vc(t,a.targetId)),i++)})),Be.pu(o).next((function(){return i}))},t.prototype.kc=function(t){return Be.resolve(this.targetCount)},t.prototype.Do=function(t,e){var n=this.Ec.get(e)||null;return Be.resolve(n)},t.prototype.ce=function(t,e){return Ie("Not yet implemented.")},t.prototype.ao=function(t,e,n){this.Rc.rs(e,n);var r=this.persistence.Cs,i=[];return r&&e.forEach((function(e){i.push(r.es(t,e))})),Be.pu(i)},t.prototype.co=function(t,e,n){this.Rc.os(e,n);var r=this.persistence.Cs,i=[];return r&&e.forEach((function(e){i.push(r.us(t,e))})),Be.pu(i)},t.prototype.Vc=function(t,e){return this.Rc.hs(e),Be.resolve()},t.prototype.Po=function(t,e){var n=this.Rc.as(e);return Be.resolve(n)},t.prototype.fs=function(t,e){return Be.resolve(this.Rc.fs(e))},t}(),Sn="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",kn=function(){function t(t,e){var n=this;this.clientId=t,this.Nc={},this.Oc=new Le(0),this.Fc=!1,this.Fc=!0,this.Cs=e(this),this.Os=new Nn(this),this.Bh=new En,this.qh=new Tn(this.Bh,(function(t){return n.Cs.Uc(t)}))}return t.prototype.shutdown=function(){return this.Fc=!1,Promise.resolve()},Object.defineProperty(t.prototype,"qu",{get:function(){return this.Fc},enumerable:!0,configurable:!0}),t.prototype.Oo=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){return[2,[this.clientId]]}))}))},t.prototype.jc=function(t){return t(!0)},t.prototype.xc=function(){},t.prototype.jo=function(t){},t.prototype.js=function(){return this.Bh},t.prototype.Vs=function(t){var e=this.Nc[t.i()];return e||(e=new In(this.Bh,this.Cs),this.Nc[t.i()]=e),e},t.prototype.Fs=function(){return this.Os},t.prototype.Ns=function(){return this.qh},t.prototype.runTransaction=function(t,e,n){var r=this;be("MemoryPersistence","Starting transaction:",t);var i=new Rn(this.Oc.next());return this.Cs.Lc(),n(i).next((function(t){return r.Cs.Mc(i).next((function(){return t}))})).wu().then((function(t){return i.Mh(),t}))},t.prototype.qc=function(t,e){return Be.bu(Object.values(this.Nc).map((function(n){return function(){return n.fs(t,e)}})))},t}(),Rn=function(t){function e(e){var n=t.call(this)||this;return n.fo=e,n}return Fe.__extends(e,t),e}(dn),On=function(){function t(t){this.persistence=t,this.Bc=null,this.Qc=null}return Object.defineProperty(t.prototype,"Gc",{get:function(){if(this.Qc)return this.Qc;throw Ie("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),t.prototype.As=function(t){this.Bc=t},t.prototype.es=function(t,e){return this.Gc.delete(e),Be.resolve()},t.prototype.us=function(t,e){return this.Gc.add(e),Be.resolve()},t.prototype.lc=function(t,e){return this.Gc.add(e),Be.resolve()},t.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.Fs();return r.Po(t,e.targetId).next((function(t){t.forEach((function(t){return n.Gc.add(t)}))})).next((function(){return r.Pc(t,e)}))},t.prototype.Lc=function(){this.Qc=new Set},t.prototype.Mc=function(t){var e=this,n=this.persistence.Ns().Xs();return Be.forEach(this.Gc,(function(r){return e.Wc(t,r).next((function(t){t||n.bs(r)}))})).next((function(){return e.Qc=null,n.apply(t)}))},t.prototype.vo=function(t,e){var n=this;return this.Wc(t,e).next((function(t){t?n.Gc.delete(e):n.Gc.add(e)}))},t.prototype.Uc=function(t){return 0},t.prototype.Wc=function(t,e){var n=this;return Be.bu([function(){return n.persistence.Fs().fs(t,e)},function(){return n.persistence.qc(t,e)},function(){return Be.resolve(n.Bc.fs(e))}])},t}(),xn=function(){function t(){}return t.prototype.initialize=function(t,e,n,r,i,a){if(a.zc)throw new s(o.FAILED_PRECONDITION,Sn);return this.clientId=r,Promise.resolve()},t.prototype.Kc=function(){var t=!1;return{qu:t,start:function(){return t=!0},stop:function(){return t=!1}}},t.prototype.Jc=function(){return Te(!!this.clientId,"initialize() not called"),new kn(this.clientId,(function(t){return new On(t)}))},t.prototype.Hc=function(){return new ln},t.prototype.clearPersistence=function(){throw new s(o.FAILED_PRECONDITION,Sn)},t}(),Cn=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.zo=t,this.Fr=e,this.Yc=n,this.Xc=r,this.$c=i,this.Zc=0,this.ta=null,this.na=Date.now(),this.reset()}return t.prototype.reset=function(){this.Zc=0},t.prototype.ia=function(){this.Zc=this.$c},t.prototype.ea=function(t){var e=this;this.cancel();var n=Math.floor(this.Zc+this.ra()),r=Math.max(0,Date.now()-this.na),i=Math.max(0,n-r);this.Zc>0&&be("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Zc+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ta=this.zo.iu(this.Fr,i,(function(){return e.na=Date.now(),t()})),this.Zc*=this.Xc,this.Zc<this.Yc&&(this.Zc=this.Yc),this.Zc>this.$c&&(this.Zc=this.$c)},t.prototype.cancel=function(){null!==this.ta&&(this.ta.cancel(),this.ta=null)},t.prototype.ra=function(){return(Math.random()-.5)*this.Zc},t}(),Pn=function(){function t(t,e,n,r,i,o){this.zo=t,this.ua=n,this.connection=r,this.sa=i,this.listener=o,this.state=0,this.oa=0,this.ha=null,this.stream=null,this.ca=new Cn(t,e)}return t.prototype.aa=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.fa=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?(Te(0===this.state,"Already started"),this.auth()):this.la()},t.prototype.stop=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return this.aa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.da=function(){Te(!this.aa(),"Can only inhibit backoff in a stopped state"),this.state=0,this.ca.reset()},t.prototype.va=function(){var t=this;this.fa()&&null===this.ha&&(this.ha=this.zo.iu(this.ua,6e4,(function(){return t.wa()})))},t.prototype.ma=function(t){this.pa(),this.stream.send(t)},t.prototype.wa=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){return this.fa()?[2,this.close(0)]:[2]}))}))},t.prototype.pa=function(){this.ha&&(this.ha.cancel(),this.ha=null)},t.prototype.close=function(t,e){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(n){switch(n.label){case 0:return Te(this.aa(),"Only started streams should be closed."),Te(3===t||D(e),"Can't provide an error when not in an error state."),this.pa(),this.ca.cancel(),this.oa++,3!==t?this.ca.reset():e&&e.code===o.RESOURCE_EXHAUSTED?(Ee(e.toString()),Ee("Using maximum backoff delay to prevent overloading the backend."),this.ca.ia()):e&&e.code===o.UNAUTHENTICATED&&this.sa.l(),null!==this.stream&&(this.ba(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.ga(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ba=function(){},t.prototype.auth=function(){var t=this;Te(0===this.state,"Must be in initial state to auth"),this.state=1;var e=this.ya(this.oa),n=this.oa;this.sa.getToken().then((function(e){t.oa===n&&t._a(e)}),(function(n){e((function(){var e=new s(o.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Ia(e)}))}))},t.prototype._a=function(t){var e=this;Te(1===this.state,"Trying to start stream in a non-starting state");var n=this.ya(this.oa);this.stream=this.Ta(t),this.stream.Ea((function(){n((function(){return Te(1===e.state,"Expected stream to be in state Starting, but was "+e.state),e.state=2,e.listener.Ea()}))})),this.stream.ga((function(t){n((function(){return e.Ia(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.la=function(){var t=this;Te(3===this.state,"Should only perform backoff when in Error state"),this.state=4,this.ca.ea((function(){return Fe.__awaiter(t,void 0,void 0,(function(){return Fe.__generator(this,(function(t){return Te(4===this.state,"Backoff elapsed but state is now: "+this.state),this.state=0,this.start(),Te(this.aa(),"PersistentStream should have started"),[2]}))}))}))},t.prototype.Ia=function(t){return Te(this.aa(),"Can't handle server close on non-started stream"),be("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.ya=function(t){var e=this;return function(n){e.zo.Qr((function(){return e.oa===t?n():(be("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Ln=function(t){function e(e,n,r,i,o){var s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this;return s.serializer=i,s}return Fe.__extends(e,t),e.prototype.Ta=function(t){return this.connection.Da("Listen",t)},e.prototype.onMessage=function(t){this.ca.reset();var e=this.serializer.ke(t),n=this.serializer.Oe(t);return this.listener.Ra(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.De,e.addTarget=this.serializer.qn(t);var n=this.serializer.nr(t);n&&(e.labels=n),this.ma(e)},e.prototype.Sa=function(t){var e={};e.database=this.serializer.De,e.removeTarget=t,this.ma(e)},e}(Pn),Mn=function(t){function e(e,n,r,i,o){var s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this;return s.serializer=i,s.Aa=!1,s.lastStreamToken=R.Mt,s}return Fe.__extends(e,t),Object.defineProperty(e.prototype,"Ca",{get:function(){return this.Aa},enumerable:!0,configurable:!0}),e.prototype.start=function(){this.Aa=!1,t.prototype.start.call(this)},e.prototype.ba=function(){this.Aa&&this.Pa([])},e.prototype.Ta=function(t){return this.connection.Da("Write",t)},e.prototype.onMessage=function(t){if(Te(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.pe(t.streamToken),this.Aa){this.ca.reset();var e=this.serializer.Ge(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Va(n,e)}return Te(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.Aa=!0,this.listener.ka()},e.prototype.Na=function(){Te(this.fa(),"Writing handshake requires an opened stream"),Te(!this.Aa,"Handshake already completed");var t={};t.database=this.serializer.De,this.ma(t)},e.prototype.Pa=function(t){var e=this;Te(this.fa(),"Writing mutations requires an opened stream"),Te(this.Aa,"Handshake must be complete before writing mutations"),Te(this.lastStreamToken.Lt()>0,"Trying to write mutation without a token");var n={streamToken:this.serializer.me(this.lastStreamToken),writes:t.map((function(t){return e.serializer.Fe(t)}))};this.ma(n)},e}(Pn),Un=function(){function t(t,e,n,r){this.zo=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.Oa=function(t){return new Mn(this.zo,this.connection,this.credentials,this.serializer,t)},t.prototype.Fa=function(t){return new Ln(this.zo,this.connection,this.credentials,this.serializer,t)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.De,writes:t.map((function(t){return e.serializer.Fe(t)}))};return this.Ua("Commit",n).then((function(t){return e.serializer.Ge(t.writeResults,t.commitTime)}))},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.De,documents:t.map((function(t){return e.serializer._e(t)}))};return this.ja("BatchGetDocuments",n).then((function(n){var r=Vt();n.forEach((function(t){var n=e.serializer.Ve(t);r=r.ut(n.key,n)}));var i=[];return t.forEach((function(t){var e=r.get(t);Te(!!e,"Missing entity in write response for "+t),i.push(e)})),i}))},t.prototype.Ua=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.Ua(t,e,r)})).catch((function(t){throw t.code===o.UNAUTHENTICATED&&n.credentials.l(),t}))},t.prototype.ja=function(t,e){var n=this;return this.credentials.getToken().then((function(r){return n.connection.ja(t,e,r)})).catch((function(t){throw t.code===o.UNAUTHENTICATED&&n.credentials.l(),t}))},t}();
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function jn(t,e){if(0!==e.length)throw new s(o.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+rr(e.length,"argument")+".")}function Bn(t,e,n){if(e.length!==n)throw new s(o.INVALID_ARGUMENT,"Function "+t+"() requires "+rr(n,"argument")+", but was called with "+rr(e.length,"argument")+".")}function Fn(t,e,n){if(e.length<n)throw new s(o.INVALID_ARGUMENT,"Function "+t+"() requires at least "+rr(n,"argument")+", but was called with "+rr(e.length,"argument")+".")}function Vn(t,e,n,r){if(e.length<n||e.length>r)throw new s(o.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+rr(e.length,"argument")+".")}function qn(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new s(o.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+rr(r,"element")+".")}function zn(t,e,n,r){Qn(t,e,nr(n)+" argument",r)}function Gn(t,e,n,r){void 0!==r&&zn(t,e,n,r)}function $n(t,e,n,r){Qn(t,e,n+" option",r)}function Wn(t,e,n,r){void 0!==r&&$n(t,e,n,r)}function Yn(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var a=[],u=0,c=i;u<c.length;u++){var h=c[u];if(h===r)return;a.push(Jn(h))}var f=Jn(r);throw new s(o.INVALID_ARGUMENT,"Invalid value "+f+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+a.join(", "))}(t,0,n,r,i)}function Hn(t,e,n,r){if(!e.some((function(t){return t===r})))throw new s(o.INVALID_ARGUMENT,"Invalid value "+Jn(r)+" provided to function "+t+"() for its "+nr(n)+" argument. Acceptable values: "+e.join(", "))}function Qn(t,e,n,r){if(!("object"===e?Kn(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Jn(r);throw new s(o.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Kn(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Jn(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Ie("Unknown wrong type: "+typeof t)}function Xn(t,e,n){if(void 0===n)throw new s(o.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+nr(e)+" argument, but it was undefined.")}function Zn(t,e,n){S(e,(function(e,r){if(n.indexOf(e)<0)throw new s(o.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function tr(t,e,n,r){var i=Jn(r);return new s(o.INVALID_ARGUMENT,"Function "+t+"() requires its "+nr(n)+" argument to be a "+e+", but it was: "+i)}function er(t,e,n){if(n<=0)throw new s(o.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+nr(e)+" argument to be a positive number, but it was: "+n+".")}function nr(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function rr(t,e){return t+" "+e+(1===t?"":"s")}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function ir(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new s(o.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}function or(){if("undefined"==typeof Uint8Array)throw new s(o.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function sr(){if(!ye.xt().xa)throw new s(o.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var ar=function(){function t(t){sr(),this.La=t}return t.fromBase64String=function(e){Bn("Blob.fromBase64String",arguments,1),zn("Blob.fromBase64String","string",1,e),sr();try{return new t(R.fromBase64String(e))}catch(t){throw new s(o.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(Bn("Blob.fromUint8Array",arguments,1),or(),!(e instanceof Uint8Array))throw tr("Blob.fromUint8Array","Uint8Array",1,e);return new t(R.fromUint8Array(e))},t.prototype.toBase64=function(){return Bn("Blob.toBase64",arguments,0),sr(),this.La.toBase64()},t.prototype.toUint8Array=function(){return Bn("Blob.toUint8Array",arguments,0),or(),this.La.toUint8Array()},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.La.isEqual(t.La)},t}(),ur=ir(ar,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),cr=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];qn("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(zn("FieldPath","string",n,t[n]),0===t[n].length)throw new s(o.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ma=new m(t)}return t.documentId=function(){return t.qa},t.prototype.isEqual=function(e){if(!(e instanceof t))throw tr("isEqual","FieldPath",1,e);return this.Ma.isEqual(e.Ma)},t.qa=new t(m.Z().J()),t}(),hr=new RegExp("[~\\*/\\[\\]]"),fr=function(){function t(t){this.Ba=t}return t.delete=function(){return jn("FieldValue.delete",arguments),lr.instance},t.serverTimestamp=function(){return jn("FieldValue.serverTimestamp",arguments),pr.instance},t.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Fn("FieldValue.arrayUnion",arguments,1),new dr(t)},t.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Fn("FieldValue.arrayRemove",arguments,1),new vr(t)},t.increment=function(t){return zn("FieldValue.increment","number",1,t),Bn("FieldValue.increment",arguments,1),new yr(t)},t.prototype.isEqual=function(t){return this===t},t}(),lr=function(t){function e(){return t.call(this,"FieldValue.delete")||this}return Fe.__extends(e,t),e.instance=new e,e}(fr),pr=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp")||this}return Fe.__extends(e,t),e.instance=new e,e}(fr),dr=function(t){function e(e){var n=t.call(this,"FieldValue.arrayUnion")||this;return n.Qa=e,n}return Fe.__extends(e,t),e}(fr),vr=function(t){function e(e){var n=t.call(this,"FieldValue.arrayRemove")||this;return n.Qa=e,n}return Fe.__extends(e,t),e}(fr),yr=function(t){function e(e){var n=t.call(this,"FieldValue.increment")||this;return n.Ga=e,n}return Fe.__extends(e,t),e}(fr),gr=ir(fr,"Use FieldValue.<field>() instead."),mr=function(){function t(t,e){if(Bn("GeoPoint",arguments,2),zn("GeoPoint","number",1,t),zn("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new s(o.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new s(o.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Wa=t,this.za=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.Wa},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.za},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this.Wa===t.Wa&&this.za===t.za},t.prototype.A=function(t){return Ne(this.Wa,t.Wa)||Ne(this.za,t.za)},t}(),wr=/^__.*__$/,br=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.Ka=function(t,e){var n=[];return null!==this.en?n.push(new lt(t,this.data,this.en,e)):n.push(new ft(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new pt(t,this.fieldTransforms)),n},t}(),Er=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.Ka=function(t,e){var n=[new lt(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new pt(t,this.fieldTransforms)),n},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function _r(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie("Unexpected case for UserDataSource: "+t)}}var Ir=function(){function t(t,e,n,r,i,o){this.Ja=t,this.methodName=e,this.path=n,this.Ha=r,void 0===i&&this.Ya(),this.Ha=void 0!==r&&r,this.fieldTransforms=i||[],this.en=o||[]}return t.prototype.Xa=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.Ja,this.methodName,n,!1,this.fieldTransforms,this.en);return r.$a(e),r},t.prototype.Za=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.Ja,this.methodName,n,!1,this.fieldTransforms,this.en);return r.Ya(),r},t.prototype.tf=function(e){return new t(this.Ja,this.methodName,null,!0,this.fieldTransforms,this.en)},t.prototype.nf=function(t){var e=null===this.path||this.path.M()?"":" (found in field "+this.path.toString()+")";return new s(o.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.contains=function(t){return void 0!==this.en.find((function(e){return t.G(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.G(e.field)}))},t.prototype.Ya=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.$a(this.path.get(t))},t.prototype.$a=function(t){if(0===t.length)throw this.nf("Document fields must not be empty");if(_r(this.Ja)&&wr.test(t))throw this.nf('Document fields cannot begin and end with "__"')},t}(),Tr=function(t,e){this.ae=t,this.key=e},Ar=function(){function t(t,e){this.serializer=t,this.if=e}return t.prototype.ef=function(t,e){var n=new Ir(0,t,m.Y);Sr("Data must be an object, but it was:",n,e);var r=this.rf(e,n);return new br(new yt(r),null,n.fieldTransforms)},t.prototype.uf=function(t,e,n){var r=new Ir(2,t,m.Y);Sr("Data must be an object, but it was:",r,e);var i,a,u=this.rf(e,r);if(n){for(var c=new T(m.F),h=0,f=n;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof cr)p=l.Ma;else{if("string"!=typeof l)throw Ie("Expected stringOrFieldPath to be a string or a FieldPath");p=Rr(t,l)}if(!r.contains(p))throw new s(o.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");c=c.add(p)}i=st.Kt(c),a=r.fieldTransforms.filter((function(t){return i.Ht(t.field)}))}else i=st.Jt(r.en),a=r.fieldTransforms;return new br(new yt(u),i,a)},t.prototype.sf=function(t,e){var n=this,r=new Ir(1,t,m.Y);Sr("Data must be an object, but it was:",r,e);var i=new T(m.F),o=yt.ln();S(e,(function(e,s){var a=Rr(t,e),u=r.Za(a);if((s=n.hf(s,u))instanceof lr)i=i.add(a);else{var c=n.cf(s,u);null!=c&&(i=i.add(a),o.set(a,c))}}));var s=st.Kt(i);return new Er(o.on(),s,r.fieldTransforms)},t.prototype.af=function(t,e,n,r){var i=new Ir(1,t,m.Y),a=[kr(t,e)],u=[n];if(r.length%2!=0)throw new s(o.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<r.length;c+=2)a.push(kr(t,r[c])),u.push(r[c+1]);var h=new T(m.F),f=yt.ln();for(c=0;c<a.length;++c){var l=a[c],p=i.Za(l),d=this.hf(u[c],p);if(d instanceof lr)h=h.add(l);else{var v=this.cf(d,p);null!=v&&(h=h.add(l),f.set(l,v))}}var y=st.Kt(h);return new Er(f.on(),y,i.fieldTransforms)},t.prototype.ff=function(t,e,n){void 0===n&&(n=!1);var r=new Ir(n?4:3,t,m.Y),i=this.cf(e,r);return Te(null!=i,"Parsed data should not be null."),Te(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},t.prototype.hf=function(t,e){try{return this.if(t)}catch(t){var n=Dr(t);throw e.nf(n)}},t.prototype.cf=function(t,e){if(Nr(t=this.hf(t,e)))return Sr("Unsupported field value:",e,t),this.rf(t,e);if(t instanceof fr)return this.lf(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.Ha&&4!==e.Ja)throw e.nf("Nested arrays are not supported");return this.df(t,e)}return this.vf(t,e)},t.prototype.rf=function(t,e){var n=this,r={};return k(t)?e.path&&e.path.length>0&&e.en.push(e.path):S(t,(function(t,i){var o=n.cf(i,e.Xa(t));null!=o&&(r[t]=o)})),{mapValue:{fields:r}}},t.prototype.df=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=o[i],a=this.cf(s,e.tf(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}},t.prototype.lf=function(t,e){if(!_r(e.Ja))throw e.nf(t.Ba+"() can only be used with update() and set()");if(null===e.path)throw e.nf(t.Ba+"() is not currently supported inside arrays");if(t instanceof lr){if(2!==e.Ja)throw 1===e.Ja?(Te(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.nf("FieldValue.delete() can only appear at the top level of your update data")):e.nf("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.en.push(e.path)}else if(t instanceof pr)e.fieldTransforms.push(new at(e.path,Z.instance));else if(t instanceof dr){var n=this.wf(t.Ba,t.Qa),r=new tt(n);e.fieldTransforms.push(new at(e.path,r))}else if(t instanceof vr){n=this.wf(t.Ba,t.Qa);var i=new et(n);e.fieldTransforms.push(new at(e.path,i))}else if(t instanceof yr){var o=this.ff("FieldValue.increment",t.Ga),s=new nt(this.serializer,o);e.fieldTransforms.push(new at(e.path,s))}else Ie("Unknown FieldValue type: "+t)},t.prototype.vf=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.we(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=p.fromDate(t);return{timestampValue:this.serializer.O(n)}}if(t instanceof p)return n=new p(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:this.serializer.O(n)};if(t instanceof mr)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ar)return{bytesValue:this.serializer.me(t)};if(t instanceof Tr)return{referenceValue:this.serializer.be(t.key.path,t.ae)};throw e.nf("Unsupported field value: "+Jn(t))},t.prototype.wf=function(t,e){var n=this;return e.map((function(e,r){var i=new Ir(3,t,m.Y);return n.cf(e,i.tf(r))}))},t}();function Nr(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof p||t instanceof mr||t instanceof ar||t instanceof Tr||t instanceof fr)}function Sr(t,e,n){if(!Nr(n)||!Kn(n)){var r=Jn(n);throw"an object"===r?e.nf(t+" a custom object"):e.nf(t+" "+r)}}function kr(t,e){if(e instanceof cr)return e.Ma;if("string"==typeof e)return Rr(t,e);throw new s(o.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Rr(t,e){try{return function(t){if(t.search(hr)>=0)throw new s(o.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(cr.bind.apply(cr,Fe.__spreadArrays([void 0],t.split("."))))}catch(e){throw new s(o.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ma}catch(e){var n=Dr(e);throw new s(o.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Dr(t){return t instanceof Error?t.message:t.toString()}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Or=function(){function t(t){this.mf=t,this.pf=Wt(),this.mutations=[],this.bf=!1,this.gf=null,this.yf=new Set}return t.prototype.lookup=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n=this;return Fe.__generator(this,(function(r){switch(r.label){case 0:if(this._f(),this.mutations.length>0)throw new s(o.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.mf.lookup(t)];case 1:return(e=r.sent()).forEach((function(t){t instanceof bt||t instanceof wt?n.If(t):Ie("Document in a transaction was a "+t.constructor.name)})),[2,e]}}))}))},t.prototype.set=function(t,e){this.write(e.Ka(t,this.tn(t))),this.yf.add(t)},t.prototype.update=function(t,e){try{this.write(e.Ka(t,this.Tf(t)))}catch(t){this.gf=t}this.yf.add(t)},t.prototype.delete=function(t){this.write([new dt(t,this.tn(t))]),this.yf.add(t)},t.prototype.commit=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t,e=this;return Fe.__generator(this,(function(n){switch(n.label){case 0:if(this._f(),this.gf)throw this.gf;return t=this.pf,this.mutations.forEach((function(e){t=t.remove(e.key)})),t.forEach((function(t,n){e.mutations.push(new vt(t,e.tn(t)))})),[4,this.mf.commit(this.mutations)];case 1:return n.sent(),this.bf=!0,[2]}}))}))},t.prototype.If=function(t){var e;if(t instanceof wt)e=t.version;else{if(!(t instanceof bt))throw Ie("Document in a transaction was a "+t.constructor.name);e=d.V()}var n=this.pf.get(t.key);if(null!==n){if(!e.isEqual(n))throw new s(o.ABORTED,"Document version changed between two reads.")}else this.pf=this.pf.ut(t.key,e)},t.prototype.tn=function(t){var e=this.pf.get(t);return!this.yf.has(t)&&e?ct.updateTime(e):ct.NONE},t.prototype.Tf=function(t){var e=this.pf.get(t);if(!this.yf.has(t)&&e){if(e.isEqual(d.V()))throw new s(o.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ct.updateTime(e)}return ct.exists(!0)},t.prototype.write=function(t){this._f(),this.mutations=this.mutations.concat(t)},t.prototype._f=function(){Te(!this.bf,"A transaction object cannot be used after its update callback has been invoked.")},t}(),xr=function(){function t(t,e){this.Or=t,this.Ho=e,this.state="Unknown",this.Ef=0,this.Df=null,this.Rf=!0}return t.prototype.Sf=function(){var t=this;0===this.Ef&&(this.Af("Unknown"),Te(null===this.Df,"onlineStateTimer shouldn't be started yet"),this.Df=this.Or.iu("online_state_timeout",1e4,(function(){return t.Df=null,Te("Unknown"===t.state,"Timer should be canceled if we transitioned to a different state."),t.Cf("Backend didn't respond within 10 seconds."),t.Af("Offline"),Promise.resolve()})))},t.prototype.Pf=function(t){"Online"===this.state?(this.Af("Unknown"),Te(0===this.Ef,"watchStreamFailures must be 0"),Te(null===this.Df,"onlineStateTimer must be null")):(this.Ef++,this.Ef>=1&&(this.Vf(),this.Cf("Connection failed 1 times. Most recent error: "+t.toString()),this.Af("Offline")))},t.prototype.set=function(t){this.Vf(),this.Ef=0,"Online"===t&&(this.Rf=!1),this.Af(t)},t.prototype.Af=function(t){t!==this.state&&(this.state=t,this.Ho(t))},t.prototype.Cf=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rf?(Ee(e),this.Rf=!1):be("OnlineStateTracker",e)},t.prototype.Vf=function(){null!==this.Df&&(this.Df.cancel(),this.Df=null)},t}(),Cr=function(){function t(t,e,n,r,i){var o=this;this.kf=t,this.mf=e,this.Nf=[],this.Of=new Map,this.Ff=null,this.networkEnabled=!1,this.isPrimary=!1,this.Uf=i,this.Uf.jf((function(t){n.Qr((function(){return Fe.__awaiter(o,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return this.xf()?(be("RemoteStore","Restarting streams for network reachability change."),[4,this.Lf()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Mf=new xr(n,r),this.qf=this.mf.Fa({Ea:this.Bf.bind(this),ga:this.Qf.bind(this),Ra:this.Gf.bind(this)}),this.Wf=this.mf.Oa({Ea:this.zf.bind(this),ga:this.Kf.bind(this),ka:this.Jf.bind(this),Va:this.Va.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t;return Fe.__generator(this,(function(e){switch(e.label){case 0:return this.networkEnabled=!0,this.xf()?(t=this.Wf,[4,this.kf.uo()]):[3,3];case 1:return t.lastStreamToken=e.sent(),this.Hf()?this.Yf():this.Mf.set("Unknown"),[4,this.Xf()];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},t.prototype.disableNetwork=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.$f()];case 1:return t.sent(),this.Mf.set("Offline"),[2]}}))}))},t.prototype.$f=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return[4,this.Wf.stop()];case 1:return t.sent(),[4,this.qf.stop()];case 2:return t.sent(),this.Nf.length>0&&(be("RemoteStore","Stopping write stream with "+this.Nf.length+" pending writes"),this.Nf=[]),this.Zf(),[2]}}))}))},t.prototype.shutdown=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return be("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.$f()];case 1:return t.sent(),this.Uf.shutdown(),this.Mf.set("Unknown"),[2]}}))}))},t.prototype.listen=function(t){this.Of.has(t.targetId)||(this.Of.set(t.targetId,t),this.Hf()?this.Yf():this.qf.fa()&&this.tl(t))},t.prototype.nl=function(t){Te(this.Of.has(t),"unlisten called on target no currently watched: "+t),this.Of.delete(t),this.qf.fa()&&this.il(t),0===this.Of.size&&(this.qf.fa()?this.qf.va():this.xf()&&this.Mf.set("Unknown"))},t.prototype.ce=function(t){return this.Of.get(t)||null},t.prototype.he=function(t){return this.Jo.he(t)},t.prototype.tl=function(t){this.Ff.Mi(t.targetId),this.qf.watch(t)},t.prototype.il=function(t){this.Ff.Mi(t),this.qf.Sa(t)},t.prototype.Yf=function(){Te(this.Hf(),"startWatchStream() called when shouldStartWatchStream() is false."),this.Ff=new se(this),this.qf.start(),this.Mf.Sf()},t.prototype.Hf=function(){return this.xf()&&!this.qf.aa()&&this.Of.size>0},t.prototype.xf=function(){return this.isPrimary&&this.networkEnabled},t.prototype.Zf=function(){this.Ff=null},t.prototype.Bf=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t=this;return Fe.__generator(this,(function(e){return this.Of.forEach((function(e,n){t.tl(e)})),[2]}))}))},t.prototype.Qf=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(e){return void 0===t&&Te(!this.Hf(),"Watch stream was stopped gracefully while still needed."),this.Zf(),this.Hf()?(this.Mf.Pf(t),this.Yf()):this.Mf.set("Unknown"),[2]}))}))},t.prototype.Gf=function(t,e){return Fe.__awaiter(this,void 0,void 0,(function(){var n;return Fe.__generator(this,(function(r){switch(r.label){case 0:return this.Mf.set("Online"),t instanceof ie&&2===t.state&&t.cause?[2,this.el(t)]:(t instanceof ne?this.Ff.Ji(t):t instanceof re?this.Ff.ie(t):(Te(t instanceof ie,"Expected watchChange to be an instance of WatchTargetChange"),this.Ff.Xi(t)),e.isEqual(d.MIN)?[3,3]:[4,this.kf.oo()]);case 1:return n=r.sent(),e.k(n)>=0?[4,this.rl(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},t.prototype.rl=function(t){var e=this;Te(!t.isEqual(d.MIN),"Can't raise event for unknown SnapshotVersion");var n=this.Ff.ue(t);return n.wi.forEach((function(n,r){if(n.resumeToken.Lt()>0){var i=e.Of.get(r);i&&e.Of.set(r,i.ei(n.resumeToken,t))}})),n.mi.forEach((function(t){var n=e.Of.get(t);if(n){e.Of.set(t,n.ei(R.Mt,n.ni)),e.il(t);var r=new Mt(n.target,t,1,n.sequenceNumber);e.tl(r)}})),this.Jo.ho(n)},t.prototype.el=function(t){var e=this;Te(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach((function(t){r=r.then((function(){return Fe.__awaiter(e,void 0,void 0,(function(){return Fe.__generator(this,(function(e){return this.Of.has(t)?(this.Of.delete(t),this.Ff.removeTarget(t),[2,this.Jo.ul(t,n)]):[2]}))}))}))})),r},t.prototype.Xf=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t,e;return Fe.__generator(this,(function(n){switch(n.label){case 0:return this.sl()?(t=this.Nf.length>0?this.Nf[this.Nf.length-1].batchId:-1,[4,this.kf.yo(t)]):[3,4];case 1:return null!==(e=n.sent())?[3,2]:(0===this.Nf.length&&this.Wf.va(),[3,4]);case 2:return this.ol(e),[4,this.Xf()];case 3:n.sent(),n.label=4;case 4:return this.hl()&&this.cl(),[2]}}))}))},t.prototype.sl=function(){return this.xf()&&this.Nf.length<10},t.prototype.al=function(){return this.Nf.length},t.prototype.ol=function(t){Te(this.sl(),"addToWritePipeline called when pipeline is full"),this.Nf.push(t),this.Wf.fa()&&this.Wf.Ca&&this.Wf.Pa(t.mutations)},t.prototype.hl=function(){return this.xf()&&!this.Wf.aa()&&this.Nf.length>0},t.prototype.cl=function(){Te(this.hl(),"startWriteStream() called when shouldStartWriteStream() is false."),this.Wf.start()},t.prototype.zf=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){return this.Wf.Na(),[2]}))}))},t.prototype.Jf=function(){var t=this;return this.kf.so(this.Wf.lastStreamToken).then((function(){for(var e=0,n=t.Nf;e<n.length;e++){var r=n[e];t.Wf.Pa(r.mutations)}})).catch(en)},t.prototype.Va=function(t,e){var n=this;Te(this.Nf.length>0,"Got result for empty write pipeline");var r=this.Nf.shift(),i=xe.from(r,t,e,this.Wf.lastStreamToken);return this.Jo.fl(i).then((function(){return n.Xf()}))},t.prototype.Kf=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e=this;return Fe.__generator(this,(function(n){return void 0===t&&Te(!this.hl(),"Write stream was stopped gracefully while still needed."),t&&this.Nf.length>0?[2,(this.Wf.Ca?this.ll(t):this.dl(t)).then((function(){e.hl()&&e.cl()}))]:[2]}))}))},t.prototype.dl=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(e){return jt(t.code)?(be("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.Wf.lastStreamToken),this.Wf.lastStreamToken=R.Mt,[2,this.kf.so(R.Mt).catch(en)]):[2]}))}))},t.prototype.ll=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n=this;return Fe.__generator(this,(function(r){return jt(i=t.code)&&i!==o.ABORTED?(e=this.Nf.shift(),this.Wf.da(),[2,this.Jo.vl(e.batchId,t).then((function(){return n.Xf()}))]):[2];var i}))}))},t.prototype.wl=function(){return new Or(this.mf)},t.prototype.Lf=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.$f()];case 1:return t.sent(),this.Mf.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}}))}))},t.prototype.ml=function(){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return this.xf()?(be("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Lf()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.pl=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){return Fe.__generator(this,(function(e){switch(e.label){case 0:return this.isPrimary=t,t&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return e.sent(),[3,4];case 2:return t?[3,4]:[4,this.$f()];case 3:e.sent(),this.Mf.set("Unknown"),e.label=4;case 4:return[2]}}))}))},t}(),Pr=function(t){this.key=t},Lr=function(t){this.key=t},Mr=function(){function t(t,e){this.query=t,this.bl=e,this.gl=null,this._i=!1,this.yl=Ht(),this.fi=Ht(),this._l=new Jt(t.Bn.bind(t))}return Object.defineProperty(t.prototype,"Il",{get:function(){return this.bl},enumerable:!0,configurable:!0}),t.prototype.Tl=function(t,e){var n=this,r=e?e.El:new Xt,i=e?e._l:this._l,o=e?e.fi:this.fi,s=i,a=!1,u=this.query.Kn()&&i.size===this.query.limit?i.last():null,c=this.query.Jn()&&i.size===this.query.limit?i.first():null;if(t.ct((function(t,e){var h=i.get(t),f=e instanceof wt?e:null;f&&(Te(t.isEqual(f.key),"Mismatching keys found in document changes: "+t+" != "+f.key),f=n.query.matches(f)?f:null);var l=!!h&&n.fi.has(h.key),p=!!f&&(f.nn||n.fi.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Dl(h,f)||(r.track({type:2,doc:f}),d=!0,(u&&n.query.Bn(f,u)>0||c&&n.query.Bn(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(u||c)&&(a=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),this.query.Kn()||this.query.Jn())for(;s.size>this.query.limit;){var h=this.query.Kn()?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return Te(!a||!e,"View was refilled using docs that themselves needed refilling."),{_l:s,El:r,ic:a,fi:o}},t.prototype.Dl=function(t,e){return t.nn&&e.hasCommittedMutations&&!e.nn},t.prototype.Is=function(t,e,n){var r=this;Te(!t.ic,"Cannot apply changes that need a refill");var i=this._l;this._l=t._l,this.fi=t.fi;var o=t.El.ci();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie("Unknown ChangeType: "+t)}};return n(t)-n(e)}
/**
     * @license
     * Copyright 2019 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t.type,e.type)||r.query.Bn(t.doc,e.doc)})),this.Rl(n);var s=e?this.Sl():[],a=0===this.yl.size&&this._i?1:0,u=a!==this.gl;return this.gl=a,0!==o.length||u?{snapshot:new Zt(this.query,t._l,i,o,t.fi,0===a,u,!1),Al:s}:{Al:s}},t.prototype.Cl=function(t){return this._i&&"Offline"===t?(this._i=!1,this.Is({_l:this._l,El:new Xt,fi:this.fi,ic:!1},!1)):{Al:[]}},t.prototype.Pl=function(t){return!this.bl.has(t)&&!!this._l.has(t)&&!this._l.get(t).nn},t.prototype.Rl=function(t){var e=this;t&&(t.Ii.forEach((function(t){return e.bl=e.bl.add(t)})),t.Ti.forEach((function(t){return Te(e.bl.has(t),"Modified document "+t+" not found in view.")})),t.Ei.forEach((function(t){return e.bl=e.bl.delete(t)})),this._i=t._i)},t.prototype.Sl=function(){var t=this;if(!this._i)return[];var e=this.yl;this.yl=Ht(),this._l.forEach((function(e){t.Pl(e.key)&&(t.yl=t.yl.add(e.key))}));var n=[];return e.forEach((function(e){t.yl.has(e)||n.push(new Lr(e))})),this.yl.forEach((function(t){e.has(t)||n.push(new Pr(t))})),n},t.prototype.Vl=function(t){this.bl=t.ko,this.yl=Ht();var e=this.Tl(t.documents);return this.Is(e,!0)},t.prototype.kl=function(){return Zt.vi(this.query,this._l,this.fi,0===this.gl)},t}(),Ur=function(){function t(t,e,n,r){this.Or=t,this.Nl=e,this.updateFunction=n,this.xr=r,this.Ol=5,this.ca=new Cn(this.Or,"retry_transaction")}return t.prototype.run=function(){this.Fl()},t.prototype.Fl=function(){var t=this;this.ca.ea((function(){return Fe.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return Fe.__generator(this,(function(r){return t=this.Nl.wl(),(e=this.Ul(t))&&e.then((function(e){n.Or.Qr((function(){return t.commit().then((function(){n.xr.resolve(e)})).catch((function(t){n.jl(t)}))}))})).catch((function(t){n.jl(t)})),[2]}))}))}))},t.prototype.Ul=function(t){try{var e=this.updateFunction(t);return!D(e)&&e.catch&&e.then?e:(this.xr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.xr.reject(t),null}},t.prototype.jl=function(t){var e=this;this.Ol>0&&this.xl(t)?(this.Ol-=1,this.Or.Qr((function(){return e.Fl(),Promise.resolve()}))):this.xr.reject(t)},t.prototype.xl=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!jt(e)}return!1},t}(),jr=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Br=function(t){this.key=t,this.Ll=!1},Fr=function(){function t(t,e,n,r,i){this.kf=t,this.Nl=e,this.Ml=n,this.currentUser=r,this.ql=i,this.Bl=null,this.Ql=new Ce((function(t){return t.canonicalId()})),this.Gl=new Map,this.Wl=[],this.zl=new b(w.F),this.Kl=new Map,this.Jl=new Qe,this.Hl={},this.Yl=new Map,this.Xl=An.Tc(),this.isPrimary=void 0,this.onlineState="Unknown"}return Object.defineProperty(t.prototype,"$l",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t){Te(null!==t,"SyncEngine listener cannot be null"),Te(null===this.Bl,"SyncEngine already has a subscriber."),this.Bl=t},t.prototype.listen=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o;return Fe.__generator(this,(function(s){switch(s.label){case 0:return this.Zl("listen()"),(r=this.Ql.get(t))?(e=r.targetId,this.Ml.ph(e),n=r.view.kl(),[3,4]):[3,1];case 1:return[4,this.kf.Eo(t.qn())];case 2:return i=s.sent(),o=this.Ml.ph(i.targetId),e=i.targetId,[4,this.td(t,e,"current"===o)];case 3:n=s.sent(),this.isPrimary&&this.Nl.listen(i),s.label=4;case 4:return this.Bl.Ra([n]),[2,e]}}))}))},t.prototype.td=function(t,e,n){return Fe.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,a,u;return Fe.__generator(this,(function(c){switch(c.label){case 0:return[4,this.kf.Co(t,!0)];case 1:return r=c.sent(),i=new Mr(t,r.ko),o=i.Tl(r.documents),s=ee.yi(e,n&&"Offline"!==this.onlineState),Te(0===(a=i.Is(o,!0===this.isPrimary,s)).Al.length,"View returned limbo docs before target ack from the server."),Te(!!a.snapshot,"applyChanges for new view should always return a snapshot"),u=new jr(t,e,i),this.Ql.set(t,u),this.Gl.has(e)?this.Gl.get(e).push(t):this.Gl.set(e,[t]),[2,a.snapshot]}}))}))},t.prototype.nd=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n;return Fe.__generator(this,(function(r){switch(r.label){case 0:return[4,this.kf.Co(t.query,!0)];case 1:return e=r.sent(),n=t.view.Vl(e),this.isPrimary&&this.ed(t.targetId,n.Al),[2,n]}}))}))},t.prototype.nl=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return Fe.__generator(this,(function(i){switch(i.label){case 0:return this.Zl("unlisten()"),Te(!!(e=this.Ql.get(t)),"Trying to unlisten on query not found:"+t),(n=this.Gl.get(e.targetId)).length>1?(this.Gl.set(e.targetId,n.filter((function(e){return!e.isEqual(t)}))),this.Ql.delete(t),[2]):this.isPrimary?(this.Ml.gh(e.targetId),this.Ml.lh(e.targetId)?[3,2]:[4,this.kf.Ao(e.targetId,!1).then((function(){r.Ml._h(e.targetId),r.Nl.nl(e.targetId),r.rd(e.targetId)})).catch(en)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.rd(e.targetId),[4,this.kf.Ao(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return Fe.__awaiter(this,void 0,void 0,(function(){var n;return Fe.__generator(this,(function(r){switch(r.label){case 0:return this.Zl("write()"),[4,this.kf.zs(t)];case 1:return n=r.sent(),this.Ml.dh(n.batchId),this.ud(n.batchId,e),[4,this.sd(n.ds)];case 2:return r.sent(),[4,this.Nl.Xf()];case 3:return r.sent(),[2]}}))}))},t.prototype.runTransaction=function(t,e,n){new Ur(t,this.Nl,e,n).run()},t.prototype.ho=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n=this;return Fe.__generator(this,(function(r){switch(r.label){case 0:this.Zl("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.kf.ho(t)];case 2:return e=r.sent(),t.wi.forEach((function(t,e){var r=n.Kl.get(e);r&&(Te(t.Ii.size+t.Ti.size+t.Ei.size<=1,"Limbo resolution for single document contains multiple changes."),t.Ii.size>0?r.Ll=!0:t.Ti.size>0?Te(r.Ll,"Received change for limbo target document without add."):t.Ei.size>0&&(Te(r.Ll,"Received remove for limbo target document without add."),r.Ll=!1))})),[4,this.sd(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,en(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.Cl=function(t,e){if(this.isPrimary&&0===e||!this.isPrimary&&1===e){this.Zl("applyOnlineStateChange()");var n=[];this.Ql.forEach((function(e,r){var i=r.view.Cl(t);Te(0===i.Al.length,"OnlineState should not affect limbo documents."),i.snapshot&&n.push(i.snapshot)})),this.Bl.od(t),this.Bl.Ra(n),this.onlineState=t,this.isPrimary&&this.Ml.Eh(t)}},t.prototype.ul=function(t,e){return Fe.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,s,a=this;return Fe.__generator(this,(function(u){switch(u.label){case 0:return this.Zl("rejectListens()"),this.Ml.Ih(t,"rejected",e),n=this.Kl.get(t),(r=n&&n.key)?(this.zl=this.zl.remove(r),this.Kl.delete(t),this.hd(),i=(i=new b(w.F)).ut(r,new bt(r,d.V())),o=Ht().add(r),s=new te(d.MIN,new Map,new T(Ne),i,o),[2,this.ho(s)]):[3,1];case 1:return[4,this.kf.Ao(t,!1).then((function(){return a.rd(t,e)})).catch(en)];case 2:u.sent(),u.label=3;case 3:return[2]}}))}))},t.prototype.Nh=function(t,e,n){return Fe.__awaiter(this,void 0,void 0,(function(){var r;return Fe.__generator(this,(function(i){switch(i.label){case 0:return this.Zl("applyBatchState()"),[4,this.kf.Js(t)];case 1:return null===(r=i.sent())?(be("SyncEngine","Cannot apply mutation batch with id: "+t),[2]):"pending"!==e?[3,3]:[4,this.Nl.Xf()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===e||"rejected"===e?(this.ad(t,n||null),this.kf.Fo(t)):Ie("Unknown batchState: "+e),i.label=4;case 4:return[4,this.sd(r)];case 5:return i.sent(),[2]}}))}))},t.prototype.fl=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n;return Fe.__generator(this,(function(r){switch(r.label){case 0:this.Zl("applySuccessfulWrite()"),e=t.batch.batchId,this.ad(e,null),this.fd(e),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.kf.Ys(t)];case 2:return n=r.sent(),this.Ml.wh(e,"acknowledged"),[4,this.sd(n)];case 3:return r.sent(),[3,6];case 4:return[4,en(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.vl=function(t,e){return Fe.__awaiter(this,void 0,void 0,(function(){var n;return Fe.__generator(this,(function(r){switch(r.label){case 0:this.Zl("rejectFailedWrite()"),this.ad(t,e),this.fd(t),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.kf.no(t)];case 2:return n=r.sent(),this.Ml.wh(t,"rejected",e),[4,this.sd(n)];case 3:return r.sent(),[3,6];case 4:return[4,en(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.ld=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n;return Fe.__generator(this,(function(r){switch(r.label){case 0:return this.Nl.xf()||be("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.kf.ro()];case 1:return-1===(e=r.sent())?(t.resolve(),[2]):((n=this.Yl.get(e)||[]).push(t),this.Yl.set(e,n),[2])}}))}))},t.prototype.fd=function(t){(this.Yl.get(t)||[]).forEach((function(t){t.resolve()})),this.Yl.delete(t)},t.prototype.dd=function(t){this.Yl.forEach((function(e){e.forEach((function(e){e.reject(new s(o.CANCELLED,t))}))})),this.Yl.clear()},t.prototype.ud=function(t,e){var n=this.Hl[this.currentUser.i()];n||(n=new b(Ne)),n=n.ut(t,e),this.Hl[this.currentUser.i()]=n},t.prototype.ad=function(t,e){var n=this.Hl[this.currentUser.i()];if(n){var r=n.get(t);r&&(Te(t===n.ot(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.Hl[this.currentUser.i()]=n}},t.prototype.rd=function(t,e){var n=this;void 0===e&&(e=null),this.Ml.gh(t),Te(this.Gl.has(t)&&0!==this.Gl.get(t).length,"There are no queries mapped to target id "+t);for(var r=0,i=this.Gl.get(t);r<i.length;r++){var o=i[r];this.Ql.delete(o),e&&this.Bl.vd(o,e)}if(this.Gl.delete(t),this.isPrimary){var s=this.Jl.as(t);this.Jl.hs(t),s.forEach((function(t){n.Jl.fs(t)||n.wd(t)}))}},t.prototype.wd=function(t){var e=this.zl.get(t);null!==e&&(this.Nl.nl(e),this.zl=this.zl.remove(t),this.Kl.delete(e),this.hd())},t.prototype.ed=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Pr?(this.Jl.es(i.key,t),this.md(i)):i instanceof Lr?(be("SyncEngine","Document no longer in limbo: "+i.key),this.Jl.us(i.key,t),this.Jl.fs(i.key)||this.wd(i.key)):Ie("Unknown limbo change: "+JSON.stringify(i))}},t.prototype.md=function(t){var e=t.key;this.zl.get(e)||(be("SyncEngine","New document in limbo: "+e),this.Wl.push(e),this.hd())},t.prototype.hd=function(){for(;this.Wl.length>0&&this.zl.size<this.ql;){var t=this.Wl.shift(),e=this.Xl.next();this.Kl.set(e,new Br(t)),this.zl=this.zl.ut(t,e),this.Nl.listen(new Mt(It.Cn(t.path).qn(),e,2,Le.Nr))}},t.prototype.pd=function(){return this.zl},t.prototype.bd=function(){return this.Wl},t.prototype.sd=function(t,e){return Fe.__awaiter(this,void 0,void 0,(function(){var n,r,i,o=this;return Fe.__generator(this,(function(s){switch(s.label){case 0:return n=[],r=[],i=[],this.Ql.forEach((function(s,a){i.push(Promise.resolve().then((function(){var e=a.view.Tl(t);return e.ic?o.kf.Co(a.query,!1).then((function(t){var n=t.documents;return a.view.Tl(n,e)})):e})).then((function(t){var i=e&&e.wi.get(a.targetId),s=a.view.Is(t,!0===o.isPrimary,i);if(o.ed(a.targetId,s.Al),s.snapshot){o.isPrimary&&o.Ml.Ih(a.targetId,s.snapshot.fromCache?"not-current":"current"),n.push(s.snapshot);var u=Pe.Ar(a.targetId,s.snapshot);r.push(u)}})))})),[4,Promise.all(i)];case 1:return s.sent(),this.Bl.Ra(n),[4,this.kf.bo(r)];case 2:return s.sent(),[2]}}))}))},t.prototype.Zl=function(t){Te(null!==this.Bl,"Trying to call "+t+" before calling subscribe().")},t.prototype.ml=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n;return Fe.__generator(this,(function(r){switch(r.label){case 0:return e=!this.currentUser.isEqual(t),this.currentUser=t,e?(this.dd("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.kf.Ms(t)]):[3,3];case 1:return n=r.sent(),this.Ml.Ms(t,n.Gs,n.Ws),[4,this.sd(n.Qs)];case 2:r.sent(),r.label=3;case 3:return[4,this.Nl.ml()];case 4:return r.sent(),[2]}}))}))},t.prototype.pl=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,a=this;return Fe.__generator(this,(function(u){switch(u.label){case 0:return!0!==t||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Nl.pl(!0)]);case 1:return u.sent(),o=this.Ml.fh(),[4,this.gd(o.K())];case 2:for(e=u.sent(),n=0,r=e;n<r.length;n++)i=r[n],this.Nl.listen(i);return[3,7];case 3:return!1!==t||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,o=[],s=Promise.resolve(),this.Gl.forEach((function(t,e){a.Ml.yh(e)?o.push(e):s=s.then((function(){return a.rd(e),a.kf.Ao(e,!0)})),a.Nl.nl(e)})),[4,s]);case 4:return u.sent(),[4,this.gd(o)];case 5:return u.sent(),this.yd(),[4,this.Nl.pl(!1)];case 6:u.sent(),u.label=7;case 7:return[2]}}))}))},t.prototype.yd=function(){var t=this;this.Kl.forEach((function(e,n){t.Nl.nl(n)})),this.Jl.cs(),this.Kl=new Map,this.zl=new b(w.F)},t.prototype.gd=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n,r,i,o,s,a,u,c,h,f,l,p;return Fe.__generator(this,(function(d){switch(d.label){case 0:e=[],n=[],r=0,i=t,d.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(a=this.Gl.get(o))&&0!==a.length?[4,this.kf.Ao(o,!0)]:[3,8]):[3,14];case 2:return d.sent(),[4,this.kf.Eo(a[0].qn())];case 3:s=d.sent(),u=0,c=a,d.label=4;case 4:return u<c.length?(h=c[u],Te(!!(f=this.Ql.get(h)),"No query view found for "+h),[4,this.nd(f)]):[3,7];case 5:(l=d.sent()).snapshot&&n.push(l.snapshot),d.label=6;case 6:return u++,[3,4];case 7:return[3,12];case 8:return Te(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.kf.xo(o)];case 9:return Te(!!(p=d.sent()),"Target for id "+o+" not found"),[4,this.kf.Eo(p)];case 10:return s=d.sent(),[4,this.td(this._d(p),o,!1)];case 11:d.sent(),d.label=12;case 12:e.push(s),d.label=13;case 13:return r++,[3,1];case 14:return this.Bl.Ra(n),[2,e]}}))}))},t.prototype._d=function(t){return new It(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},t.prototype.Oo=function(){return this.kf.Oo()},t.prototype.Oh=function(t,e,n){return Fe.__awaiter(this,void 0,void 0,(function(){var r,i;return Fe.__generator(this,(function(o){switch(o.label){case 0:if(this.isPrimary)return be("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.Gl.has(t))return[3,7];switch(e){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.kf.Lo()];case 2:return r=o.sent(),i=te.gi(t,"current"===e),[4,this.sd(r,i)];case 3:return o.sent(),[3,7];case 4:return[4,this.kf.Ao(t,!0)];case 5:return o.sent(),this.rd(t,n),[3,7];case 6:Ie("Unexpected target state: "+e),o.label=7;case 7:return[2]}}))}))},t.prototype.Fh=function(t,e){return Fe.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,s,a,u,c,h,f=this;return Fe.__generator(this,(function(l){switch(l.label){case 0:if(!this.isPrimary)return[2];n=0,r=t,l.label=1;case 1:return n<r.length?(h=r[n],Te(!this.Gl.has(h),"Trying to add an already active target"),[4,this.kf.xo(h)]):[3,6];case 2:return Te(!!(i=l.sent()),"Query data for active target "+h+" not found"),[4,this.kf.Eo(i)];case 3:return o=l.sent(),[4,this.td(this._d(i),o.targetId,!1)];case 4:l.sent(),this.Nl.listen(o),l.label=5;case 5:return n++,[3,1];case 6:s=function(t){return Fe.__generator(this,(function(e){switch(e.label){case 0:return a.Gl.has(t)?[4,a.kf.Ao(t,!1).then((function(){f.Nl.nl(t),f.rd(t)})).catch(en)]:[2,"continue"];case 1:return e.sent(),[2]}}))},a=this,u=0,c=e,l.label=7;case 7:return u<c.length?(h=c[u],[5,s(h)]):[3,10];case 8:l.sent(),l.label=9;case 9:return u++,[3,7];case 10:return[2]}}))}))},t.prototype.enableNetwork=function(){return this.kf.jo(!0),this.Nl.enableNetwork()},t.prototype.disableNetwork=function(){return this.kf.jo(!1),this.Nl.disableNetwork()},t.prototype.he=function(t){var e=this.Kl.get(t);if(e&&e.Ll)return Ht().add(e.key);var n=Ht(),r=this.Gl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],a=this.Ql.get(s);Te(!!a,"No query view found for "+s),n=n.Ft(a.view.Il)}return n},t}(),Vr=function(){this.Id=null,this.targetId=0,this.listeners=[]},qr=function(){function t(t){this.Jo=t,this.Td=new Ce((function(t){return t.canonicalId()})),this.onlineState="Unknown",this.Ed=new Set,this.Jo.subscribe(this)}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.Td.get(e);return r||(n=!0,r=new Vr,this.Td.set(e,r)),r.listeners.push(t),Te(!t.Cl(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.Id&&t.Dd(r.Id)&&this.Rd(),n?this.Jo.listen(e).then((function(t){return r.targetId=t,t})):Promise.resolve(r.targetId)},t.prototype.nl=function(t){return Fe.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return Fe.__generator(this,(function(o){return e=t.query,n=!1,(r=this.Td.get(e))&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.Td.delete(e),[2,this.Jo.nl(e)]):[2]}))}))},t.prototype.Ra=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Td.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].Dd(i)&&(e=!0);s.Id=i}}e&&this.Rd()},t.prototype.vd=function(t,e){var n=this.Td.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.Td.delete(t)},t.prototype.od=function(t){this.onlineState=t;var e=!1;this.Td.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].Cl(t)&&(e=!0)})),e&&this.Rd()},t.prototype.Sd=function(t){this.Ed.add(t),t.next()},t.prototype.Ad=function(t){this.Ed.delete(t)},t.prototype.Rd=function(){this.Ed.forEach((function(t){t.next()}))},t}(),zr=function(){function t(t,e,n){this.query=t,this.Cd=e,this.Pd=!1,this.Vd=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Dd=function(t){if(Te(t.docChanges.length>0||t.li,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Zt(t.query,t.docs,t.ai,e,t.fi,t.fromCache,t.li,!0)}var o=!1;return this.Pd?this.kd(t)&&(this.Cd.next(t),o=!0):this.Nd(t,this.onlineState)&&(this.Od(t),o=!0),this.Vd=t,o},t.prototype.onError=function(t){this.Cd.error(t)},t.prototype.Cl=function(t){this.onlineState=t;var e=!1;return this.Vd&&!this.Pd&&this.Nd(this.Vd,t)&&(this.Od(this.Vd),e=!0),e},t.prototype.Nd=function(t,e){if(Te(!this.Pd,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n="Offline"!==e;return this.options.Fd&&n?(Te(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.M()||"Offline"===e},t.prototype.kd=function(t){if(t.docChanges.length>0)return!0;var e=this.Vd&&this.Vd.hasPendingWrites!==t.hasPendingWrites;return!(!t.li&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Od=function(t){Te(!this.Pd,"Trying to raise initial events for second time"),t=Zt.vi(t.query,t.docs,t.fi,t.fromCache),this.Pd=!0,this.Cd.next(t)},t}(),Gr=function(){function t(t,e,n,r){this.platform=t,this.Ud=e,this.credentials=n,this.Or=r,this.clientId=Ae.pr()}return t.prototype.start=function(t,e){var n=this;this.jd();var r=new Me,i=new Me,o=!1;return this.credentials.v((function(s){o?n.Or.Qr((function(){return n.ml(s)})):(o=!0,n.xd(t,e,s,i).then((function(){return n.Ld(s)})).then(r.resolve,r.reject))})),this.Or.Qr((function(){return r.promise})),i.promise},t.prototype.enableNetwork=function(){var t=this;return this.jd(),this.Or.enqueue((function(){return t.Jo.enableNetwork()}))},t.prototype.xd=function(t,e,n,r){return Fe.__awaiter(this,void 0,void 0,(function(){var i;return Fe.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.initialize(this.Or,this.Ud,this.platform,this.clientId,n,e)];case 1:return o.sent(),this.persistence=t.Jc(),this.Md=t.Kc(),this.Ml=t.Hc(),r.resolve(),[3,3];case 2:if(i=o.sent(),r.reject(i),!this.qd(i))throw i;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+i),[2,this.xd(new xn,{zc:!1},n,r)];case 3:return[2]}}))}))},t.prototype.qd=function(t){return"FirebaseError"===t.name?t.code===o.FAILED_PRECONDITION||t.code===o.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.jd=function(){if(this.Or.Yr)throw new s(o.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Ld=function(t){var e=this;return be("FirestoreClient","Initializing. user=",t.uid),this.platform.Bd(this.Ud).then((function(n){return Fe.__awaiter(e,void 0,void 0,(function(){var e,r,i,o,s,a,u=this;return Fe.__generator(this,(function(c){switch(c.label){case 0:return e=new yn,this.kf=new tn(this.persistence,e,t),[4,this.kf.start()];case 1:return c.sent(),r=this.platform.Qd(),i=this.platform.Gd(this.Ud.ae),o=new Un(this.Or,n,this.credentials,i),s=function(t){return u.Jo.Cl(t,0)},a=function(t){return u.Jo.Cl(t,1)},this.Nl=new Cr(this.kf,o,this.Or,s,r),this.Jo=new Fr(this.kf,this.Nl,this.Ml,t,100),this.Ml.Ho=a,this.Nl.Jo=this.Jo,this.Ml.Jo=this.Jo,this.Wd=new qr(this.Jo),[4,this.Ml.start()];case 2:return c.sent(),[4,this.Nl.start()];case 3:return c.sent(),[4,this.persistence.jc((function(t){return Fe.__awaiter(u,void 0,void 0,(function(){return Fe.__generator(this,(function(e){switch(e.label){case 0:return[4,this.Jo.pl(t)];case 1:return e.sent(),t&&!this.Md.qu?this.Md.start(this.kf):t||this.Md.stop(),[2]}}))}))}))];case 4:return c.sent(),[4,this.persistence.xc((function(){return Fe.__awaiter(u,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))}))];case 5:return c.sent(),[2]}}))}))}))},t.prototype.ml=function(t){return this.Or.ru(),be("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Jo.ml(t)},t.prototype.disableNetwork=function(){var t=this;return this.jd(),this.Or.enqueue((function(){return t.Jo.disableNetwork()}))},t.prototype.terminate=function(){var t=this;return this.Or.nu((function(){return Fe.__awaiter(t,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return this.Md.stop(),[4,this.Nl.shutdown()];case 1:return t.sent(),[4,this.Ml.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.m(),[2]}}))}))}))},t.prototype.waitForPendingWrites=function(){var t=this;this.jd();var e=new Me;return this.Or.Qr((function(){return t.Jo.ld(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.jd();var i=new zr(t,e,n);return this.Or.Qr((function(){return r.Wd.listen(i)})),i},t.prototype.nl=function(t){var e=this;this.zd||this.Or.Qr((function(){return e.Wd.nl(t)}))},t.prototype.Kd=function(t){var e=this;return this.jd(),this.Or.enqueue((function(){return e.kf.Io(t)})).then((function(t){if(t instanceof wt)return t;if(t instanceof bt)return null;throw new s(o.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")}))},t.prototype.Jd=function(t){var e=this;return this.jd(),this.Or.enqueue((function(){return Fe.__awaiter(e,void 0,void 0,(function(){var e,n,r;return Fe.__generator(this,(function(i){switch(i.label){case 0:return[4,this.kf.Co(t,!0)];case 1:return e=i.sent(),n=new Mr(t,e.ko),r=n.Tl(e.documents),[2,n.Is(r,!1).snapshot]}}))}))}))},t.prototype.write=function(t){var e=this;this.jd();var n=new Me;return this.Or.Qr((function(){return e.Jo.write(t,n)})),n.promise},t.prototype.ae=function(){return this.Ud.ae},t.prototype.Sd=function(t){var e=this;this.jd(),this.Or.Qr((function(){return e.Wd.Sd(t),Promise.resolve()}))},t.prototype.Ad=function(t){this.zd||this.Wd.Ad(t)},Object.defineProperty(t.prototype,"zd",{get:function(){return this.Or.Yr},enumerable:!0,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.jd();var n=new Me;return this.Or.Qr((function(){return e.Jo.runTransaction(e.Or,t,n),Promise.resolve()})),n.promise},t}(),$r=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.Hd(this.observer.next,t)},t.prototype.error=function(t){this.Hd(this.observer.error,t)},t.prototype.Yd=function(){this.muted=!0},t.prototype.Hd=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();
/**
     * @license
     * Copyright 2018 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Wr(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}
/**
     * @license
     * Copyright 2020 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */(t)}var Yr=function(){function t(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.Xd=n,this.converter=r}return t.prototype.$d=function(t){switch(M(t)){case 0:return null;case 1:return t.booleanValue;case 2:return z(t.integerValue||t.doubleValue);case 3:return this.Zd(t.timestampValue);case 4:return this.tv(t);case 5:return t.stringValue;case 6:return new ar(G(t.bytesValue));case 7:return this.nv(t.referenceValue);case 8:return new mr(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.iv(t.arrayValue);case 10:return this.ev(t.mapValue);default:throw Ie("Invalid value type: "+JSON.stringify(t))}},t.prototype.ev=function(t){var e=this,n={};return S(t.fields||{},(function(t,r){n[t]=e.$d(r)})),n},t.prototype.iv=function(t){var e=this;return(t.values||[]).map((function(t){return e.$d(t)}))},t.prototype.tv=function(t){switch(this.Xd){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return C(n)?t(n):n}(t);return null==e?null:this.$d(e);case"estimate":return this.Zd(P(t));default:return null}},t.prototype.Zd=function(t){var e=q(t),n=new p(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.nv=function(t){var e=y.H(t);Te(ve(e),"ReferenceValue is not valid "+t);var n=new De(e.get(1),e.get(3)),r=new w(e.j(5));return n.isEqual(this.firestore.rv)||Ee("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.rv.projectId+"/"+this.firestore.rv.database+") instead."),new Zr(r,this.firestore,this.converter)},t}(),Hr=We.Nu,Qr=function(){function t(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new s(o.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else $n("settings","non-empty string","host",t.host),this.host=t.host,Wn("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Zn("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Wn("settings","object","credentials",t.credentials),this.credentials=t.credentials,Wn("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?Ee("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&Ee("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,Wn("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=We.Fu;else{if(t.cacheSizeBytes!==Hr&&t.cacheSizeBytes<We.Ou)throw new s(o.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+We.Ou);this.cacheSizeBytes=t.cacheSizeBytes}Wn("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},t}(),Kr=function(){function t(e,n,r){var i=this;if(void 0===r&&(r=new xn),this.uv=null,this.sv=new je,this.INTERNAL={delete:function(){return Fe.__awaiter(i,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return this.ov(),[4,this.hv.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var a=e;this.uv=a,this.rv=t.cv(a),this.av=a.name,this.fv=new c(n)}else{var h=e;if(!h.projectId)throw new s(o.INVALID_ARGUMENT,"Must provide projectId");this.rv=new De(h.projectId,h.database),this.av="[DEFAULT]",this.fv=new u}this.lv=r,this.dv=new Qr({}),this.vv=this.wv(this.rv)}return t.prototype.settings=function(t){if(Bn("Firestore.settings",arguments,1),zn("Firestore.settings","object",1,t),li(t,"persistence"))throw new s(o.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Qr(t);if(this.hv&&!this.dv.isEqual(e))throw new s(o.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.dv=e,void 0!==e.credentials&&(this.fv=l(e.credentials))},t.prototype.enableNetwork=function(){return this.ov(),this.hv.enableNetwork()},t.prototype.disableNetwork=function(){return this.ov(),this.hv.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.hv)throw new s(o.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&Ee("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.mv(this.lv,{zc:!0,cacheSizeBytes:this.dv.cacheSizeBytes,synchronizeTabs:r})},t.prototype.clearPersistence=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t,e=this;return Fe.__generator(this,(function(n){if(void 0!==this.hv&&!this.hv.zd)throw new s(o.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return t=new Me,this.sv.Xr((function(){return Fe.__awaiter(e,void 0,void 0,(function(){var e,n;return Fe.__generator(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this.pv(),[4,this.lv.clearPersistence(e)];case 1:return r.sent(),t.resolve(),[3,3];case 2:return n=r.sent(),t.reject(n),[3,3];case 3:return[2]}}))}))})),[2,t.promise]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"bv",{get:function(){return this.ov(),this.hv.zd},enumerable:!0,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.ov(),this.hv.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this.ov(),Wr(t))return this.gv(t);zn("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.gv(e)},t.prototype.gv=function(t){var e=this,n=new $r({next:function(){t.next&&t.next()},error:function(t){throw Ie("Uncaught Error in onSnapshotsInSync")}});return this.hv.Sd(n),function(){n.Yd(),e.hv.Ad(n)}},t.prototype.ov=function(){return this.hv||this.mv(new xn,{zc:!1}),this.hv},t.prototype.pv=function(){return new Re(this.rv,this.av,this.dv.host,this.dv.ssl,this.dv.forceLongPolling)},t.prototype.mv=function(t,e){Te(!!this.dv.host,"FirestoreSettings.host is not set"),Te(!this.hv,"configureClient() called multiple times");var n=this.pv();return this.hv=new Gr(ye.xt(),n,this.fv,this.sv),this.hv.start(t,e)},t.prototype.wv=function(t){var e=new de(t,{de:ye.xt().de});return new Ar(e,(function(e){if(e instanceof Zr){var n=t,r=e.firestore.rv;if(!r.isEqual(n))throw new s(o.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Tr(t,e.yv)}return e}))},t.cv=function(t){if(!li(t.options,"projectId"))throw new s(o.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e=t.options.projectId;if(!e||"string"!=typeof e)throw new s(o.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new De(e)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.uv)throw new s(o.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.uv},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){return Bn("Firestore.collection",arguments,1),zn("Firestore.collection","non-empty string",1,t),this.ov(),new oi(y.H(t),this)},t.prototype.doc=function(t){return Bn("Firestore.doc",arguments,1),zn("Firestore.doc","non-empty string",1,t),this.ov(),Zr._v(y.H(t),this)},t.prototype.collectionGroup=function(t){if(Bn("Firestore.collectionGroup",arguments,1),zn("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new s(o.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ov(),new ri(new It(y.Y,t),this)},t.prototype.runTransaction=function(t){var e=this;return Bn("Firestore.runTransaction",arguments,1),zn("Firestore.runTransaction","function",1,t),this.ov().transaction((function(n){return t(new Jr(e,n))}))},t.prototype.batch=function(){return this.ov(),new Xr(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(me()){case Xe.LogLevel.DEBUG:return"debug";case Xe.LogLevel.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(Bn("Firestore.setLogLevel",arguments,1),zn("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":we(Xe.LogLevel.DEBUG);break;case"error":we(Xe.LogLevel.ERROR);break;case"silent":we(Xe.LogLevel.SILENT);break;default:throw new s(o.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype.Iv=function(){return this.dv.timestampsInSnapshots},t}(),Jr=function(){function t(t,e){this.Tv=t,this.Ev=e}return t.prototype.get=function(t){var e=this;Bn("Transaction.get",arguments,1);var n=ci("Transaction.get",t,this.Tv);return this.Ev.lookup([n.yv]).then((function(t){if(!t||1!==t.length)return Ie("Mismatch in docs returned from document lookup.");var r=t[0];if(r instanceof bt)return new ei(e.Tv,n.yv,null,!1,!1,n.Dv);if(r instanceof wt)return new ei(e.Tv,n.yv,r,!1,!1,n.Dv);throw Ie("BatchGetDocumentsRequest returned unexpected document type: "+r.constructor.name)}))},t.prototype.set=function(t,e,n){Vn("Transaction.set",arguments,2,3);var r=ci("Transaction.set",t,this.Tv);n=si("Transaction.set",n);var i=fi(r.Dv,e,"Transaction.set"),o=i[0],s=i[1],a=n.merge||n.mergeFields?this.Tv.vv.uf(s,o,n.mergeFields):this.Tv.vv.ef(s,o);return this.Ev.set(r.yv,a),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof cr?(Fn("Transaction.update",arguments,3),r=ci("Transaction.update",t,this.Tv),i=this.Tv.vv.af("Transaction.update",e,n,o)):(Bn("Transaction.update",arguments,2),r=ci("Transaction.update",t,this.Tv),i=this.Tv.vv.sf("Transaction.update",e)),this.Ev.update(r.yv,i),this},t.prototype.delete=function(t){Bn("Transaction.delete",arguments,1);var e=ci("Transaction.delete",t,this.Tv);return this.Ev.delete(e.yv),this},t}(),Xr=function(){function t(t){this.Tv=t,this.Rv=[],this.Sv=!1}return t.prototype.set=function(t,e,n){Vn("WriteBatch.set",arguments,2,3),this.Av();var r=ci("WriteBatch.set",t,this.Tv);n=si("WriteBatch.set",n);var i=fi(r.Dv,e,"WriteBatch.set"),o=i[0],s=i[1],a=n.merge||n.mergeFields?this.Tv.vv.uf(s,o,n.mergeFields):this.Tv.vv.ef(s,o);return this.Rv=this.Rv.concat(a.Ka(r.yv,ct.NONE)),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Av(),"string"==typeof e||e instanceof cr?(Fn("WriteBatch.update",arguments,3),r=ci("WriteBatch.update",t,this.Tv),i=this.Tv.vv.af("WriteBatch.update",e,n,o)):(Bn("WriteBatch.update",arguments,2),r=ci("WriteBatch.update",t,this.Tv),i=this.Tv.vv.sf("WriteBatch.update",e)),this.Rv=this.Rv.concat(i.Ka(r.yv,ct.exists(!0))),this},t.prototype.delete=function(t){Bn("WriteBatch.delete",arguments,1),this.Av();var e=ci("WriteBatch.delete",t,this.Tv);return this.Rv=this.Rv.concat(new dt(e.yv,ct.NONE)),this},t.prototype.commit=function(){return this.Av(),this.Sv=!0,this.Rv.length>0?this.Tv.ov().write(this.Rv):Promise.resolve()},t.prototype.Av=function(){if(this.Sv)throw new s(o.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Zr=function(){function t(t,e,n){this.yv=t,this.firestore=e,this.Dv=n,this.hv=this.firestore.ov()}return t._v=function(e,n,r){if(e.length%2!=0)throw new s(o.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.J()+" has "+e.length);return new t(new w(e),n,r)},Object.defineProperty(t.prototype,"id",{get:function(){return this.yv.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new oi(this.yv.path.L(),this.firestore,this.Dv)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.yv.path.J()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(Bn("DocumentReference.collection",arguments,1),zn("DocumentReference.collection","non-empty string",1,t),!t)throw new s(o.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=y.H(t);return new oi(this.yv.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw tr("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this.yv.isEqual(e.yv)&&this.Dv===e.Dv},t.prototype.set=function(t,e){Vn("DocumentReference.set",arguments,1,2),e=si("DocumentReference.set",e);var n=fi(this.Dv,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.vv.uf(i,r,e.mergeFields):this.firestore.vv.ef(i,r);return this.hv.write(o.Ka(this.yv,ct.NONE))},t.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof cr?(Fn("DocumentReference.update",arguments,2),n=this.firestore.vv.af("DocumentReference.update",t,e,r)):(Bn("DocumentReference.update",arguments,1),n=this.firestore.vv.sf("DocumentReference.update",t)),this.hv.write(n.Ka(this.yv,ct.exists(!0)))},t.prototype.delete=function(){return Bn("DocumentReference.delete",arguments,0),this.hv.write([new dt(this.yv,ct.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Vn("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||Wr(t[i])||(Zn("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Wn("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return Wr(t[i])?n=t[i]:(zn("DocumentReference.onSnapshot","function",i,t[i]),Gn("DocumentReference.onSnapshot","function",i+1,t[i+1]),Gn("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.Cv(o,n)},t.prototype.Cv=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new $r({next:function(t){if(e.next){Te(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n.yv);e.next(new ei(n.firestore,n.yv,r,t.fromCache,t.hasPendingWrites,n.Dv))}},error:r}),o=this.hv.listen(It.Cn(this.yv.path),i,t);return function(){i.Yd(),n.hv.nl(o)}},t.prototype.get=function(t){var e=this;return Vn("DocumentReference.get",arguments,0,1),ui("DocumentReference.get",t),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ov().Kd(e.yv).then((function(t){n(new ei(e.firestore,e.yv,t,!0,t instanceof wt&&t.nn,e.Dv))}),r):e.Pv(n,r,t)}))},t.prototype.Pv=function(t,e,n){var r=this.Cv({includeMetadataChanges:!0,Fd:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new s(o.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new s(o.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t.prototype.withConverter=function(e){return new t(this.yv,this.firestore,e)},t}(),ti=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),ei=function(){function t(t,e,n,r,i,o){this.Tv=t,this.yv=e,this.Vv=n,this.kv=r,this.Nv=i,this.Dv=o}return t.prototype.data=function(t){if(Vn("DocumentSnapshot.data",arguments,0,1),t=ai("DocumentSnapshot.data",t),this.Vv){if(this.Dv){var e=new ni(this.Tv,this.yv,this.Vv,this.kv,this.Nv);return this.Dv.fromFirestore(e,t)}var n=new Yr(this.Tv,this.Tv.Iv(),t.serverTimestamps,void 0);return n.$d(this.Vv.yn())}},t.prototype.get=function(t,e){if(Vn("DocumentSnapshot.get",arguments,1,2),e=ai("DocumentSnapshot.get",e),this.Vv){var n=this.Vv.data().field(kr("DocumentSnapshot.get",t));if(null!==n){var r=new Yr(this.Tv,this.Tv.Iv(),e.serverTimestamps,this.Dv);return r.$d(n)}}},Object.defineProperty(t.prototype,"id",{get:function(){return this.yv.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Zr(this.yv,this.Tv,this.Dv)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Vv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new ti(this.Nv,this.kv)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw tr("isEqual","DocumentSnapshot",1,e);return this.Tv===e.Tv&&this.kv===e.kv&&this.yv.isEqual(e.yv)&&(null===this.Vv?null===e.Vv:this.Vv.isEqual(e.Vv))&&this.Dv===e.Dv},t}(),ni=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Fe.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return Te(void 0!==n,"Document in a QueryDocumentSnapshot should exist"),n},e}(ei),ri=function(){function t(t,e,n){this.Ov=t,this.firestore=e,this.Dv=n}return t.prototype.where=function(e,n,r){Bn("Query.where",arguments,3),Xn("Query.where",3,r);var i,a=["<","<=","==",">=",">","array-contains","in","array-contains-any"];Hn("Query.where",a,2,n);var u=kr("Query.where",e),c=Tt.H(n);if(u.$()){if(c===Tt.ARRAY_CONTAINS||c===Tt.ARRAY_CONTAINS_ANY)throw new s(o.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+c.toString()+"' queries on FieldPath.documentId().");if(c===Tt.IN){this.Fv(r,c);for(var h=[],f=0,l=r;f<l.length;f++){var p=l[f];h.push(this.Uv(p))}i={arrayValue:{values:h}}}else i=this.Uv(r)}else c!==Tt.IN&&c!==Tt.ARRAY_CONTAINS_ANY||this.Fv(r,c),i=this.firestore.vv.ff("Query.where",r,c===Tt.IN);var d=At.create(u,c,i);return this.jv(d),new t(this.Ov.kn(d),this.firestore,this.Dv)},t.prototype.orderBy=function(e,n){var r;if(Vn("Query.orderBy",arguments,1,2),Gn("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r=Ot.ASCENDING;else{if("desc"!==n)throw new s(o.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Ot.DESCENDING}if(null!==this.Ov.startAt)throw new s(o.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.Ov.endAt)throw new s(o.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=kr("Query.orderBy",e),a=new Ct(i,r);return this.xv(a),new t(this.Ov.On(a),this.firestore,this.Dv)},t.prototype.limit=function(e){return Bn("Query.limit",arguments,1),zn("Query.limit","number",1,e),er("Query.limit",1,e),new t(this.Ov.Fn(e),this.firestore,this.Dv)},t.prototype.limitToLast=function(e){return Bn("Query.limitToLast",arguments,1),zn("Query.limitToLast","number",1,e),er("Query.limitToLast",1,e),new t(this.Ov.Un(e),this.firestore,this.Dv)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Fn("Query.startAt",arguments,1);var i=this.Lv("Query.startAt",e,n,!0);return new t(this.Ov.jn(i),this.firestore,this.Dv)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Fn("Query.startAfter",arguments,1);var i=this.Lv("Query.startAfter",e,n,!1);return new t(this.Ov.jn(i),this.firestore,this.Dv)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Fn("Query.endBefore",arguments,1);var i=this.Lv("Query.endBefore",e,n,!0);return new t(this.Ov.xn(i),this.firestore,this.Dv)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Fn("Query.endAt",arguments,1);var i=this.Lv("Query.endAt",e,n,!1);return new t(this.Ov.xn(i),this.firestore,this.Dv)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw tr("isEqual","Query",1,e);return this.firestore===e.firestore&&this.Ov.isEqual(e.Ov)},t.prototype.withConverter=function(e){return new t(this.Ov,this.firestore,e)},t.prototype.Lv=function(t,e,n,r){if(Xn(t,1,e),e instanceof ei){if(n.length>0)throw new s(o.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new s(o.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Mv(i.Vv,r)}var a=[e].concat(n);return this.qv(t,a,r)},t.prototype.Mv=function(t,e){for(var n=[],r=0,i=this.Ov.orderBy;r<i.length;r++){var a=i[r];if(a.field.$())n.push($(this.firestore.rv,t.key));else{var u=t.field(a.field);if(C(u))throw new s(o.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var c=a.field.J();throw new s(o.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}n.push(u)}}return new xt(n,e)},t.prototype.qv=function(t,e,n){var r=this.Ov.En;if(e.length>r.length)throw new s(o.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],a=0;a<e.length;a++){var u=e[a];if(r[a].field.$()){if("string"!=typeof u)throw new s(o.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof u);if(!this.Ov.Yn()&&-1!==u.indexOf("/"))throw new s(o.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+u+"' contains a slash.");var c=this.Ov.path.child(y.H(u));if(!w.nt(c))throw new s(o.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var h=new w(c);i.push($(this.firestore.rv,h))}else{var f=this.firestore.vv.ff(t,u);i.push(f)}}return new xt(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Vn("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||Wr(t[i])||(Zn("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Wn("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),Wr(t[i])?n=t[i]:(zn("Query.onSnapshot","function",i,t[i]),Gn("Query.onSnapshot","function",i+1,t[i+1]),Gn("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.Bv(this.Ov),this.Cv(r,n)},t.prototype.Cv=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new $r({next:function(t){e.next&&e.next(new ii(n.firestore,n.Ov,t,n.Dv))},error:r}),o=this.firestore.ov(),s=o.listen(this.Ov,i,t);return function(){i.Yd(),o.nl(s)}},t.prototype.Bv=function(t){if(t.Jn()&&0===t.En.length)throw new s(o.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},t.prototype.get=function(t){var e=this;return Vn("Query.get",arguments,0,1),ui("Query.get",t),this.Bv(this.Ov),new Promise((function(n,r){t&&"cache"===t.source?e.firestore.ov().Jd(e.Ov).then((function(t){n(new ii(e.firestore,e.Ov,t,e.Dv))}),r):e.Pv(n,r,t)}))},t.prototype.Pv=function(t,e,n){var r=this.Cv({includeMetadataChanges:!0,Fd:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new s(o.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.Uv=function(t){if("string"==typeof t){if(""===t)throw new s(o.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.Ov.Yn()&&-1!==t.indexOf("/"))throw new s(o.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.Ov.path.child(y.H(t));if(!w.nt(e))throw new s(o.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return $(this.firestore.rv,new w(e))}if(t instanceof Zr){var n=t;return $(this.firestore.rv,n.yv)}throw new s(o.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Jn(t)+".")},t.prototype.Fv=function(t,e){if(!Array.isArray(t)||0===t.length)throw new s(o.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new s(o.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new s(o.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new s(o.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},t.prototype.jv=function(t){if(t instanceof At){var e=[Tt.ARRAY_CONTAINS,Tt.ARRAY_CONTAINS_ANY],n=[Tt.IN,Tt.ARRAY_CONTAINS_ANY],r=e.indexOf(t.op)>=0,i=n.indexOf(t.op)>=0;if(t.Nn()){var a=this.Ov.Pn();if(null!==a&&!a.isEqual(t.field))throw new s(o.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+a.toString()+"' and '"+t.field.toString()+"'");var u=this.Ov.Vn();null!==u&&this.Qv(t.field,u)}else if(i||r){var c=null;if(i&&(c=this.Ov.Hn(n)),null===c&&r&&(c=this.Ov.Hn(e)),null!=c)throw c===t.op?new s(o.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new s(o.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+c.toString()+"' filters.")}}},t.prototype.xv=function(t){if(null===this.Ov.Vn()){var e=this.Ov.Pn();null!==e&&this.Qv(e,t.field)}},t.prototype.Qv=function(t,e){if(!e.isEqual(t))throw new s(o.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),ii=function(){function t(t,e,n,r){this.Tv=t,this.Gv=e,this.Wv=n,this.Dv=r,this.zv=null,this.Kv=null,this.metadata=new ti(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Wv.docs.M()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Wv.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;Vn("QuerySnapshot.forEach",arguments,1,2),zn("QuerySnapshot.forEach","function",1,t),this.Wv.docs.forEach((function(r){t.call(e,n.Jv(r))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new ri(this.Gv,this.Tv,this.Dv)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(t){t&&(Zn("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Wn("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Wv.di)throw new s(o.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.zv&&this.Kv===e||(this.zv=function(t,e,n,r){if(n.ai.M()){var i,o=0;return n.docChanges.map((function(e){var s=new ni(t,e.doc.key,e.doc,n.fromCache,n.fi.has(e.doc.key),r);return Te(0===e.type,"Invalid event type for first snapshot"),Te(!i||n.query.Bn(i,e.doc)<0,"Got added events in wrong order"),i=e.doc,{type:"added",doc:s,oldIndex:-1,newIndex:o++}}))}var s=n.ai;return n.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var i=new ni(t,e.doc.key,e.doc,n.fromCache,n.fi.has(e.doc.key),r),o=-1,a=-1;return 0!==e.type&&(Te((o=s.indexOf(e.doc.key))>=0,"Index for document not found"),s=s.delete(e.doc.key)),1!==e.type&&(a=(s=s.add(e.doc)).indexOf(e.doc.key)),{type:hi(e.type),doc:i,oldIndex:o,newIndex:a}}))}(this.Tv,e,this.Wv,this.Dv),this.Kv=e),this.zv},t.prototype.isEqual=function(e){if(!(e instanceof t))throw tr("isEqual","QuerySnapshot",1,e);return this.Tv===e.Tv&&this.Gv.isEqual(e.Gv)&&this.Wv.isEqual(e.Wv)&&this.Dv===e.Dv},t.prototype.Jv=function(t){return new ni(this.Tv,t.key,t,this.metadata.fromCache,this.Wv.fi.has(t.key),this.Dv)},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */Fe.__spreadArrays(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach((function(t){try{Object.defineProperty(ii.prototype.docChanges,t,{get:function(){return function(){throw new s(o.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}}));var oi=function(t){function e(e,n,r){var i=t.call(this,It.Cn(e),n,r)||this;if(i.Hv=e,e.length%2!=1)throw new s(o.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.J()+" has "+e.length);return i}return Fe.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.Ov.path.B()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.Ov.path.L();return t.M()?null:new Zr(new w(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.Ov.path.J()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(Vn("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ae.pr()),zn("CollectionReference.doc","non-empty string",1,t),""===t)throw new s(o.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=y.H(t);return Zr._v(this.Ov.path.child(e),this.firestore,this.Dv)},e.prototype.add=function(t){Bn("CollectionReference.add",arguments,1);var e=this.Dv?this.Dv.toFirestore(t):t;zn("CollectionReference.add","object",1,e);var n=this.doc();return n.set(t).then((function(){return n}))},e.prototype.withConverter=function(t){return new e(this.Hv,this.firestore,t)},e}(ri);function si(t,e){if(void 0===e)return{merge:!1};if(Zn(t,e,["merge","mergeFields"]),Wn(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new s(o.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Jn(r));for(var a=0;a<r.length;++a)if(!i(r[a]))throw new s(o.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+a+" was: "+Jn(r[a]))}(t,e,n,r,i)}(t,"mergeFields","a string or a FieldPath",e.mergeFields,(function(t){return"string"==typeof t||t instanceof cr})),void 0!==e.mergeFields&&void 0!==e.merge)throw new s(o.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function ai(t,e){return void 0===e?{}:(Zn(t,e,["serverTimestamps"]),Yn(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ui(t,e){Gn(t,"object",1,e),e&&(Zn(t,e,["source"]),Yn(t,0,"source",e.source,["default","server","cache"]))}function ci(t,e,n){if(e instanceof Zr){if(e.firestore!==n)throw new s(o.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw tr(t,"DocumentReference",1,e)}function hi(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie("Unknown change type: "+t)}}function fi(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function li(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var pi=ir(Kr,"Use firebase.firestore() instead."),di=ir(Jr,"Use firebase.firestore().runTransaction() instead."),vi=ir(Xr,"Use firebase.firestore().batch() instead."),yi=ir(Zr,"Use firebase.firestore().doc() instead."),gi=ir(ei),mi=ir(ni),wi=ir(ri),bi=ir(ii),Ei=ir(oi,"Use firebase.firestore().collection() instead."),_i=function(){function t(e){this.db=e,12.2===t.Yv(Ve.getUA())&&Ee("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.Xv=function(e,n,r){return Te(t.th(),"IndexedDB not supported in current environment."),be("SimpleDb","Opening database:",e),new Be((function(i,a){var u=window.indexedDB.open(e,n);u.onsuccess=function(e){var n=e.target.result;i(new t(n))},u.onblocked=function(){a(new s(o.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},u.onerror=function(t){var e=t.target.error;"VersionError"===e.name?a(new s(o.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a(e)},u.onupgradeneeded=function(t){be("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;r.createOrUpgrade(n,u.transaction,t.oldVersion,$i).next((function(){be("SimpleDb","Database upgrade to version "+$i+" complete")}))}})).wu()},t.delete=function(t){return be("SimpleDb","Removing database:",t),Ni(window.indexedDB.deleteDatabase(t)).wu()},t.th=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(t.$v())return!0;if(void 0===window.navigator)return!1;var e=Ve.getUA(),n=t.Yv(e),r=0<n&&n<10,i=t.Zv(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.$v=function(){var t;return void 0!==Dn&&"YES"===(null===(t=Dn.env)||void 0===t?void 0:t.tw)},t.nw=function(t,e){return t.store(e)},t.Yv=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Zv=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.iw=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){return Fe.__awaiter(this,void 0,void 0,(function(){var r,i,o,s,a;return Fe.__generator(this,(function(u){switch(u.label){case 0:r="readonly"===t,i=0,o=function(){var t,o,a,u;return Fe.__generator(this,(function(c){switch(c.label){case 0:++i,t=Ti.open(s.db,r?"readonly":"readwrite",e),c.label=1;case 1:return c.trys.push([1,3,,4]),(o=n(t).catch((function(e){return t.abort(e),Be.reject(e)})).wu()).catch((function(){})),[4,t.ew];case 2:return c.sent(),[2,{value:o}];case 3:return a=c.sent(),u="FirebaseError"!==a.name&&i<3,be("SimpleDb","Transaction failed with error: %s. Retrying: %s.",a.message,u),u?[3,4]:[2,{value:Promise.reject(a)}];case 4:return[2]}}))},s=this,u.label=1;case 1:return[5,o()];case 2:return"object"==typeof(a=u.sent())?[2,a.value]:[3,1];case 3:return[2]}}))}))},t.prototype.close=function(){this.db.close()},t}(),Ii=function(){function t(t){this.rw=t,this.uw=!1,this.sw=null}return Object.defineProperty(t.prototype,"fu",{get:function(){return this.uw},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ow",{get:function(){return this.sw},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.rw=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.uw=!0},t.prototype.hw=function(t){this.sw=t},t.prototype.delete=function(){return Ni(this.rw.delete())},t}(),Ti=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.cw=new Me,this.transaction.oncomplete=function(){e.cw.resolve()},this.transaction.onabort=function(){t.error?e.cw.reject(t.error):e.cw.resolve()},this.transaction.onerror=function(t){var n=ki(t.target.error);e.cw.reject(n)}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"ew",{get:function(){return this.cw.promise},enumerable:!0,configurable:!0}),t.prototype.abort=function(t){t&&this.cw.reject(t),this.aborted||(be("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return Te(!!e,"Object store not part of transaction: "+t),new Ai(e)},t}(),Ai=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(be("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(be("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ni(n)},t.prototype.add=function(t){return be("SimpleDb","ADD",this.store.name,t,t),Ni(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ni(this.store.get(t)).next((function(n){return void 0===n&&(n=null),be("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return be("SimpleDb","DELETE",this.store.name,t),Ni(this.store.delete(t))},t.prototype.count=function(){return be("SimpleDb","COUNT",this.store.name),Ni(this.store.count())},t.prototype.aw=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.fw(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.lw=function(t,e){be("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.dw=!1;var r=this.cursor(n);return this.fw(r,(function(t,e,n){return n.delete()}))},t.prototype.vw=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.fw(r,e)},t.prototype.ww=function(t){var e=this.cursor({});return new Be((function(n,r){e.onerror=function(t){var e=ki(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.fw=function(t,e){var n=[];return new Be((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Ii(i),s=e(i.primaryKey,i.value,o);if(s instanceof Be){var a=s.catch((function(t){return o.done(),Be.reject(t)}));n.push(a)}o.fu?r():null===o.ow?i.continue():i.continue(o.ow)}else r()}})).next((function(){return Be.pu(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(Te(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.dw?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ni(t){return new Be((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ki(t.target.error);n(e)}}))}var Si=!1;function ki(t){var e=_i.Yv(Ve.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new s("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Si||(Si=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Ri=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Bh=n,this.Cs=r,this.mw={}}return t.pw=function(e,n,r,i){return Te(""!==e.uid,"UserID must not be an empty string."),new t(e.t()?e.uid:"",n,r,i)},t.prototype.oc=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return xi(t).vw({index:Ki.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Ys=function(t,e,n){return this.bw(t).next((function(e){return e.lastStreamToken=n.toBase64(),Pi(t).put(e)}))},t.prototype.uo=function(t){return this.bw(t).next((function(t){return R.fromBase64String(t.lastStreamToken)}))},t.prototype.so=function(t,e){return this.bw(t).next((function(n){return n.lastStreamToken=e.toBase64(),Pi(t).put(n)}))},t.prototype.Ks=function(t,e,n,r){var i=this,o=Ci(t),s=xi(t);return s.add({}).next((function(a){Te("number"==typeof a,"Auto-generated key is not a number");for(var u=new Oe(a,e,n,r),c=i.serializer.gw(i.userId,u),h=[],f=new T((function(t,e){return Ne(t.J(),e.J())})),l=0,p=r;l<p.length;l++){var d=p[l],v=Ji.key(i.userId,d.key.path,a);f=f.add(d.key.path.L()),h.push(s.put(c)),h.push(o.put(v,Ji.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Bh.rc(t,e))})),t.Lh((function(){i.mw[a]=u.keys()})),Be.pu(h).next((function(){return u}))}))},t.prototype.io=function(t,e){var n=this;return xi(t).get(e).next((function(t){return t?(Te(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.yw(t)):null}))},t.prototype.Hs=function(t,e){var n=this;return this.mw[e]?Be.resolve(this.mw[e]):this.io(t,e).next((function(t){if(t){var r=t.keys();return n.mw[e]=r,r}return null}))},t.prototype._o=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return xi(t).vw({index:Ki.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Te(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.yw(e)),i.done()})).next((function(){return o}))},t.prototype.ro=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return xi(t).vw({index:Ki.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.qs=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return xi(t).aw(Ki.userMutationsIndex,n).next((function(t){return t.map((function(t){return e.serializer.yw(t)}))}))},t.prototype.Qh=function(t,e){var n=this,r=Ji.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Ci(t).vw({range:i},(function(r,i,s){var a=r[0],u=r[1],c=r[2],h=bn(u);if(a===n.userId&&e.path.isEqual(h))return xi(t).get(c).next((function(t){if(!t)throw Ie("Dangling document-mutation reference found: "+r+" which points to "+c);Te(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+c),o.push(n.serializer.yw(t))}));s.done()})).next((function(){return o}))},t.prototype.zh=function(t,e){var n=this,r=new T(Ne),i=[];return e.forEach((function(e){var o=Ji.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),a=Ci(t).vw({range:s},(function(t,i,o){var s=t[0],a=t[1],u=t[2],c=bn(a);s===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(a)})),Be.pu(i).next((function(){return n._w(t,r)}))},t.prototype.Xh=function(t,e){var n=this;Te(!e.Tn(),"Document queries shouldn't go down this path"),Te(!e.Yn(),"CollectionGroup queries should be handled in LocalDocumentsView");var r=e.path,i=r.length+1,o=Ji.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new T(Ne);return Ci(t).vw({range:s},(function(t,e,o){var s=t[0],u=t[1],c=t[2],h=bn(u);s===n.userId&&r.G(h)?h.length===i&&(a=a.add(c)):o.done()})).next((function(){return n._w(t,a)}))},t.prototype._w=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(xi(t).get(e).next((function(t){if(null===t)throw Ie("Dangling document-mutation reference found, which points to "+e);Te(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.yw(t))})))})),Be.pu(i).next((function(){return r}))},t.prototype.eo=function(t,e){var n=this;return Oi(t.Iw,this.userId,e).next((function(r){return t.Lh((function(){n.Uo(e.batchId)})),Be.forEach(r,(function(e){return n.Cs.lc(t,e)}))}))},t.prototype.Uo=function(t){delete this.mw[t]},t.prototype.to=function(t){var e=this;return this.oc(t).next((function(n){if(!n)return Be.resolve();var r=IDBKeyRange.lowerBound(Ji.prefixForUser(e.userId)),i=[];return Ci(t).vw({range:r},(function(t,n,r){if(t[0]===e.userId){var o=bn(t[1]);i.push(o)}else r.done()})).next((function(){Te(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map((function(t){return t.J()})))}))}))},t.prototype.fs=function(t,e){return Di(t,this.userId,e)},t.prototype.bw=function(t){var e=this;return Pi(t).get(this.userId).next((function(t){return t||new Qi(e.userId,-1,"")}))},t}();function Di(t,e,n){var r=Ji.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Ci(t).vw({range:o,dw:!0},(function(t,n,r){var o=t[0],a=t[1];t[2],o===e&&a===i&&(s=!0),r.done()})).next((function(){return s}))}function Oi(t,e,n){var r=t.store(Ki.store),i=t.store(Ji.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.vw({range:s},(function(t,e,n){return a++,n.delete()}));o.push(u.next((function(){Te(1===a,"Dangling document-mutation reference found: Missing batch "+n.batchId)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Ji.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Be.pu(o).next((function(){return c}))}function xi(t){return mo.nw(t,Ki.store)}function Ci(t){return mo.nw(t,Ji.store)}function Pi(t){return mo.nw(t,Qi.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Li=function(){function t(t,e){this.Cs=t,this.serializer=e,this.Sc=An.Ic()}return t.prototype.Ro=function(t){var e=this;return this.Tw(t).next((function(n){return n.highestTargetId=e.Sc.after(n.highestTargetId),e.Ew(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.oo=function(t){return this.Tw(t).next((function(t){return d.P(new p(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Ac=function(t){return ji(t.Iw)},t.prototype.wo=function(t,e,n){var r=this;return this.Tw(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.O()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ew(t,i)}))},t.prototype.So=function(t,e){var n=this;return this.Cc(t,e).next((function(){return n.Tw(t).next((function(r){return r.targetCount+=1,n.Dw(e,r),n.Ew(t,r)}))}))},t.prototype.do=function(t,e){return this.Cc(t,e)},t.prototype.Pc=function(t,e){var n=this;return this.Vc(t,e.targetId).next((function(){return Mi(t).delete(e.targetId)})).next((function(){return n.Tw(t)})).next((function(e){return Te(e.targetCount>0,"Removing from an empty target cache"),e.targetCount-=1,n.Ew(t,e)}))},t.prototype.Ju=function(t,e,n){var r=this,i=0,o=[];return Mi(t).vw((function(s,a){var u=r.serializer.Rw(a);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.Pc(t,u)))})).next((function(){return Be.pu(o)})).next((function(){return i}))},t.prototype.$i=function(t,e){var n=this;return Mi(t).vw((function(t,r){var i=n.serializer.Rw(r);e(i)}))},t.prototype.Tw=function(t){return Ui(t.Iw)},t.prototype.Ew=function(t,e){return(n=t,mo.nw(n,io.store)).put(io.key,e);var n},t.prototype.Cc=function(t,e){return Mi(t).put(this.serializer.Sw(e))},t.prototype.Dw=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.kc=function(t){return this.Tw(t).next((function(t){return t.targetCount}))},t.prototype.Do=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Mi(t).vw({range:i,index:no.queryTargetsIndexName},(function(t,r,i){var s=n.serializer.Rw(r);e.isEqual(s.target)&&(o=s,i.done())})).next((function(){return o}))},t.prototype.ao=function(t,e,n){var r=this,i=[],o=Bi(t);return e.forEach((function(e){var s=gn(e.path);i.push(o.put(new ro(n,s))),i.push(r.Cs.es(t,e))})),Be.pu(i)},t.prototype.co=function(t,e,n){var r=this,i=Bi(t);return Be.forEach(e,(function(e){var o=gn(e.path);return Be.pu([i.delete([n,o]),r.Cs.us(t,e)])}))},t.prototype.Vc=function(t,e){var n=Bi(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Po=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Bi(t),i=Ht();return r.vw({range:n,dw:!0},(function(t,e,n){var r=bn(t[1]),o=new w(r);i=i.add(o)})).next((function(){return i}))},t.prototype.fs=function(t,e){var n=gn(e.path),r=IDBKeyRange.bound([n],[ke(n)],!1,!0),i=0;return Bi(t).vw({index:ro.documentTargetsIndex,dw:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.ce=function(t,e){var n=this;return Mi(t).get(e).next((function(t){return t?n.serializer.Rw(t):null}))},t}();function Mi(t){return mo.nw(t,no.store)}function Ui(t){return _i.nw(t,io.store).get(io.key).next((function(t){return Te(null!==t,"Missing metadata row."),t}))}function ji(t){return Ui(t).next((function(t){return t.highestListenSequenceNumber}))}function Bi(t){return mo.nw(t,ro.store)}
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var Fi=function(){function t(t,e){this.serializer=t,this.Bh=e}return t.prototype.ms=function(t,e,n){return qi(t).put(zi(e),n)},t.prototype.bs=function(t,e){var n=qi(t),r=zi(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Aw(t,r)}))},t.prototype.gs=function(t,e){var n=this;return qi(t).get(zi(e)).next((function(t){return n.Cw(t)}))},t.prototype.Pw=function(t,e){var n=this;return qi(t).get(zi(e)).next((function(t){var e=n.Cw(t);return e?{vc:e,size:Gi(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=qt();return this.Vw(t,e,(function(t,e){var i=n.Cw(e);r=r.ut(t,i)})).next((function(){return r}))},t.prototype.kw=function(t,e){var n=this,r=qt(),i=new b(w.F);return this.Vw(t,e,(function(t,e){var o=n.Cw(e);o?(r=r.ut(t,o),i=i.ut(t,Gi(e))):(r=r.ut(t,null),i=i.ut(t,0))})).next((function(){return{Nw:r,Ow:i}}))},t.prototype.Vw=function(t,e,n){if(e.M())return Be.resolve();var r=IDBKeyRange.bound(e.first().path.K(),e.last().path.K()),i=e.ft(),o=i.bt();return qi(t).vw({range:r},(function(t,e,r){for(var s=w.rt(t);o&&w.F(o,s)<0;)n(o,null),o=i.bt();o&&o.isEqual(s)&&(n(o,e),o=i.gt()?i.bt():null),o?r.hw(o.path.K()):r.done()})).next((function(){for(;o;)n(o,null),o=i.gt()?i.bt():null}))},t.prototype.Vo=function(t,e,n){var r=this;Te(!e.Yn(),"CollectionGroup queries should be handled in LocalDocumentsView");var i=Gt(),o=e.path.length+1,s={};if(n.isEqual(d.MIN)){var a=e.path.K();s.range=IDBKeyRange.lowerBound(a)}else{var u=e.path.K(),c=this.serializer.Fw(n);s.range=IDBKeyRange.lowerBound([u,c],!0),s.index=to.collectionReadTimeIndex}return qi(t).vw(s,(function(t,n,s){if(t.length===o){var a=r.serializer.Uw(n);e.path.G(a.key.path)?a instanceof wt&&e.matches(a)&&(i=i.ut(a.key,a)):s.done()}})).next((function(){return i}))},t.prototype.Lo=function(t,e){var n=this,r=Vt(),i=this.serializer.Fw(e),o=qi(t),s=IDBKeyRange.lowerBound(i,!0);return o.vw({index:to.readTimeIndex,range:s},(function(t,e){var o=n.serializer.Uw(e);r=r.ut(o.key,o),i=e.readTime})).next((function(){return{Mo:r,readTime:n.serializer.jw(i)}}))},t.prototype.qo=function(t){var e=this,n=qi(t),r=d.MIN;return n.vw({index:to.readTimeIndex,reverse:!0},(function(t,n,i){n.readTime&&(r=e.serializer.jw(n.readTime)),i.done()})).next((function(){return r}))},t.prototype.Xs=function(e){return new t.mc(this,!!e&&e.$s)},t.prototype.pc=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Vi(t).get(eo.key).next((function(t){return Te(!!t,"Missing document cache metadata"),t}))},t.prototype.Aw=function(t,e){return Vi(t).put(eo.key,e)},t.prototype.Cw=function(t){if(t){var e=this.serializer.Uw(t);return e instanceof bt&&e.version.isEqual(d.V())?null:e}return null},t.mc=function(t){function e(e,n){var r=t.call(this)||this;return r.bc=e,r.$s=n,r.xw=new Ce((function(t){return t.toString()})),r}return Fe.__extends(e,t),e.prototype.Is=function(t){var e=this,n=[],r=0,i=new T((function(t,e){return Ne(t.J(),e.J())}));return this.ds.forEach((function(o,s){var a=e.xw.get(o);if(Te(void 0!==a,"Cannot modify a document that wasn't read (for "+o+")"),s){Te(!e.readTime.isEqual(d.MIN),"Cannot add a document with a read time of zero");var u=e.bc.serializer.Lw(s,e.readTime);i=i.add(o.path.L());var c=Gi(u);r+=c-a,n.push(e.bc.ms(t,o,u))}else if(r-=a,e.$s){var h=e.bc.serializer.Lw(new bt(o,d.V()),e.readTime);n.push(e.bc.ms(t,o,h))}else n.push(e.bc.bs(t,o))})),i.forEach((function(r){n.push(e.bc.Bh.rc(t,r))})),n.push(this.bc.updateMetadata(t,r)),Be.pu(n)},e.prototype.ys=function(t,e){var n=this;return this.bc.Pw(t,e).next((function(t){return null===t?(n.xw.set(e,0),null):(n.xw.set(e,t.size),t.vc)}))},e.prototype._s=function(t,e){var n=this;return this.bc.kw(t,e).next((function(t){var e=t.Nw;return t.Ow.forEach((function(t,e){n.xw.set(t,e)})),e}))},e}(Je),t}();function Vi(t){return mo.nw(t,eo.store)}function qi(t){return mo.nw(t,to.store)}function zi(t){return t.path.K()}function Gi(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ie("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var $i=10,Wi=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Te(n<r&&n>=0&&r<=$i,"Unexpected schema upgrade from v"+n+" to v"+r+".");var o=new Ti(e);n<1&&r>=1&&(function(t){t.createObjectStore(Hi.store)}(t),function(t){t.createObjectStore(Qi.store,{keyPath:Qi.keyPath}),t.createObjectStore(Ki.store,{keyPath:Ki.keyPath,autoIncrement:!0}).createIndex(Ki.userMutationsIndex,Ki.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ji.store)}(t),so(t),function(t){t.createObjectStore(to.store)}(t));var s=Be.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ro.store),t.deleteObjectStore(no.store),t.deleteObjectStore(io.store)}(t),so(t)),s=s.next((function(){return function(t){var e=t.store(io.store),n=new io(0,0,d.MIN.O(),0);return e.put(io.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Ki.store).aw().next((function(n){t.deleteObjectStore(Ki.store),t.createObjectStore(Ki.store,{keyPath:Ki.keyPath,autoIncrement:!0}).createIndex(Ki.userMutationsIndex,Ki.userMutationsKeyPath,{unique:!0});var r=e.store(Ki.store),i=n.map((function(t){return r.put(t)}));return Be.pu(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(ao.store,{keyPath:ao.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(eo.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(to.store);e.createIndex(to.readTimeIndex,to.readTimeIndexPath,{unique:!1}),e.createIndex(to.collectionReadTimeIndex,to.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(to.store).vw((function(t,n){e+=Gi(n)})).next((function(){var n=new eo(e);return t.store(eo.store).put(eo.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Qi.store),r=t.store(Ki.store);return n.aw().next((function(n){return Be.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.aw(Ki.userMutationsIndex,i).next((function(r){return Be.forEach(r,(function(r){Te(r.userId===n.userId,"Cannot process batch "+r.batchId+" from unexpected user");var i=e.serializer.yw(r);return Oi(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(ro.store),n=t.store(to.store);return ji(t).next((function(t){var r=[];return n.vw((function(n,i){var o=new y(n),s=function(t){return[0,gn(t)]}(o);r.push(e.get(s).next((function(n){return n?Be.resolve():function(n){return e.put(new ro(0,gn(n),t))}(o)})))})).next((function(){return Be.pu(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(oo.store,{keyPath:oo.keyPath});var n=e.store(oo.store),r=new _n,i=function(t){if(r.add(t)){var e=t.B(),i=t.L();return n.put({collectionId:e,parent:gn(i)})}};return e.store(to.store).vw({dw:!0},(function(t,e){var n=new y(t);return i(n.L())})).next((function(){return e.store(Ji.store).vw({dw:!0},(function(t,e){t[0];var n=t[1],r=(t[2],bn(n));return i(r.L())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(no.store);return n.vw((function(t,r){var i=e.serializer.Rw(r),o=e.serializer.Sw(i);return n.put(o)}))},t}(),Yi=function(t,e){this.seconds=t,this.nanoseconds=e},Hi=function(){function t(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}return t.store="owner",t.key="owner",t}(),Qi=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),Ki=function(){function t(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}return t.store="mutations",t.keyPath="batchId",t.userMutationsIndex="userMutationsIndex",t.userMutationsKeyPath=["userId","batchId"],t}(),Ji=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,gn(e)]},t.key=function(t,e,n){return[t,gn(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),Xi=function(t,e){this.path=t,this.readTime=e},Zi=function(t,e){this.path=t,this.version=e},to=function(){function t(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}return t.store="remoteDocuments",t.readTimeIndex="readTimeIndex",t.readTimeIndexPath="readTime",t.collectionReadTimeIndex="collectionReadTimeIndex",t.collectionReadTimeIndexPath=["parentPath","readTime"],t}(),eo=function(){function t(t){this.byteSize=t}return t.store="remoteDocumentGlobal",t.key="remoteDocumentGlobalKey",t}(),no=function(){function t(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),ro=function(){function t(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n,Te(0===t==(void 0!==n),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),io=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),oo=function(){function t(t,e){this.collectionId=t,this.parent=e}return t.store="collectionParents",t.keyPath=["collectionId","parent"],t}();function so(t){t.createObjectStore(ro.store,{keyPath:ro.keyPath}).createIndex(ro.documentTargetsIndex,ro.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(no.store,{keyPath:no.keyPath}).createIndex(no.queryTargetsIndexName,no.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(io.store)}var ao=function(){function t(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}return t.store="clientMetadata",t.keyPath="clientId",t}(),uo=[Qi.store,Ki.store,Ji.store,to.store,no.store,Hi.store,io.store,ro.store],co=Fe.__spreadArrays(uo,[ao.store]),ho=Fe.__spreadArrays(co,[eo.store]),fo=Fe.__spreadArrays(ho,[oo.store]),lo=function(){function t(){this.Mw=new _n}return t.prototype.rc=function(t,e){var n=this;if(Te(e.length%2==1,"Expected a collection path."),!this.Mw.has(e)){var r=e.B(),i=e.L();t.Lh((function(){n.Mw.add(e)}));var o={collectionId:r,parent:gn(i)};return po(t).put(o)}return Be.resolve()},t.prototype.Yh=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ke(e),""],!1,!0);return po(t).aw(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(bn(o.parent))}return n}))},t}();function po(t){return mo.nw(t,oo.store)}
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */var vo=function(){function t(t){this.qw=t}return t.prototype.Uw=function(t){if(t.document)return this.qw.Ae(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=w.rt(t.noDocument.path),n=this.Bw(t.noDocument.readTime);return new bt(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}return t.unknownDocument?(e=w.rt(t.unknownDocument.path),n=this.Bw(t.unknownDocument.version),new Et(e,n)):Ie("Unexpected DbRemoteDocument")},t.prototype.Lw=function(t,e){var n=this.Fw(e),r=t.key.path.L().K();if(t instanceof wt){var i=this.qw.Se(t),o=t.hasCommittedMutations;return new to(null,null,i,o,n,r)}if(t instanceof bt){var s=t.key.path.K(),a=this.Qw(t.version);return o=t.hasCommittedMutations,new to(null,new Xi(s,a),null,o,n,r)}if(t instanceof Et){s=t.key.path.K();var u=this.Qw(t.version);return new to(new Zi(s,u),null,null,!0,n,r)}return Ie("Unexpected MaybeDocument")},t.prototype.Fw=function(t){var e=t.O();return[e.seconds,e.nanoseconds]},t.prototype.jw=function(t){var e=new p(t[0],t[1]);return d.P(e)},t.prototype.Qw=function(t){var e=t.O();return new Yi(e.seconds,e.nanoseconds)},t.prototype.Bw=function(t){var e=new p(t.seconds,t.nanoseconds);return d.P(e)},t.prototype.gw=function(t,e){var n=this,r=e.baseMutations.map((function(t){return n.qw.Fe(t)})),i=e.mutations.map((function(t){return n.qw.Fe(t)}));return new Ki(t,e.batchId,e.gr.toMillis(),r,i)},t.prototype.yw=function(t){var e=this,n=(t.baseMutations||[]).map((function(t){return e.qw.Le(t)})),r=t.mutations.map((function(t){return e.qw.Le(t)})),i=p.fromMillis(t.localWriteTimeMs);return new Oe(t.batchId,i,n,r)},t.prototype.Gw=function(t){var e=[];return t.forEach((function(t){e.push(gn(t.path))})),e},t.prototype.Ww=function(t){for(var e=Ht(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new w(bn(i)))}return e},t.prototype.Rw=function(t){var e,n=this.Bw(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.Bw(t.lastLimboFreeSnapshotVersion):d.MIN;return e=void 0!==t.query.documents?this.qw.ze(t.query):this.qw.Xe(t.query),new Mt(e,t.targetId,0,t.lastListenSequenceNumber,n,r,R.fromBase64String(t.resumeToken))},t.prototype.Sw=function(t){Te(0===t.ti,"Only queries with purpose 0 may be stored, got "+t.ti);var e,n=this.Qw(t.ni),r=this.Qw(t.lastLimboFreeSnapshotVersion);e=t.target.Tn()?this.qw.We(t.target):this.qw.Ke(t.target);var i=t.resumeToken.toBase64();return new no(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},t}(),yo="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",go=function(t){function e(e,n){var r=t.call(this)||this;return r.Iw=e,r.fo=n,r}return Fe.__extends(e,t),e}(dn),mo=function(){function t(e,n,r,i,a,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.zo=u,this.zw=h,this.Fc=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Kw=null,this.inForeground=!1,this.Jw=null,this.Hw=null,this.Yw=Number.NEGATIVE_INFINITY,this.Xw=function(t){return Promise.resolve()},this.Cs=new Eo(this,a),this.$w=n+t.Zw,this.serializer=new vo(c),this.document=i.document,this.Os=new Li(this.Cs,this.serializer),this.Bh=new lo,this.qh=new Fi(this.serializer,this.Bh),!i.window||!i.window.localStorage)throw new s(o.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=i.window,this.tm=this.window.localStorage}return t.nw=function(t,e){if(t instanceof go)return _i.nw(t.Iw,e);throw Ie("IndexedDbPersistence must use instances of IndexedDbTransaction")},t.nm=function(e){return Fe.__awaiter(this,void 0,void 0,(function(){var n;return Fe.__generator(this,(function(r){switch(r.label){case 0:if(!t.th())throw new s(o.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(n=new t(e.allowTabSynchronization,e.persistenceKey,e.clientId,e.platform,e.im,e.zo,e.serializer,e.zw)).start()];case 1:return r.sent(),[2,n]}}))}))},t.prototype.start=function(){var t=this;return Te(!this.qu,"IndexedDbPersistence double-started!"),Te(null!==this.window,"Expected 'window' to be defined"),_i.Xv(this.$w,$i,new Wi(this.serializer)).then((function(e){return t.em=e,t.rm()})).then((function(){return t.um(),t.sm(),t.om(),t.em.runTransaction("readonly",[io.store],(function(t){return ji(t)}))})).then((function(e){t.Oc=new Le(e,t.zw)})).then((function(){t.Fc=!0})).catch((function(e){return t.em&&t.em.close(),Promise.reject(e)}))},t.prototype.jc=function(t){var e=this;return this.Xw=function(n){return Fe.__awaiter(e,void 0,void 0,(function(){return Fe.__generator(this,(function(e){return this.qu?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.xc=function(t){var e=this;this.em.iw((function(n){return Fe.__awaiter(e,void 0,void 0,(function(){return Fe.__generator(this,(function(e){switch(e.label){case 0:return null!==n.newVersion?[3,2]:[4,t()];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.jo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.zo.Qr((function(){return Fe.__awaiter(e,void 0,void 0,(function(){return Fe.__generator(this,(function(t){switch(t.label){case 0:return this.qu?[4,this.rm()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.rm=function(){var t=this;return this.em.runTransaction("readwrite",fo,(function(e){return bo(e).put(new ao(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.hm(e).next((function(e){e||(t.isPrimary=!1,t.zo.Qr((function(){return t.Xw(!1)})))}))})).next((function(){return t.cm(e)})).next((function(n){return t.isPrimary&&!n?t.am(e).next((function(){return!1})):!!n&&t.fm(e).next((function(){return!0}))}))})).catch((function(e){if(!t.allowTabSynchronization)throw e;return be("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.zo.Qr((function(){return t.Xw(e)})),t.isPrimary=e}))},t.prototype.hm=function(t){var e=this;return wo(t).get(Hi.key).next((function(t){return Be.resolve(e.lm(t))}))},t.prototype.dm=function(t){return bo(t).delete(this.clientId)},t.prototype.vm=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var e=this;return Fe.__generator(this,(function(n){switch(n.label){case 0:return!this.isPrimary||this.wm(this.Yw,18e5)?[3,2]:(this.Yw=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(n){var r=t.nw(n,ao.store);return r.aw().next((function(t){var n=e.mm(t,18e5),i=t.filter((function(t){return-1===n.indexOf(t)}));return Be.forEach(i,(function(t){return r.delete(t.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}))]);case 1:n.sent().forEach((function(t){e.window.localStorage.removeItem(e.pm(t.clientId))})),n.label=2;case 2:return[2]}}))}))},t.prototype.om=function(){var t=this;this.Hw=this.zo.iu("client_metadata_refresh",4e3,(function(){return t.rm().then((function(){return t.vm()})).then((function(){return t.om()}))}))},t.prototype.lm=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.cm=function(t){var e=this;return wo(t).get(Hi.key).next((function(n){if(null!==n&&e.wm(n.leaseTimestampMs,5e3)&&!e.bm(n.ownerId)){if(e.lm(n)&&e.networkEnabled)return!0;if(!e.lm(n)){if(!n.allowTabSynchronization)throw new s(o.FAILED_PRECONDITION,yo);return!1}}return!(!e.networkEnabled||!e.inForeground)||bo(t).aw().next((function(t){return void 0===e.mm(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&be("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return Fe.__awaiter(this,void 0,void 0,(function(){var t=this;return Fe.__generator(this,(function(e){switch(e.label){case 0:return this.Fc=!1,this.gm(),this.Hw&&(this.Hw.cancel(),this.Hw=null),this.ym(),this._m(),[4,this.em.runTransaction("readwrite",[Hi.store,ao.store],(function(e){return t.am(e).next((function(){return t.dm(e)}))}))];case 1:return e.sent(),this.em.close(),this.Im(),[2]}}))}))},t.prototype.mm=function(t,e){var n=this;return t.filter((function(t){return n.wm(t.updateTimeMs,e)&&!n.bm(t.clientId)}))},t.prototype.Oo=function(){var t=this;return this.em.runTransaction("readonly",[ao.store],(function(e){return bo(e).aw().next((function(e){return t.mm(e,18e5).map((function(t){return t.clientId}))}))}))},t.clearPersistence=function(e){return Fe.__awaiter(this,void 0,void 0,(function(){var n;return Fe.__generator(this,(function(r){switch(r.label){case 0:return t.th()?(n=e+t.Zw,[4,_i.delete(n)]):[2,Promise.resolve()];case 1:return r.sent(),[2]}}))}))},Object.defineProperty(t.prototype,"qu",{get:function(){return this.Fc},enumerable:!0,configurable:!0}),t.prototype.Vs=function(t){return Te(this.qu,"Cannot initialize MutationQueue before persistence is started."),Ri.pw(t,this.serializer,this.Bh,this.Cs)},t.prototype.Fs=function(){return Te(this.qu,"Cannot initialize TargetCache before persistence is started."),this.Os},t.prototype.Ns=function(){return Te(this.qu,"Cannot initialize RemoteDocumentCache before persistence is started."),this.qh},t.prototype.js=function(){return Te(this.qu,"Cannot initialize IndexManager before persistence is started."),this.Bh},t.prototype.runTransaction=function(t,e,n){var r=this;be("IndexedDbPersistence","Starting transaction:",t);var i,a="readonly"===e?"readonly":"readwrite";return this.em.runTransaction(a,fo,(function(a){return i=new go(a,r.Oc.next()),"readwrite-primary"===e?r.hm(a).next((function(t){return!!t||r.cm(a)})).next((function(e){if(!e)throw Ee("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.zo.Qr((function(){return r.Xw(!1)})),new s(o.FAILED_PRECONDITION,pn);return n(i)})).next((function(t){return r.fm(a).next((function(){return t}))})):r.Tm(a).next((function(){return n(i)}))})).then((function(t){return i.Mh(),t}))},t.prototype.Tm=function(t){var e=this;return wo(t).get(Hi.key).next((function(t){if(null!==t&&e.wm(t.leaseTimestampMs,5e3)&&!e.bm(t.ownerId)&&!e.lm(t)&&!t.allowTabSynchronization)throw new s(o.FAILED_PRECONDITION,yo)}))},t.prototype.fm=function(t){var e=new Hi(this.clientId,this.allowTabSynchronization,Date.now());return wo(t).put(Hi.key,e)},t.th=function(){return _i.th()},t.Em=function(t){var e=t.ae.projectId;return t.ae.br||(e+="."+t.ae.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.am=function(t){var e=this,n=wo(t);return n.get(Hi.key).next((function(t){return e.lm(t)?(be("IndexedDbPersistence","Releasing primary lease."),n.delete(Hi.key)):Be.resolve()}))},t.prototype.wm=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Ee("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.um=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Jw=function(){t.zo.Qr((function(){return t.inForeground="visible"===t.document.visibilityState,t.rm()}))},this.document.addEventListener("visibilitychange",this.Jw),this.inForeground="visible"===this.document.visibilityState)},t.prototype.ym=function(){this.Jw&&(Te(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.Jw),this.Jw=null)},t.prototype.sm=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.Kw=function(){t.gm(),t.zo.Qr((function(){return t.shutdown()}))},this.window.addEventListener("unload",this.Kw))},t.prototype._m=function(){this.Kw&&(Te("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.Kw),this.Kw=null)},t.prototype.bm=function(t){try{var e=null!==this.tm.getItem(this.pm(t));return be("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Ee("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.gm=function(){try{this.tm.setItem(this.pm(this.clientId),String(Date.now()))}catch(t){Ee("Failed to set zombie client id.",t)}},t.prototype.Im=function(){try{this.tm.removeItem(this.pm(this.clientId))}catch(t){}},t.prototype.pm=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t.Zw="main",t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */function wo(t){return t.store(Hi.store)}function bo(t){return t.store(ao.store)}var Eo=function(){function t(t,e){this.db=t,this.Bc=null,this.ju=new He(this,e)}return t.prototype.Wu=function(t){var e=this.Dm(t);return this.db.Fs().kc(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Dm=function(t){var e=0;return this.Ku(t,(function(t){e++})).next((function(){return e}))},t.prototype.$i=function(t,e){return this.db.Fs().$i(t,e)},t.prototype.Ku=function(t,e){return this.Rm(t,(function(t,n){return e(n)}))},t.prototype.As=function(t){this.Bc=t},t.prototype.es=function(t,e){return _o(t,e)},t.prototype.us=function(t,e){return _o(t,e)},t.prototype.Ju=function(t,e,n){return this.db.Fs().Ju(t,e,n)},t.prototype.lc=function(t,e){return _o(t,e)},t.prototype.Sm=function(t,e){return this.Bc.fs(e)?Be.resolve(!0):function(t,e){var n=!1;return Pi(t).ww((function(r){return Di(t,r,e).next((function(t){return t&&(n=!0),Be.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.Hu=function(t,e){var n=this,r=this.db.Ns().Xs(),i=[],o=0;return this.Rm(t,(function(s,a){if(a<=e){var u=n.Sm(t,s).next((function(e){if(!e)return o++,r.gs(t,s).next((function(){return r.bs(s),Bi(t).delete([0,gn(s.path)])}))}));i.push(u)}})).next((function(){return Be.pu(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.ii(t.fo);return this.db.Fs().do(t,n)},t.prototype.vo=function(t,e){return _o(t,e)},t.prototype.Rm=function(t,e){var n,r=Bi(t),i=Le.Nr;return r.vw({index:ro.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),a=r.sequenceNumber;0===o?(i!==Le.Nr&&e(new w(bn(n)),i),i=a,n=s):i=Le.Nr})).next((function(){i!==Le.Nr&&e(new w(bn(n)),i)}))},t.prototype.Xu=function(t){return this.db.Ns().pc(t)},t}();function _o(t,e){return Bi(t).put(function(t,e){return new ro(0,gn(t.path),e)}(e,t.fo))}var Io=function(){function t(){}return t.prototype.initialize=function(t,e,n,r,i,a){return Fe.__awaiter(this,void 0,void 0,(function(){var u,c,h,f;return Fe.__generator(this,(function(l){switch(l.label){case 0:if(Te(a.zc,"IndexedDbPersistenceProvider can only provide durable persistence"),Te(!this.persistence,"configure() already called"),u=mo.Em(e),c=new de(e.ae,{de:ye.xt().de}),!fn.th(n))throw new s(o.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return this.Ml=a.synchronizeTabs?new fn(t,n,u,r,i):new ln,h=this,[4,mo.nm({allowTabSynchronization:a.synchronizeTabs,persistenceKey:u,clientId:r,platform:n,zo:t,serializer:c,im:We.Pu(a.cacheSizeBytes),zw:this.Ml})];case 1:return h.persistence=l.sent(),f=this.persistence.Cs.ju,this.Md=new Ye(f,t),[2]}}))}))},t.prototype.Jc=function(){return Te(!!this.persistence,"initialize() not called"),this.persistence},t.prototype.Hc=function(){return Te(!!this.Ml,"initialize() not called"),this.Ml},t.prototype.Kc=function(){return Te(!!this.Md,"initialize() not called"),this.Md},t.prototype.clearPersistence=function(t){var e=mo.Em(t);return mo.clearPersistence(e)},t}(),To={Firestore:pi,GeoPoint:mr,Timestamp:p,Blob:ur,Transaction:di,WriteBatch:vi,DocumentReference:yi,DocumentSnapshot:gi,Query:wi,QueryDocumentSnapshot:mi,QuerySnapshot:bi,CollectionReference:Ei,FieldPath:cr,FieldValue:gr,setLogLevel:Kr.setLogLevel,CACHE_SIZE_UNLIMITED:Hr},Ao=function(){function t(){}return t.prototype.jf=function(t){},t.prototype.shutdown=function(){},t}(),No=function(){function t(){var t=this;this.Am=function(){return t.Cm()},this.Pm=function(){return t.Vm()},this.km=[],this.Nm()}return t.prototype.jf=function(t){this.km.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.Am),window.removeEventListener("offline",this.Pm)},t.prototype.Nm=function(){window.addEventListener("online",this.Am),window.addEventListener("offline",this.Pm)},t.prototype.Cm=function(){be("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.km;t<e.length;t++)(0,e[t])(0)},t.prototype.Vm=function(){be("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.km;t<e.length;t++)(0,e[t])(1)},t.th=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),So=function(){function t(t){this.Om=t.Om,this.Fm=t.Fm}return t.prototype.Ea=function(t){Te(!this.Um,"Called onOpen on stream twice!"),this.Um=t},t.prototype.ga=function(t){Te(!this.jm,"Called onClose on stream twice!"),this.jm=t},t.prototype.onMessage=function(t){Te(!this.xm,"Called onMessage on stream twice!"),this.xm=t},t.prototype.close=function(){this.Fm()},t.prototype.send=function(t){this.Om(t)},t.prototype.Lm=function(){Te(void 0!==this.Um,"Cannot call onOpen because no callback was set"),this.Um()},t.prototype.Mm=function(t){Te(void 0!==this.jm,"Cannot call onClose because no callback was set"),this.jm(t)},t.prototype.qm=function(t){Te(void 0!==this.xm,"Cannot call onMessage because no callback was set"),this.xm(t)},t}(),ko={BatchGetDocuments:"batchGet",Commit:"commit"},Ro="gl-js/ fire/"+r,Do=function(){function t(t){this.ae=t.ae;var e=t.ssl?"https":"http";this.Bm=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype.Qm=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=Ro},t.prototype.Ua=function(t,e,n){var r=this,i=this.Gm(t);return new Promise((function(a,u){var c=new Ps.XhrIo;c.listenOnce(Ps.EventType.COMPLETE,(function(){try{switch(c.getLastErrorCode()){case Ps.ErrorCode.NO_ERROR:var e=c.getResponseJson();be("Connection","XHR received:",JSON.stringify(e)),a(e);break;case Ps.ErrorCode.TIMEOUT:be("Connection",'RPC "'+t+'" timed out'),u(new s(o.DEADLINE_EXCEEDED,"Request time out"));break;case Ps.ErrorCode.HTTP_ERROR:var n=c.getStatus();if(be("Connection",'RPC "'+t+'" failed with status:',n,"response text:",c.getResponseText()),n>0){var r=c.getResponseJson().error;if(r&&r.status&&r.message){var i=(h=r.status.toLowerCase().replace("_","-"),Object.values(o).indexOf(h)>=0?h:o.UNKNOWN);u(new s(i,r.message))}else u(new s(o.UNKNOWN,"Server responded with status "+c.getStatus()))}else be("Connection",'RPC "'+t+'" failed'),u(new s(o.UNAVAILABLE,"Connection failed."));break;default:Ie('RPC "'+t+'" failed with unanticipated webchannel error '+c.getLastErrorCode()+": "+c.getLastError()+", giving up.")}}finally{be("Connection",'RPC "'+t+'" completed.')}var h}));var h=Fe.__assign({},e);delete h.database;var f=JSON.stringify(h);be("Connection","XHR sending: ",i+" "+f);var l={"Content-Type":"text/plain"};r.Qm(l,n),c.send(i,"POST",f,l,15)}))},t.prototype.ja=function(t,e,n){return this.Ua(t,e,n)},t.prototype.Da=function(t,e){var n=[this.Bm,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Ps.createWebChannelTransport(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ae.projectId+"/databases/"+this.ae.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Qm(i.initMessageHeaders,e),Ve.isMobileCordova()||Ve.isReactNative()||Ve.isElectron()||Ve.isIE()||Ve.isUWP()||Ve.isBrowserExtension()||(i.httpHeadersOverwriteParam="$httpHeaders");var a=n.join("");be("Connection","Creating WebChannel: "+a+" "+i);var u=r.createWebChannel(a,i),c=!1,h=!1,f=new So({Om:function(t){h?be("Connection","Not sending because WebChannel is closed:",t):(c||(be("Connection","Opening WebChannel transport."),u.open(),c=!0),be("Connection","WebChannel sending:",t),u.send(t))},Fm:function(){return u.close()}}),l=function(t,e){u.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return l(Ps.WebChannel.EventType.OPEN,(function(){h||be("Connection","WebChannel transport opened.")})),l(Ps.WebChannel.EventType.CLOSE,(function(){h||(h=!0,be("Connection","WebChannel transport closed"),f.Mm())})),l(Ps.WebChannel.EventType.ERROR,(function(t){h||(h=!0,be("Connection","WebChannel transport errored:",t),f.Mm(new s(o.UNAVAILABLE,"The operation could not be completed")))})),l(Ps.WebChannel.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];Te(!!n,"Got a webchannel message without data.");var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){be("Connection","WebChannel received error:",i);var a=i.status,c=function(t){var e=it[t];if(void 0!==e)return Bt(e)}(a),l=i.message;void 0===c&&(c=o.INTERNAL,l="Unknown error status: "+a+" with message "+i.message),h=!0,f.Mm(new s(c,l)),u.close()}else be("Connection","WebChannel received:",n),f.qm(n)}})),setTimeout((function(){f.Lm()}),0),f},t.prototype.Gm=function(t){var e=ko[t];return Te(void 0!==e,"Unknown REST mapping for: "+t),this.Bm+"/v1/projects/"+this.ae.projectId+"/databases/"+this.ae.database+"/documents:"+e},t}(),Oo=window.crypto||window.__PRIVATE_msCrypto,xo=function(){function t(){this.de=!0,this.xa="undefined"!=typeof atob}return Object.defineProperty(t.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),t.prototype.Bd=function(t){return Promise.resolve(new Do(t))},t.prototype.Qd=function(){return No.th()?new No:new Ao},t.prototype.Gd=function(t){return new de(t,{de:!0})},t.prototype.mr=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t.prototype.randomBytes=function(t){if(t<=0)return new Uint8Array;var e=new Uint8Array(t);return Oo.getRandomValues(e),e},t}();
/**
     * @license
     * Copyright 2017 Google LLC
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function Co(t){!function(t,e){t.INTERNAL.registerComponent(new qe.Component("firestore",(function(t){return function(t,e){return new Kr(t,e,new Io)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Fe.__assign({},To)))}(t),t.registerVersion("@firebase/firestore","1.13.1")
/**
     * @license
     * Copyright 2017 Google Inc.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *   http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */}ye.wr(new xo),Co(n),e.__PRIVATE_registerFirestore=Co}));yt(Ls);Ls.__PRIVATE_registerFirestore;nn.initializeApp({apiKey:"AIzaSyDriffF4c33V459hiSyEkFmUZAQaportrs",databaseURL:"not-firebase-58b83.firebaseapp.com",storageBucket:"not-firebase-58b83.appspot.com",projectId:"not-firebase-58b83"});const Ms=nn.firestore,Us=nn.firestore();function js(e){let n,r,i,o,s;return{c(){n=_(),r=b("h1"),r.textContent="This is not Meatspac.es",i=_(),o=b("button"),o.textContent="Create a New Room",document.title="NOT Meatspac.es"},m(t,e,a){m(t,n,e),m(t,r,e),m(t,i,e),m(t,o,e),a&&s(),s=T(o,"click",Bs)},p:t,i:t,o:t,d(t){t&&w(n),t&&w(r),t&&w(i),t&&w(o),s()}}}async function Bs(){const t=await Us.collection("rooms").add({});xe(`rooms/${t.id}`)}function Fs(t){const e=t-1;return e*e*e+1}function Vs(t){return--t*t*t*t*t+1}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function qs(t){var{fallback:e}=t,r=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["fallback"]);const i=new Map,o=new Map;function a(t,i,o){return(a,u)=>(t.set(u.key,{rect:a.getBoundingClientRect()}),()=>{if(i.has(u.key)){const{rect:t}=i.get(u.key);return i.delete(u.key),function(t,e,i){const{delay:o=0,duration:a=(t=>30*Math.sqrt(t)),easing:u=Fs}=n(n({},r),i),c=e.getBoundingClientRect(),h=t.left-c.left,f=t.top-c.top,l=t.width/c.width,p=t.height/c.height,d=Math.sqrt(h*h+f*f),v=getComputedStyle(e),y="none"===v.transform?"":v.transform,g=+v.opacity;return{delay:o,duration:s(a)?a(d):a,easing:u,css:(t,e)=>`\n\t\t\t\topacity: ${t*g};\n\t\t\t\ttransform-origin: top left;\n\t\t\t\ttransform: ${y} translate(${e*h}px,${e*f}px) scale(${t+(1-t)*l}, ${t+(1-t)*p});\n\t\t\t`}}(t,a,u)}return t.delete(u.key),e&&e(a,u,o)})}return[a(o,i,!1),a(i,o,!0)]}function zs(t,e,n){const r=getComputedStyle(t),i="none"===r.transform?"":r.transform,o=e.from.width/t.clientWidth,a=e.from.height/t.clientHeight,u=(e.from.left-e.to.left)/o,c=(e.from.top-e.to.top)/a,h=Math.sqrt(u*u+c*c),{delay:f=0,duration:l=(t=>120*Math.sqrt(t)),easing:p=Fs}=n;return{delay:f,duration:s(l)?l(h):l,easing:p,css:(t,e)=>`transform: ${i} translate(${e*u}px, ${e*c}px);`}}const Gs=pt(!document.hidden,t=>{function e(){t(!document.hidden)}return document.addEventListener("visibilitychange",e,!1),()=>{document.removeEventListener("visibilitychange",e,!1)}});var $s=[],Ws=[],Ys="undefined"!=typeof Uint8Array?Uint8Array:Array,Hs=!1;function Qs(){Hs=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=t.length;e<n;++e)$s[e]=t[e],Ws[t.charCodeAt(e)]=e;Ws["-".charCodeAt(0)]=62,Ws["_".charCodeAt(0)]=63}function Ks(t,e,n){for(var r,i,o=[],s=e;s<n;s+=3)r=(t[s]<<16)+(t[s+1]<<8)+t[s+2],o.push($s[(i=r)>>18&63]+$s[i>>12&63]+$s[i>>6&63]+$s[63&i]);return o.join("")}function Js(t){var e;Hs||Qs();for(var n=t.length,r=n%3,i="",o=[],s=0,a=n-r;s<a;s+=16383)o.push(Ks(t,s,s+16383>a?a:s+16383));return 1===r?(e=t[n-1],i+=$s[e>>2],i+=$s[e<<4&63],i+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],i+=$s[e>>10],i+=$s[e>>4&63],i+=$s[e<<2&63],i+="="),o.push(i),o.join("")}function Xs(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,h=-7,f=n?i-1:0,l=n?-1:1,p=t[e+f];for(f+=l,o=p&(1<<-h)-1,p>>=-h,h+=a;h>0;o=256*o+t[e+f],f+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+t[e+f],f+=l,h-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)}function Zs(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,h=(1<<c)-1,f=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+f>=1?l/u:l*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=h?(a=0,s=h):s+f>=1?(a=(e*u-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*v}var ta={}.toString,ea=Array.isArray||function(t){return"[object Array]"==ta.call(t)};oa.TYPED_ARRAY_SUPPORT=void 0===rn.TYPED_ARRAY_SUPPORT||rn.TYPED_ARRAY_SUPPORT;var na=ra();function ra(){return oa.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ia(t,e){if(ra()<e)throw new RangeError("Invalid typed array length");return oa.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=oa.prototype:(null===t&&(t=new oa(e)),t.length=e),t}function oa(t,e,n){if(!(oa.TYPED_ARRAY_SUPPORT||this instanceof oa))return new oa(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return ua(this,t)}return sa(this,t,e,n)}function sa(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);oa.TYPED_ARRAY_SUPPORT?(t=e).__proto__=oa.prototype:t=ca(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!oa.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|la(e,n),i=(t=ia(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(fa(e)){var n=0|ha(e.length);return 0===(t=ia(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?ia(t,0):ca(t,e);if("Buffer"===e.type&&ea(e.data))return ca(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function aa(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function ua(t,e){if(aa(e),t=ia(t,e<0?0:0|ha(e)),!oa.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function ca(t,e){var n=e.length<0?0:0|ha(e.length);t=ia(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function ha(t){if(t>=ra())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ra().toString(16)+" bytes");return 0|t}function fa(t){return!(null==t||!t._isBuffer)}function la(t,e){if(fa(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Ba(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Fa(t).length;default:if(r)return Ba(t).length;e=(""+e).toLowerCase(),r=!0}}function pa(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return ka(this,e,n);case"utf8":case"utf-8":return Aa(this,e,n);case"ascii":return Na(this,e,n);case"latin1":case"binary":return Sa(this,e,n);case"base64":return Ta(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ra(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function da(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function va(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=oa.from(e,r)),fa(e))return 0===e.length?-1:ya(t,e,n,r,i);if("number"==typeof e)return e&=255,oa.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):ya(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function ya(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var h=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var f=!0,l=0;l<u;l++)if(c(t,o+l)!==c(e,l)){f=!1;break}if(f)return o}return-1}function ma(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[n+s]=a}return s}function wa(t,e,n,r){return Va(Ba(e,t.length-n),t,n,r)}function ba(t,e,n,r){return Va(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function Ea(t,e,n,r){return ba(t,e,n,r)}function _a(t,e,n,r){return Va(Fa(e),t,n,r)}function Ia(t,e,n,r){return Va(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function Ta(t,e,n){return 0===e&&n===t.length?Js(t):Js(t.slice(e,n))}function Aa(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],h=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(h=c);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(h=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(h=u)}null===h?(h=65533,f=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=f}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}oa.poolSize=8192,oa._augment=function(t){return t.__proto__=oa.prototype,t},oa.from=function(t,e,n){return sa(null,t,e,n)},oa.TYPED_ARRAY_SUPPORT&&(oa.prototype.__proto__=Uint8Array.prototype,oa.__proto__=Uint8Array),oa.alloc=function(t,e,n){return function(t,e,n,r){return aa(e),e<=0?ia(t,e):void 0!==n?"string"==typeof r?ia(t,e).fill(n,r):ia(t,e).fill(n):ia(t,e)}(null,t,e,n)},oa.allocUnsafe=function(t){return ua(null,t)},oa.allocUnsafeSlow=function(t){return ua(null,t)},oa.isBuffer=qa,oa.compare=function(t,e){if(!fa(t)||!fa(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},oa.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},oa.concat=function(t,e){if(!ea(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return oa.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=oa.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!fa(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},oa.byteLength=la,oa.prototype._isBuffer=!0,oa.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)da(this,e,e+1);return this},oa.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)da(this,e,e+3),da(this,e+1,e+2);return this},oa.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)da(this,e,e+7),da(this,e+1,e+6),da(this,e+2,e+5),da(this,e+3,e+4);return this},oa.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Aa(this,0,t):pa.apply(this,arguments)},oa.prototype.equals=function(t){if(!fa(t))throw new TypeError("Argument must be a Buffer");return this===t||0===oa.compare(this,t)},oa.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},oa.prototype.compare=function(t,e,n,r,i){if(!fa(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),u=this.slice(r,i),c=t.slice(e,n),h=0;h<a;++h)if(u[h]!==c[h]){o=u[h],s=c[h];break}return o<s?-1:s<o?1:0},oa.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},oa.prototype.indexOf=function(t,e,n){return va(this,t,e,n,!0)},oa.prototype.lastIndexOf=function(t,e,n){return va(this,t,e,n,!1)},oa.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return ma(this,t,e,n);case"utf8":case"utf-8":return wa(this,t,e,n);case"ascii":return ba(this,t,e,n);case"latin1":case"binary":return Ea(this,t,e,n);case"base64":return _a(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ia(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},oa.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Na(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function Sa(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function ka(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=ja(t[o]);return i}function Ra(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function Da(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Oa(t,e,n,r,i,o){if(!fa(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function xa(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function Ca(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function Pa(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function La(t,e,n,r,i){return i||Pa(t,0,n,4),Zs(t,e,n,r,23,4),n+4}function Ma(t,e,n,r,i){return i||Pa(t,0,n,8),Zs(t,e,n,r,52,8),n+8}oa.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),oa.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=oa.prototype;else{var i=e-t;n=new oa(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},oa.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||Da(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},oa.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||Da(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},oa.prototype.readUInt8=function(t,e){return e||Da(t,1,this.length),this[t]},oa.prototype.readUInt16LE=function(t,e){return e||Da(t,2,this.length),this[t]|this[t+1]<<8},oa.prototype.readUInt16BE=function(t,e){return e||Da(t,2,this.length),this[t]<<8|this[t+1]},oa.prototype.readUInt32LE=function(t,e){return e||Da(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},oa.prototype.readUInt32BE=function(t,e){return e||Da(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},oa.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||Da(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},oa.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||Da(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},oa.prototype.readInt8=function(t,e){return e||Da(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},oa.prototype.readInt16LE=function(t,e){e||Da(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},oa.prototype.readInt16BE=function(t,e){e||Da(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},oa.prototype.readInt32LE=function(t,e){return e||Da(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},oa.prototype.readInt32BE=function(t,e){return e||Da(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},oa.prototype.readFloatLE=function(t,e){return e||Da(t,4,this.length),Xs(this,t,!0,23,4)},oa.prototype.readFloatBE=function(t,e){return e||Da(t,4,this.length),Xs(this,t,!1,23,4)},oa.prototype.readDoubleLE=function(t,e){return e||Da(t,8,this.length),Xs(this,t,!0,52,8)},oa.prototype.readDoubleBE=function(t,e){return e||Da(t,8,this.length),Xs(this,t,!1,52,8)},oa.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||Oa(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},oa.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||Oa(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},oa.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,1,255,0),oa.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},oa.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,2,65535,0),oa.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):xa(this,t,e,!0),e+2},oa.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,2,65535,0),oa.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):xa(this,t,e,!1),e+2},oa.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,4,4294967295,0),oa.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Ca(this,t,e,!0),e+4},oa.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,4,4294967295,0),oa.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ca(this,t,e,!1),e+4},oa.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);Oa(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},oa.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);Oa(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},oa.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,1,127,-128),oa.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},oa.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,2,32767,-32768),oa.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):xa(this,t,e,!0),e+2},oa.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,2,32767,-32768),oa.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):xa(this,t,e,!1),e+2},oa.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,4,2147483647,-2147483648),oa.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Ca(this,t,e,!0),e+4},oa.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Oa(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),oa.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ca(this,t,e,!1),e+4},oa.prototype.writeFloatLE=function(t,e,n){return La(this,t,e,!0,n)},oa.prototype.writeFloatBE=function(t,e,n){return La(this,t,e,!1,n)},oa.prototype.writeDoubleLE=function(t,e,n){return Ma(this,t,e,!0,n)},oa.prototype.writeDoubleBE=function(t,e,n){return Ma(this,t,e,!1,n)},oa.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!oa.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},oa.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!oa.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=fa(t)?t:Ba(new oa(t,r).toString()),a=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var Ua=/[^+\/0-9A-Za-z-_]/g;function ja(t){return t<16?"0"+t.toString(16):t.toString(16)}function Ba(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Fa(t){return function(t){var e,n,r,i,o,s;Hs||Qs();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===t[a-2]?2:"="===t[a-1]?1:0,s=new Ys(3*a/4-o),r=o>0?a-4:a;var u=0;for(e=0,n=0;e<r;e+=4,n+=3)i=Ws[t.charCodeAt(e)]<<18|Ws[t.charCodeAt(e+1)]<<12|Ws[t.charCodeAt(e+2)]<<6|Ws[t.charCodeAt(e+3)],s[u++]=i>>16&255,s[u++]=i>>8&255,s[u++]=255&i;return 2===o?(i=Ws[t.charCodeAt(e)]<<2|Ws[t.charCodeAt(e+1)]>>4,s[u++]=255&i):1===o&&(i=Ws[t.charCodeAt(e)]<<10|Ws[t.charCodeAt(e+1)]<<4|Ws[t.charCodeAt(e+2)]>>2,s[u++]=i>>8&255,s[u++]=255&i),s}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Ua,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Va(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function qa(t){return null!=t&&(!!t._isBuffer||za(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&za(t.slice(0,0))}(t))}function za(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var Ga=Object.freeze({__proto__:null,INSPECT_MAX_BYTES:50,kMaxLength:na,Buffer:oa,SlowBuffer:function(t){return+t!=t&&(t=0),oa.alloc(+t)},isBuffer:qa}),$a="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},Wa=/%[sdj%]/g;function Ya(t){if(!uu(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(Xa(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,o=String(t).replace(Wa,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),s=r[n];n<i;s=r[++n])su(s)||!fu(s)?o+=" "+s:o+=" "+Xa(s);return o}function Ha(t,e){if(cu(rn.process))return function(){return Ha(t,e).apply(this,arguments)};var n=!1;return function(){return n||(console.error(e),n=!0),t.apply(this,arguments)}}var Qa,Ka={};function Ja(t){if(cu(Qa)&&(Qa=Dn.env.NODE_DEBUG||""),t=t.toUpperCase(),!Ka[t])if(new RegExp("\\b"+t+"\\b","i").test(Qa)){Ka[t]=function(){var e=Ya.apply(null,arguments);console.error("%s %d: %s",t,0,e)}}else Ka[t]=function(){};return Ka[t]}function Xa(t,e){var n={seen:[],stylize:tu};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),ou(e)?n.showHidden=e:e&&bu(n,e),cu(n.showHidden)&&(n.showHidden=!1),cu(n.depth)&&(n.depth=2),cu(n.colors)&&(n.colors=!1),cu(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Za),eu(n,t,n.depth)}function Za(t,e){var n=Xa.styles[e];return n?"["+Xa.colors[n][0]+"m"+t+"["+Xa.colors[n][1]+"m":t}function tu(t,e){return t}function eu(t,e,n){if(t.customInspect&&e&&du(e.inspect)&&e.inspect!==Xa&&(!e.constructor||e.constructor.prototype!==e)){var r=e.inspect(n,t);return uu(r)||(r=eu(t,r,n)),r}var i=function(t,e){if(cu(e))return t.stylize("undefined","undefined");if(uu(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(au(e))return t.stylize(""+e,"number");if(ou(e))return t.stylize(""+e,"boolean");if(su(e))return t.stylize("null","null")}(t,e);if(i)return i;var o=Object.keys(e),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),pu(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return nu(e);if(0===o.length){if(du(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(hu(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(lu(e))return t.stylize(Date.prototype.toString.call(e),"date");if(pu(e))return nu(e)}var u,c="",h=!1,f=["{","}"];(iu(e)&&(h=!0,f=["[","]"]),du(e))&&(c=" [Function"+(e.name?": "+e.name:"")+"]");return hu(e)&&(c=" "+RegExp.prototype.toString.call(e)),lu(e)&&(c=" "+Date.prototype.toUTCString.call(e)),pu(e)&&(c=" "+nu(e)),0!==o.length||h&&0!=e.length?n<0?hu(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),u=h?function(t,e,n,r,i){for(var o=[],s=0,a=e.length;s<a;++s)Eu(e,String(s))?o.push(ru(t,e,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(ru(t,e,n,r,i,!0))})),o}(t,e,n,s,o):o.map((function(r){return ru(t,e,n,s,r,h)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,c,f)):f[0]+c+f[1]}function nu(t){return"["+Error.prototype.toString.call(t)+"]"}function ru(t,e,n,r,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),Eu(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=su(n)?eu(t,u.value,null):eu(t,u.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),cu(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function iu(t){return Array.isArray(t)}function ou(t){return"boolean"==typeof t}function su(t){return null===t}function au(t){return"number"==typeof t}function uu(t){return"string"==typeof t}function cu(t){return void 0===t}function hu(t){return fu(t)&&"[object RegExp]"===yu(t)}function fu(t){return"object"==typeof t&&null!==t}function lu(t){return fu(t)&&"[object Date]"===yu(t)}function pu(t){return fu(t)&&("[object Error]"===yu(t)||t instanceof Error)}function du(t){return"function"==typeof t}function vu(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function yu(t){return Object.prototype.toString.call(t)}function gu(t){return t<10?"0"+t.toString(10):t.toString(10)}Xa.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Xa.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var mu=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function wu(){var t=new Date,e=[gu(t.getHours()),gu(t.getMinutes()),gu(t.getSeconds())].join(":");return[t.getDate(),mu[t.getMonth()],e].join(" ")}function bu(t,e){if(!e||!fu(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function Eu(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var _u={inherits:$a,_extend:bu,log:function(){console.log("%s - %s",wu(),Ya.apply(null,arguments))},isBuffer:function(t){return qa(t)},isPrimitive:vu,isFunction:du,isError:pu,isDate:lu,isObject:fu,isRegExp:hu,isUndefined:cu,isSymbol:function(t){return"symbol"==typeof t},isString:uu,isNumber:au,isNullOrUndefined:function(t){return null==t},isNull:su,isBoolean:ou,isArray:iu,inspect:Xa,deprecate:Ha,format:Ya,debuglog:Ja};function Iu(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}var Tu,Au=Object.prototype.hasOwnProperty,Nu=Object.keys||function(t){var e=[];for(var n in t)Au.call(t,n)&&e.push(n);return e},Su=Array.prototype.slice;function ku(){return void 0!==Tu?Tu:Tu="foo"===function(){}.name}function Ru(t){return Object.prototype.toString.call(t)}function Du(t){return!qa(t)&&("function"==typeof rn.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}function Ou(t,e){t||Uu(t,!0,e,"==",ju)}var xu=/\s*function\s+([^\(\s]*)\s*/;function Cu(t){if(du(t)){if(ku())return t.name;var e=t.toString().match(xu);return e&&e[1]}}function Pu(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return Lu(Mu(t.actual),128)+" "+t.operator+" "+Lu(Mu(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||Uu;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=Cu(e),o=r.indexOf("\n"+i);if(o>=0){var s=r.indexOf("\n",o+1);r=r.substring(s+1)}this.stack=r}}}function Lu(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function Mu(t){if(ku()||!du(t))return Xa(t);var e=Cu(t);return"[Function"+(e?": "+e:"")+"]"}function Uu(t,e,n,r,i){throw new Pu({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function ju(t,e){t||Uu(t,!0,e,"==",ju)}function Bu(t,e,n,r){if(t===e)return!0;if(qa(t)&&qa(e))return 0===Iu(t,e);if(lu(t)&&lu(e))return t.getTime()===e.getTime();if(hu(t)&&hu(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(Du(t)&&Du(e)&&Ru(t)===Ru(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===Iu(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(qa(t)!==qa(e))return!1;var i=(r=r||{actual:[],expected:[]}).actual.indexOf(t);return-1!==i&&i===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(vu(t)||vu(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=Fu(t),o=Fu(e);if(i&&!o||!i&&o)return!1;if(i)return t=Su.call(t),e=Su.call(e),Bu(t,e,n);var s,a,u=Nu(t),c=Nu(e);if(u.length!==c.length)return!1;for(u.sort(),c.sort(),a=u.length-1;a>=0;a--)if(u[a]!==c[a])return!1;for(a=u.length-1;a>=0;a--)if(s=u[a],!Bu(t[s],e[s],n,r))return!1;return!0}(t,e,n,r))}return n?t===e:t==e}function Fu(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function Vu(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function qu(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&Uu(i,n,"Missing expected exception"+r);var o="string"==typeof r,s=!t&&i&&!n;if((!t&&pu(i)&&o&&Vu(i,n)||s)&&Uu(i,n,"Got unwanted exception"+r),t&&i&&n&&!Vu(i,n)||!t&&i)throw i}function zu(){}function Gu(){Gu.init.call(this)}function $u(t){return void 0===t._maxListeners?Gu.defaultMaxListeners:t._maxListeners}function Wu(t,e,n){if(e)t.call(n);else for(var r=t.length,i=tc(t,r),o=0;o<r;++o)i[o].call(n)}function Yu(t,e,n,r){if(e)t.call(n,r);else for(var i=t.length,o=tc(t,i),s=0;s<i;++s)o[s].call(n,r)}function Hu(t,e,n,r,i){if(e)t.call(n,r,i);else for(var o=t.length,s=tc(t,o),a=0;a<o;++a)s[a].call(n,r,i)}function Qu(t,e,n,r,i,o){if(e)t.call(n,r,i,o);else for(var s=t.length,a=tc(t,s),u=0;u<s;++u)a[u].call(n,r,i,o)}function Ku(t,e,n,r){if(e)t.apply(n,r);else for(var i=t.length,o=tc(t,i),s=0;s<i;++s)o[s].apply(n,r)}function Ju(t,e,n,r){var i,o,s,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((o=t._events)?(o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]):(o=t._events=new zu,t._eventsCount=0),s){if("function"==typeof s?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),!s.warned&&(i=$u(t))&&i>0&&s.length>i){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,a=u,"function"==typeof console.warn?console.warn(a):console.log(a)}}else s=o[e]=n,++t._eventsCount;return t}function Xu(t,e,n){var r=!1;function i(){t.removeListener(e,i),r||(r=!0,n.apply(t,arguments))}return i.listener=n,i}function Zu(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function tc(t,e){for(var n=new Array(e);e--;)n[e]=t[e];return n}Ou.AssertionError=Pu,$a(Pu,Error),Ou.fail=Uu,Ou.ok=ju,Ou.equal=function t(e,n,r){e!=n&&Uu(e,n,r,"==",t)},Ou.notEqual=function t(e,n,r){e==n&&Uu(e,n,r,"!=",t)},Ou.deepEqual=function t(e,n,r){Bu(e,n,!1)||Uu(e,n,r,"deepEqual",t)},Ou.deepStrictEqual=function t(e,n,r){Bu(e,n,!0)||Uu(e,n,r,"deepStrictEqual",t)},Ou.notDeepEqual=function t(e,n,r){Bu(e,n,!1)&&Uu(e,n,r,"notDeepEqual",t)},Ou.notDeepStrictEqual=function t(e,n,r){Bu(e,n,!0)&&Uu(e,n,r,"notDeepStrictEqual",t)},Ou.strictEqual=function t(e,n,r){e!==n&&Uu(e,n,r,"===",t)},Ou.notStrictEqual=function t(e,n,r){e===n&&Uu(e,n,r,"!==",t)},Ou.throws=function(t,e,n){qu(!0,t,e,n)},Ou.doesNotThrow=function(t,e,n){qu(!1,t,e,n)},Ou.ifError=function(t){if(t)throw t},zu.prototype=Object.create(null),Gu.EventEmitter=Gu,Gu.usingDomains=!1,Gu.prototype.domain=void 0,Gu.prototype._events=void 0,Gu.prototype._maxListeners=void 0,Gu.defaultMaxListeners=10,Gu.init=function(){this.domain=null,Gu.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new zu,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Gu.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},Gu.prototype.getMaxListeners=function(){return $u(this)},Gu.prototype.emit=function(t){var e,n,r,i,o,s,a,u="error"===t;if(s=this._events)u=u&&null==s.error;else if(!u)return!1;if(a=this.domain,u){if(e=arguments[1],!a){if(e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=a,e.domainThrown=!1,a.emit("error",e),!1}if(!(n=s[t]))return!1;var h="function"==typeof n;switch(r=arguments.length){case 1:Wu(n,h,this);break;case 2:Yu(n,h,this,arguments[1]);break;case 3:Hu(n,h,this,arguments[1],arguments[2]);break;case 4:Qu(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(r-1),o=1;o<r;o++)i[o-1]=arguments[o];Ku(n,h,this,i)}return!0},Gu.prototype.addListener=function(t,e){return Ju(this,t,e,!1)},Gu.prototype.on=Gu.prototype.addListener,Gu.prototype.prependListener=function(t,e){return Ju(this,t,e,!0)},Gu.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,Xu(this,t,e)),this},Gu.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Xu(this,t,e)),this},Gu.prototype.removeListener=function(t,e){var n,r,i,o,s;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[t]))return this;if(n===e||n.listener&&n.listener===e)0==--this._eventsCount?this._events=new zu:(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length;o-- >0;)if(n[o]===e||n[o].listener&&n[o].listener===e){s=n[o].listener,i=o;break}if(i<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new zu,this;delete r[t]}else!function(t,e){for(var n=e,r=n+1,i=t.length;r<i;n+=1,r+=1)t[n]=t[r];t.pop()}(n,i);r.removeListener&&this.emit("removeListener",t,s||e)}return this},Gu.prototype.removeAllListeners=function(t){var e,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new zu,this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=new zu:delete n[t]),this;if(0===arguments.length){for(var r,i=Object.keys(n),o=0;o<i.length;++o)"removeListener"!==(r=i[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new zu,this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)do{this.removeListener(t,e[e.length-1])}while(e[0]);return this},Gu.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):[]},Gu.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):Zu.call(t,e)},Gu.prototype.listenerCount=Zu,Gu.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var ec=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)};function nc(){this.head=null,this.tail=null,this.length=0}nc.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},nc.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},nc.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},nc.prototype.clear=function(){this.head=this.tail=null,this.length=0},nc.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},nc.prototype.concat=function(t){if(0===this.length)return oa.alloc(0);if(1===this.length)return this.head.data;for(var e=oa.allocUnsafe(t>>>0),n=this.head,r=0;n;)n.data.copy(e,r),r+=n.data.length,n=n.next;return e};var rc=oa.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function ic(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!rc(t))throw new Error("Unknown encoding: "+t)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=sc;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=ac;break;default:return void(this.write=oc)}this.charBuffer=new oa(6),this.charReceived=0,this.charLength=0}function oc(t){return t.toString(this.encoding)}function sc(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function ac(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}ic.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(t=t.slice(n,t.length),!((i=(e=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(e.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var r=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,r),r-=this.charReceived);var i;r=(e+=t.toString(this.encoding,0,r)).length-1;if((i=e.charCodeAt(r))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,r)}return e},ic.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(e<=2&&n>>4==14){this.charLength=3;break}if(e<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=e},ic.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;e+=r.slice(0,n).toString(i)}return e},hc.ReadableState=cc;var uc=Ja("stream");function cc(t,e){t=t||{},this.objectMode=!!t.objectMode,e instanceof Uc&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.buffer=new nc,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(this.decoder=new ic(t.encoding),this.encoding=t.encoding)}function hc(t){if(!(this instanceof hc))return new hc(t);this._readableState=new cc(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),Gu.call(this)}function fc(t,e,n,r,i){var o=function(t,e){var n=null;qa(e)||"string"==typeof e||null==e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(e,n);if(o)t.emit("error",o);else if(null===n)e.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,pc(t)}(t,e);else if(e.objectMode||n&&n.length>0)if(e.ended&&!i){var s=new Error("stream.push() after EOF");t.emit("error",s)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else{var u;!e.decoder||i||r||(n=e.decoder.write(n),u=!e.objectMode&&0===n.length),i||(e.reading=!1),u||(e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&pc(t))),function(t,e){e.readingMore||(e.readingMore=!0,yn(vc,t,e))}(t,e)}else i||(e.reading=!1);return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(e)}$a(hc,Gu),hc.prototype.push=function(t,e){var n=this._readableState;return n.objectMode||"string"!=typeof t||(e=e||n.defaultEncoding)!==n.encoding&&(t=oa.from(t,e),e=""),fc(this,n,t,e,!1)},hc.prototype.unshift=function(t){return fc(this,this._readableState,t,"",!0)},hc.prototype.isPaused=function(){return!1===this._readableState.flowing},hc.prototype.setEncoding=function(t){return this._readableState.decoder=new ic(t),this._readableState.encoding=t,this};function lc(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=8388608?t=8388608:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function pc(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(uc("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?yn(dc,t):dc(t))}function dc(t){uc("emit readable"),t.emit("readable"),mc(t)}function vc(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(uc("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function yc(t){uc("readable nexttick read 0"),t.read(0)}function gc(t,e){e.reading||(uc("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),mc(t),e.flowing&&!e.reading&&t.read(0)}function mc(t){var e=t._readableState;for(uc("flow",e.flowing);e.flowing&&null!==t.read(););}function wc(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;t-=i.length;for(;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),0===(t-=s)){s===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=oa.allocUnsafe(t),r=e.head,i=1;r.data.copy(n),t-=r.data.length;for(;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,s),0===(t-=s)){s===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++i}return e.length-=i,n}(t,e);return r}(t,e.buffer,e.decoder),n);var n}function bc(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,yn(Ec,e,t))}function Ec(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function _c(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function Ic(){}function Tc(t,e,n){this.chunk=t,this.encoding=e,this.callback=n,this.next=null}function Ac(t,e){Object.defineProperty(this,"buffer",{get:Ha((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),t=t||{},this.objectMode=!!t.objectMode,e instanceof Uc&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===t.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){--e.pendingcb,n?yn(i,r):i(r);t._writableState.errorEmitted=!0,t.emit("error",r)}(t,n,r,e,i);else{var o=Dc(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||Rc(t,n),r?yn(kc,t,n,o,i):kc(t,n,o,i)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Cc(this)}function Nc(t){if(!(this instanceof Nc||this instanceof Uc))return new Nc(t);this._writableState=new Ac(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),Gu.call(this)}function Sc(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function kc(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),xc(t,e)}function Rc(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var s=0;n;)i[s]=n,n=n.next,s+=1;Sc(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new Cc(e)}else{for(;n;){var a=n.chunk,u=n.encoding,c=n.callback;if(Sc(t,e,!1,e.objectMode?1:a.length,a,u,c),n=n.next,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=n,e.bufferProcessing=!1}function Dc(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function Oc(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function xc(t,e){var n=Dc(e);return n&&(0===e.pendingcb?(Oc(t,e),e.finished=!0,t.emit("finish")):Oc(t,e)),n}function Cc(t){var e=this;this.next=null,this.entry=null,this.finish=function(n){var r=e.entry;for(e.entry=null;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}}hc.prototype.read=function(t){uc("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return uc("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?bc(this):pc(this),null;if(0===(t=lc(t,e))&&e.ended)return 0===e.length&&bc(this),null;var r,i=e.needReadable;return uc("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&uc("length less than watermark",i=!0),e.ended||e.reading?uc("reading or ended",i=!1):i&&(uc("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=lc(n,e))),null===(r=t>0?wc(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&bc(this)),null!==r&&this.emit("data",r),r},hc.prototype._read=function(t){this.emit("error",new Error("not implemented"))},hc.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t)}r.pipesCount+=1,uc("pipe count=%d opts=%j",r.pipesCount,e);var i=!e||!1!==e.end?s:c;function o(t){uc("onunpipe"),t===n&&c()}function s(){uc("onend"),t.end()}r.endEmitted?yn(i):n.once("end",i),t.on("unpipe",o);var a=function(t){return function(){var e=t._readableState;uc("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&t.listeners("data").length&&(e.flowing=!0,mc(t))}}(n);t.on("drain",a);var u=!1;function c(){uc("cleanup"),t.removeListener("close",p),t.removeListener("finish",d),t.removeListener("drain",a),t.removeListener("error",l),t.removeListener("unpipe",o),n.removeListener("end",s),n.removeListener("end",c),n.removeListener("data",f),u=!0,!r.awaitDrain||t._writableState&&!t._writableState.needDrain||a()}var h=!1;function f(e){uc("ondata"),h=!1,!1!==t.write(e)||h||((1===r.pipesCount&&r.pipes===t||r.pipesCount>1&&-1!==_c(r.pipes,t))&&!u&&(uc("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,h=!0),n.pause())}function l(e){var n;uc("onerror",e),v(),t.removeListener("error",l),0===(n="error",t.listeners(n).length)&&t.emit("error",e)}function p(){t.removeListener("finish",d),v()}function d(){uc("onfinish"),t.removeListener("close",p),v()}function v(){uc("unpipe"),n.unpipe(t)}return n.on("data",f),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",l),t.once("close",p),t.once("finish",d),t.emit("pipe",n),r.flowing||(uc("pipe resume"),n.resume()),t},hc.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this)),this;if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var o=_c(e.pipes,t);return-1===o||(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this)),this},hc.prototype.on=function(t,e){var n=Gu.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&pc(this):yn(yc,this))}return n},hc.prototype.addListener=hc.prototype.on,hc.prototype.resume=function(){var t=this._readableState;return t.flowing||(uc("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,yn(gc,t,e))}(this,t)),this},hc.prototype.pause=function(){return uc("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(uc("pause"),this._readableState.flowing=!1,this.emit("pause")),this},hc.prototype.wrap=function(t){var e=this._readableState,n=!1,r=this;for(var i in t.on("end",(function(){if(uc("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&r.push(t)}r.push(null)})),t.on("data",(function(i){(uc("wrapped data"),e.decoder&&(i=e.decoder.write(i)),e.objectMode&&null==i)||(e.objectMode||i&&i.length)&&(r.push(i)||(n=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));return function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}(["error","close","destroy","pause","resume"],(function(e){t.on(e,r.emit.bind(r,e))})),r._read=function(e){uc("wrapped _read",e),n&&(n=!1,t.resume())},r},hc._fromList=wc,Nc.WritableState=Ac,$a(Nc,Gu),Ac.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},Nc.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Nc.prototype.write=function(t,e,n){var r=this._writableState,i=!1;return"function"==typeof e&&(n=e,e=null),oa.isBuffer(t)?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=Ic),r.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),yn(e,n)}(this,n):function(t,e,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):oa.isBuffer(n)||"string"==typeof n||void 0===n||e.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),yn(r,o),i=!1),i}(this,r,t,n)&&(r.pendingcb++,i=function(t,e,n,r,i){n=function(t,e,n){t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=oa.from(e,n));return e}(e,n,r),oa.isBuffer(n)&&(r="buffer");var o=e.objectMode?1:n.length;e.length+=o;var s=e.length<e.highWaterMark;s||(e.needDrain=!0);if(e.writing||e.corked){var a=e.lastBufferedRequest;e.lastBufferedRequest=new Tc(n,r,i),a?a.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else Sc(t,e,!1,o,n,r,i);return s}(this,r,t,e,n)),i},Nc.prototype.cork=function(){this._writableState.corked++},Nc.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||Rc(this,t))},Nc.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Nc.prototype._write=function(t,e,n){n(new Error("not implemented"))},Nc.prototype._writev=null,Nc.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,xc(t,e),n&&(e.finished?yn(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,r,n)},$a(Uc,hc);for(var Pc=Object.keys(Nc.prototype),Lc=0;Lc<Pc.length;Lc++){var Mc=Pc[Lc];Uc.prototype[Mc]||(Uc.prototype[Mc]=Nc.prototype[Mc])}function Uc(t){if(!(this instanceof Uc))return new Uc(t);hc.call(this,t),Nc.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",jc)}function jc(){this.allowHalfOpen||this._writableState.ended||yn(Bc,this)}function Bc(t){t.end()}function Fc(t){this.afterTransform=function(e,n){return function(t,e,n){var r=t._transformState;r.transforming=!1;var i=r.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!=n&&t.push(n);i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Vc(t){if(!(this instanceof Vc))return new Vc(t);Uc.call(this,t),this._transformState=new Fc(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(t){qc(e,t)})):qc(e)}))}function qc(t,e){if(e)return t.emit("error",e);var n=t._writableState,r=t._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}function zc(t){if(!(this instanceof zc))return new zc(t);Vc.call(this,t)}function Gc(){Gu.call(this)}function $c(t){return Object.prototype.toString.call(t)}$a(Vc,Uc),Vc.prototype.push=function(t,e){return this._transformState.needTransform=!1,Uc.prototype.push.call(this,t,e)},Vc.prototype._transform=function(t,e,n){throw new Error("Not implemented")},Vc.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},Vc.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},$a(zc,Vc),zc.prototype._transform=function(t,e,n){n(null,t)},$a(Gc,Gu),Gc.Readable=hc,Gc.Writable=Nc,Gc.Duplex=Uc,Gc.Transform=Vc,Gc.PassThrough=zc,Gc.Stream=Gc,Gc.prototype.pipe=function(t,e){var n=this;function r(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),t.on("drain",i),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",a));var o=!1;function s(){o||(o=!0,t.end())}function a(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(c(),0===Gu.listenerCount(this,"error"))throw t}function c(){n.removeListener("data",r),t.removeListener("drain",i),n.removeListener("end",s),n.removeListener("close",a),n.removeListener("error",u),t.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),t.removeListener("close",c)}return n.on("error",u),t.on("error",u),n.on("end",c),n.on("close",c),t.on("close",c),t.emit("pipe",n),t};var Wc={isArray:function(t){return Array.isArray?Array.isArray(t):"[object Array]"===$c(t)},isBoolean:function(t){return"boolean"==typeof t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t},isNumber:function(t){return"number"==typeof t},isString:function(t){return"string"==typeof t},isSymbol:function(t){return"symbol"==typeof t},isUndefined:function(t){return void 0===t},isRegExp:function(t){return"[object RegExp]"===$c(t)},isObject:function(t){return"object"==typeof t&&null!==t},isDate:function(t){return"[object Date]"===$c(t)},isError:function(t){return"[object Error]"===$c(t)||t instanceof Error},isFunction:function(t){return"function"==typeof t},isPrimitive:function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},isBuffer:qa},Yc=gt((function(t){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}})),Hc=Object.freeze({__proto__:null,default:{}}),Qc=Zc,Kc=Ga.Buffer;function Jc(t,e,n){this.chunk=t,this.encoding=e,this.callback=n}function Xc(t,e){var n=sh,r=(t=t||{}).highWaterMark,i=t.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.objectMode=!!t.objectMode,e instanceof n&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,i){n?yn((function(){e.pendingcb--,i(r)})):(e.pendingcb--,i(r));t._writableState.errorEmitted=!0,t.emit("error",r)}(t,n,r,e,i);else{var o=rh(t,n);o||n.corked||n.bufferProcessing||!n.buffer.length||nh(t,n),r?yn((function(){eh(t,n,o,i)})):eh(t,n,o,i)}}(e,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function Zc(t){if(!(this instanceof Zc||this instanceof sh))return new Zc(t);this._writableState=new Xc(t,this),this.writable=!0,Gc.call(this)}function th(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function eh(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),oh(t,e)}function nh(t,e){if(e.bufferProcessing=!0,t._writev&&e.buffer.length>1){for(var n=[],r=0;r<e.buffer.length;r++)n.push(e.buffer[r].callback);e.pendingcb++,th(t,e,!0,e.length,e.buffer,"",(function(t){for(var r=0;r<n.length;r++)e.pendingcb--,n[r](t)})),e.buffer=[]}else{for(r=0;r<e.buffer.length;r++){var i=e.buffer[r],o=i.chunk,s=i.encoding,a=i.callback,u=e.objectMode?1:o.length;if(th(t,e,!1,u,o,s,a),e.writing){r++;break}}r<e.buffer.length?e.buffer=e.buffer.slice(r):e.buffer.length=0}e.bufferProcessing=!1}function rh(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function ih(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function oh(t,e){var n=rh(0,e);return n&&(0===e.pendingcb?(ih(t,e),e.finished=!0,t.emit("finish")):ih(t,e)),n}Zc.WritableState=Xc,Wc.inherits=Yc,Wc.inherits(Zc,Gc),Zc.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},Zc.prototype.write=function(t,e,n){var r=this._writableState,i=!1;return Wc.isFunction(e)&&(n=e,e=null),Wc.isBuffer(t)?e="buffer":e||(e=r.defaultEncoding),Wc.isFunction(n)||(n=function(){}),r.ended?function(t,e,n){var r=new Error("write after end");t.emit("error",r),yn((function(){n(r)}))}(this,0,n):function(t,e,n,r){var i=!0;if(!(Wc.isBuffer(n)||Wc.isString(n)||Wc.isNullOrUndefined(n)||e.objectMode)){var o=new TypeError("Invalid non-string/buffer chunk");t.emit("error",o),yn((function(){r(o)})),i=!1}return i}(this,r,t,n)&&(r.pendingcb++,i=function(t,e,n,r,i){n=function(t,e,n){!t.objectMode&&!1!==t.decodeStrings&&Wc.isString(e)&&(e=new Kc(e,n));return e}(e,n,r),Wc.isBuffer(n)&&(r="buffer");var o=e.objectMode?1:n.length;e.length+=o;var s=e.length<e.highWaterMark;s||(e.needDrain=!0);e.writing||e.corked?e.buffer.push(new Jc(n,r,i)):th(t,e,!1,o,n,r,i);return s}(this,r,t,e,n)),i},Zc.prototype.cork=function(){this._writableState.corked++},Zc.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.buffer.length||nh(this,t))},Zc.prototype._write=function(t,e,n){n(new Error("not implemented"))},Zc.prototype._writev=null,Zc.prototype.end=function(t,e,n){var r=this._writableState;Wc.isFunction(t)?(n=t,t=null,e=null):Wc.isFunction(e)&&(n=e,e=null),Wc.isNullOrUndefined(t)||this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,oh(t,e),n&&(e.finished?yn(n):t.once("finish",n));e.ended=!0}(this,r,n)};var sh=uh,ah=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};function uh(t){if(!(this instanceof uh))return new uh(t);lh.call(this,t),Qc.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",ch)}function ch(){this.allowHalfOpen||this._writableState.ended||yn(this.end.bind(this))}Wc.inherits=Yc,Wc.inherits(uh,lh),function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}(ah(Qc.prototype),(function(t){uh.prototype[t]||(uh.prototype[t]=Qc.prototype[t])}));var hh=gt((function(t,e){var n=Ga.Buffer,r=n.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};var i=e.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!r(t))throw new Error("Unknown encoding: "+t)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=s;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=o)}this.charBuffer=new n(6),this.charReceived=0,this.charLength=0};function o(t){return t.toString(this.encoding)}function s(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function a(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}i.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(t=t.slice(n,t.length),!((i=(e=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(e.length-1))>=55296&&i<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var r=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,r),r-=this.charReceived);var i;r=(e+=t.toString(this.encoding,0,r)).length-1;if((i=e.charCodeAt(r))>=55296&&i<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,r)}return e},i.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(e<=2&&n>>4==14){this.charLength=3;break}if(e<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=e},i.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;e+=r.slice(0,n).toString(i)}return e}})),fh=(hh.StringDecoder,mt(Hc)),lh=mh,ph=Ga.Buffer;mh.ReadableState=gh;var dh,vh=Gu.EventEmitter;vh.listenerCount||(vh.listenerCount=function(t,e){return t.listeners(e).length}),Wc.inherits=Yc;var yh=fh;function gh(t,e){var n=sh,r=(t=t||{}).highWaterMark,i=t.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!t.objectMode,e instanceof n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(dh||(dh=hh.StringDecoder),this.decoder=new dh(t.encoding),this.encoding=t.encoding)}function mh(t){if(!(this instanceof mh))return new mh(t);this._readableState=new gh(t,this),this.readable=!0,Gc.call(this)}function wh(t,e,n,r,i){var o=function(t,e){var n=null;Wc.isBuffer(e)||Wc.isString(e)||Wc.isNullOrUndefined(e)||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(e,n);if(o)t.emit("error",o);else if(Wc.isNullOrUndefined(n))e.reading=!1,e.ended||function(t,e){if(e.decoder&&!e.ended){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,Eh(t)}(t,e);else if(e.objectMode||n&&n.length>0)if(e.ended&&!i){var s=new Error("stream.push() after EOF");t.emit("error",s)}else if(e.endEmitted&&i){s=new Error("stream.unshift() after end event");t.emit("error",s)}else!e.decoder||i||r||(n=e.decoder.write(n)),i||(e.reading=!1),e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&Eh(t)),function(t,e){e.readingMore||(e.readingMore=!0,yn((function(){!function(t,e){var n=e.length;for(;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(yh("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}(t,e)})))}(t,e);else i||(e.reading=!1);return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(e)}yh=yh&&yh.debuglog?yh.debuglog("stream"):function(){},Wc.inherits(mh,Gc),mh.prototype.push=function(t,e){var n=this._readableState;return Wc.isString(t)&&!n.objectMode&&(e=e||n.defaultEncoding)!==n.encoding&&(t=new ph(t,e),e=""),wh(this,n,t,e,!1)},mh.prototype.unshift=function(t){return wh(this,this._readableState,t,"",!0)},mh.prototype.setEncoding=function(t){return dh||(dh=hh.StringDecoder),this._readableState.decoder=new dh(t),this._readableState.encoding=t,this};function bh(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||Wc.isNull(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:t<=0?0:(t>e.highWaterMark&&(e.highWaterMark=function(t){if(t>=8388608)t=8388608;else{t--;for(var e=1;e<32;e<<=1)t|=t>>e;t++}return t}(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function Eh(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(yh("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?yn((function(){_h(t)})):_h(t))}function _h(t){yh("emit readable"),t.emit("readable"),Ih(t)}function Ih(t){var e=t._readableState;if(yh("flow",e.flowing),e.flowing)do{var n=t.read()}while(null!==n&&e.flowing)}function Th(t,e){var n,r=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!t||t>=i)n=o?r.join(""):ph.concat(r,i),r.length=0;else{if(t<r[0].length)n=(h=r[0]).slice(0,t),r[0]=h.slice(t);else if(t===r[0].length)n=r.shift();else{n=o?"":new ph(t);for(var a=0,u=0,c=r.length;u<c&&a<t;u++){var h=r[0],f=Math.min(t-a,h.length);o?n+=h.slice(0,f):h.copy(n,a,0,f),f<h.length?r[0]=h.slice(f):r.shift(),a+=f}}}return n}function Ah(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");e.endEmitted||(e.ended=!0,yn((function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))})))}mh.prototype.read=function(t){yh("read",t);var e=this._readableState,n=t;if((!Wc.isNumber(t)||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return yh("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?Ah(this):Eh(this),null;if(0===(t=bh(t,e))&&e.ended)return 0===e.length&&Ah(this),null;var r,i=e.needReadable;return yh("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&yh("length less than watermark",i=!0),(e.ended||e.reading)&&yh("reading or ended",i=!1),i&&(yh("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),i&&!e.reading&&(t=bh(n,e)),r=t>0?Th(t,e):null,Wc.isNull(r)&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),n!==t&&e.ended&&0===e.length&&Ah(this),Wc.isNull(r)||this.emit("data",r),r},mh.prototype._read=function(t){this.emit("error",new Error("not implemented"))},mh.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t)}r.pipesCount+=1,yh("pipe count=%d opts=%j",r.pipesCount,e);var i=(!e||!1!==e.end)&&t!==Dn.stdout&&t!==Dn.stderr?s:u;function o(t){yh("onunpipe"),t===n&&u()}function s(){yh("onend"),t.end()}r.endEmitted?yn(i):n.once("end",i),t.on("unpipe",o);var a=function(t){return function(){var e=t._readableState;yh("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&vh.listenerCount(t,"data")&&(e.flowing=!0,Ih(t))}}(n);function u(){yh("cleanup"),t.removeListener("close",f),t.removeListener("finish",l),t.removeListener("drain",a),t.removeListener("error",h),t.removeListener("unpipe",o),n.removeListener("end",s),n.removeListener("end",u),n.removeListener("data",c),!r.awaitDrain||t._writableState&&!t._writableState.needDrain||a()}function c(e){yh("ondata"),!1===t.write(e)&&(yh("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,n.pause())}function h(e){yh("onerror",e),p(),t.removeListener("error",h),0===vh.listenerCount(t,"error")&&t.emit("error",e)}function f(){t.removeListener("finish",l),p()}function l(){yh("onfinish"),t.removeListener("close",f),p()}function p(){yh("unpipe"),n.unpipe(t)}return t.on("drain",a),n.on("data",c),t._events&&t._events.error?ec(t._events.error)?t._events.error.unshift(h):t._events.error=[h,t._events.error]:t.on("error",h),t.once("close",f),t.once("finish",l),t.emit("pipe",n),r.flowing||(yh("pipe resume"),n.resume()),t},mh.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this)),this;if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}return-1===(i=function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}(e.pipes,t))||(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this)),this},mh.prototype.on=function(t,e){var n=Gc.prototype.on.call(this,t,e);if("data"===t&&!1!==this._readableState.flowing&&this.resume(),"readable"===t&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&Eh(this);else{var i=this;yn((function(){yh("readable nexttick read 0"),i.read(0)}))}}return n},mh.prototype.addListener=mh.prototype.on,mh.prototype.resume=function(){var t=this._readableState;return t.flowing||(yh("resume"),t.flowing=!0,t.reading||(yh("resume read 0"),this.read(0)),function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,yn((function(){!function(t,e){e.resumeScheduled=!1,t.emit("resume"),Ih(t),e.flowing&&!e.reading&&t.read(0)}(t,e)})))}(this,t)),this},mh.prototype.pause=function(){return yh("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(yh("pause"),this._readableState.flowing=!1,this.emit("pause")),this},mh.prototype.wrap=function(t){var e=this._readableState,n=!1,r=this;for(var i in t.on("end",(function(){if(yh("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&r.push(t)}r.push(null)})),t.on("data",(function(i){(yh("wrapped data"),e.decoder&&(i=e.decoder.write(i)),i&&(e.objectMode||i.length))&&(r.push(i)||(n=!0,t.pause()))})),t)Wc.isFunction(t[i])&&Wc.isUndefined(this[i])&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));return function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n)}(["error","close","destroy","pause","resume"],(function(e){t.on(e,r.emit.bind(r,e))})),r._read=function(e){yh("wrapped _read",e),n&&(n=!1,t.resume())},r},mh._fromList=Th;var Nh=kh;function Sh(t,e){this.afterTransform=function(t,n){return function(t,e,n){var r=t._transformState;r.transforming=!1;var i=r.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,Wc.isNullOrUndefined(n)||t.push(n);i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function kh(t){if(!(this instanceof kh))return new kh(t);sh.call(this,t),this._transformState=new Sh(t,this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",(function(){Wc.isFunction(this._flush)?this._flush((function(t){Rh(e,t)})):Rh(e)}))}function Rh(t,e){if(e)return t.emit("error",e);var n=t._writableState,r=t._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}Wc.inherits=Yc,Wc.inherits(kh,sh),kh.prototype.push=function(t,e){return this._transformState.needTransform=!1,sh.prototype.push.call(this,t,e)},kh.prototype._transform=function(t,e,n){throw new Error("not implemented")},kh.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},kh.prototype._read=function(t){var e=this._transformState;Wc.isNull(e.writechunk)||!e.writecb||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))};var Dh=Oh;function Oh(t){if(!(this instanceof Oh))return new Oh(t);Nh.call(this,t)}Wc.inherits=Yc,Wc.inherits(Oh,Nh),Oh.prototype._transform=function(t,e,n){n(null,t)};var xh=gt((function(t,e){(e=t.exports=lh).Stream=Gc,e.Readable=e,e.Writable=Qc,e.Duplex=sh,e.Transform=Nh,e.PassThrough=Dh}));xh.Stream,xh.Readable,xh.Writable,xh.Duplex,xh.Transform,xh.PassThrough;var Ch=function(t,e){var n,r,i,o,s;function a(t,e,r,i,o){n[e][0]-=t*(n[e][0]-r)/1024,n[e][1]-=t*(n[e][1]-i)/1024,n[e][2]-=t*(n[e][2]-o)/1024}function u(t,e,r,i,o){for(var a,u,c=Math.abs(e-t),h=Math.min(e+t,256),f=e+1,l=e-1,p=1;f<h||l>c;)u=s[p++],f<h&&((a=n[f++])[0]-=u*(a[0]-r)/(1<<18),a[1]-=u*(a[1]-i)/(1<<18),a[2]-=u*(a[2]-o)/(1<<18)),l>c&&((a=n[l--])[0]-=u*(a[0]-r)/(1<<18),a[1]-=u*(a[1]-i)/(1<<18),a[2]-=u*(a[2]-o)/(1<<18))}function c(t,e,r){var s,a,u,c,h,f=~(1<<31),l=f,p=-1,d=p;for(s=0;s<256;s++)a=n[s],(u=Math.abs(a[0]-t)+Math.abs(a[1]-e)+Math.abs(a[2]-r))<f&&(f=u,p=s),(c=u-(i[s]>>12))<l&&(l=c,d=s),h=o[s]>>10,o[s]-=h,i[s]+=h<<10;return o[p]+=64,i[p]-=65536,d}this.buildColormap=function(){!function(){var t,e;for(n=[],r=new Int32Array(256),i=new Int32Array(256),o=new Int32Array(256),s=new Int32Array(32),t=0;t<256;t++)e=(t<<12)/256,n[t]=new Float64Array([e,e,e,0]),o[t]=256,i[t]=0}(),function(){var n,r,i,o,h,f,l=t.length,p=30+(e-1)/3,d=l/(3*e),v=~~(d/100),y=1024,g=2048,m=g>>6;for(m<=1&&(m=0),n=0;n<m;n++)s[n]=y*(256*(m*m-n*n)/(m*m));l<1509?(e=1,r=3):r=l%499!=0?1497:l%491!=0?1473:l%487!=0?1461:1509;var w=0;for(n=0;n<d;)if(a(y,f=c(i=(255&t[w])<<4,o=(255&t[w+1])<<4,h=(255&t[w+2])<<4),i,o,h),0!==m&&u(m,f,i,o,h),(w+=r)>=l&&(w-=l),0===v&&(v=1),++n%v==0)for(y-=y/p,(m=(g-=g/30)>>6)<=1&&(m=0),f=0;f<m;f++)s[f]=y*(256*(m*m-f*f)/(m*m))}(),function(){for(var t=0;t<256;t++)n[t][0]>>=4,n[t][1]>>=4,n[t][2]>>=4,n[t][3]=t}(),function(){var t,e,i,o,s,a,u=0,c=0;for(t=0;t<256;t++){for(s=t,a=(i=n[t])[1],e=t+1;e<256;e++)(o=n[e])[1]<a&&(s=e,a=o[1]);if(o=n[s],t!=s&&(e=o[0],o[0]=i[0],i[0]=e,e=o[1],o[1]=i[1],i[1]=e,e=o[2],o[2]=i[2],i[2]=e,e=o[3],o[3]=i[3],i[3]=e),a!=u){for(r[u]=c+t>>1,e=u+1;e<a;e++)r[e]=t;u=a,c=t}}for(r[u]=c+255>>1,e=u+1;e<256;e++)r[e]=255}()},this.getColormap=function(){for(var t=[],e=[],r=0;r<256;r++)e[n[r][3]]=r;for(var i=0,o=0;o<256;o++){var s=e[o];t[i++]=n[s][0],t[i++]=n[s][1],t[i++]=n[s][2]}return t},this.lookupRGB=function(t,e,i){for(var o,s,a,u=1e3,c=-1,h=r[e],f=h-1;h<256||f>=0;)h<256&&((a=(s=n[h])[1]-e)>=u?h=256:(h++,a<0&&(a=-a),(o=s[0]-t)<0&&(o=-o),(a+=o)<u&&((o=s[2]-i)<0&&(o=-o),(a+=o)<u&&(u=a,c=s[3])))),f>=0&&((a=e-(s=n[f])[1])>=u?f=-1:(f--,a<0&&(a=-a),(o=s[0]-t)<0&&(o=-o),(a+=o)<u&&((o=s[2]-i)<0&&(o=-o),(a+=o)<u&&(u=a,c=s[3]))));return c}},Ph=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];var Lh=function(t,e,n,r){var i,o,s,a,u,c,h,f,l,p=Math.max(2,r),d=new Uint8Array(256),v=new Int32Array(5003),y=new Int32Array(5003),g=0,m=0,w=!1;function b(t,e){d[o++]=t,o>=254&&I(e)}function E(t){_(5003),m=f+2,w=!0,N(f,t)}function _(t){for(var e=0;e<t;++e)v[e]=-1}function I(t){o>0&&(t.writeByte(o),t.writeBytes(d,0,o),o=0)}function T(t){return(1<<t)-1}function A(){return 0===a?-1:(--a,255&n[u++])}function N(t,e){for(i&=Ph[g],g>0?i|=t<<g:i=t,g+=c;g>=8;)b(255&i,e),i>>=8,g-=8;if((m>s||w)&&(w?(s=T(c=h),w=!1):(++c,s=12==c?4096:T(c))),t==l){for(;g>0;)b(255&i,e),i>>=8,g-=8;I(e)}}this.encode=function(n){n.writeByte(p),a=t*e,u=0,function(t,e){var n,r,i,a,u,p;for(w=!1,s=T(c=h=t),l=(f=1<<t-1)+1,m=f+2,o=0,a=A(),p=0,n=5003;n<65536;n*=2)++p;p=8-p,_(5003),N(f,e);t:for(;-1!=(r=A());)if(n=(r<<12)+a,v[i=r<<p^a]!==n){if(v[i]>=0){u=5003-i,0===i&&(u=1);do{if((i-=u)<0&&(i+=5003),v[i]===n){a=y[i];continue t}}while(v[i]>=0)}N(a,e),a=r,m<4096?(y[i]=m++,v[i]=n):E(e)}else a=y[i];N(a,e),N(l,e)}(p+1,n),n.writeByte(0)}};function Mh(t){xh.call(this,t),this.okayToPush=!0,this.resetData()}function Uh(t,e,n){var r=(n=n||{}).highWaterMark;Mh.call(this,{highWaterMark:r||0===r?r:65536}),this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.userPalette=null,this.usedEntry=[],this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10;var i=this;function o(){i.flushData()}this.on("writeHeader#stop",o),this.on("frame#stop",o),this.on("finish#stop",(function(){o(),i.push(null)}))}_u.inherits(Mh,xh),Mh.prototype._read=function(){this.okayToPush=!0},Mh.prototype.resetData=function(){this.data=[]},Mh.prototype.flushData=function(){if(!this.okayToPush){var t=new Error("GIF memory limit exceeded. Please `read` from GIF before writing additional frames/information.");return this.emit("error",t)}var e=new oa(this.data);this.resetData(),this.okayToPush=this.push(e)},Mh.prototype.writeByte=function(t){this.data.push(t)},Mh.prototype.writeUTFBytes=function(t){for(var e=t.length,n=0;n<e;n++)this.writeByte(t.charCodeAt(n))},Mh.prototype.writeBytes=function(t,e,n){for(var r=n||t.length,i=e||0;i<r;i++)this.writeByte(t[i])},_u.inherits(Uh,Mh),Uh.prototype.setDelay=function(t){this.delay=Math.round(t/10)},Uh.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},Uh.prototype.setDispose=function(t){t>=0&&(this.dispose=t)},Uh.prototype.setRepeat=function(t){this.repeat=t},Uh.prototype.setTransparent=function(t){this.transparent=t},Uh.prototype.analyzeImage=function(t,e){e&&e.palette&&this.setImagePalette(this.removeAlphaChannel(e.palette)),e&&!0===e.indexedPixels?(Ou(e.palette,"`options.indexedPixels` requires `options.palette` to load from. Please include one`"),this.setImagePixels(t)):this.setImagePixels(this.removeAlphaChannel(t)),this.analyzePixels(e),e&&e.palette&&(this.userPalette=null)},Uh.prototype.writeImageInfo=function(){this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.writePalette(),this.firstFrame=!1},Uh.prototype.outputImage=function(){this.writePixels()},Uh.prototype.addFrame=function(t,e){this.emit("frame#start"),this.analyzeImage(t,e),this.writeImageInfo(),this.outputImage(),this.emit("frame#stop")},Uh.prototype.finish=function(){this.emit("finish#start"),this.writeByte(59),this.emit("finish#stop")},Uh.prototype.setQuality=function(t){t<1&&(t=1),this.sample=t},Uh.prototype.writeHeader=function(){this.emit("writeHeader#start"),this.writeUTFBytes("GIF89a"),this.emit("writeHeader#stop")},Uh.prototype.analyzePixels=function(t){var e,n,r;if(null!==this.userPalette){Ou(t&&!0===t.indexedPixels,"`palette` can only be used with `options.indexedPixels` at the moment. Please add `{indexedPixels: true}` to `addFrame()`"),e=this.pixels.length,this.indexedPixels=new Uint8Array(e),this.colorTab=this.userPalette;for(var i=0;i<e;i++)n=this.pixels[i],this.indexedPixels[i]=n,this.usedEntry[n]=!0}else{e=this.pixels.length/3,this.indexedPixels=new Uint8Array(e),(r=new Ch(this.pixels,this.sample)).buildColormap(),this.colorTab=r.getColormap();for(var o=0,s=0;s<e;s++)n=r.lookupRGB(255&this.pixels[o++],255&this.pixels[o++],255&this.pixels[o++]),this.usedEntry[n]=!0,this.indexedPixels[s]=n}this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent?this.transIndex=r.lookupRGB((16711680&this.transparent)>>16,(65280&this.transparent)>>8,255&this.transparent):this.transIndex=0},Uh.prototype.removeAlphaChannel=function(t){for(var e=this.width,n=this.height,r=new Uint8Array(e*n*3),i=0,o=0;o<n;o++)for(var s=0;s<e;s++){var a=o*e*4+4*s;r[i++]=t[a],r[i++]=t[a+1],r[i++]=t[a+2]}return r},Uh.prototype.setImagePixels=function(t){this.pixels=t},Uh.prototype.setImagePalette=function(t){this.userPalette=t},Uh.prototype.writeGraphicCtrlExt=function(){var t,e;this.writeByte(33),this.writeByte(249),this.writeByte(4),null===this.transparent?(t=0,e=0):(t=1,e=2),this.dispose>=0&&(e=7&this.dispose),e<<=2,this.writeByte(0|e|t),this.writeShort(this.delay),this.writeByte(this.transIndex),this.writeByte(0)},Uh.prototype.writeImageDesc=function(){this.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame?this.writeByte(0):this.writeByte(128|this.palSize)},Uh.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.writeByte(240|this.palSize),this.writeByte(0),this.writeByte(0)},Uh.prototype.writeNetscapeExt=function(){this.writeByte(33),this.writeByte(255),this.writeByte(11),this.writeUTFBytes("NETSCAPE2.0"),this.writeByte(3),this.writeByte(1),this.writeShort(this.repeat),this.writeByte(0)},Uh.prototype.writePalette=function(){this.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.writeByte(0)},Uh.prototype.writeShort=function(t){this.writeByte(255&t),this.writeByte(t>>8&255)},Uh.prototype.writePixels=function(){new Lh(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this)},Uh.prototype.stream=function(){return this},Uh.ByteCapacitor=Mh;var jh=Uh;function Bh(e){let n,r,i,o,s,a;return{c(){n=b("div"),r=b("img"),o=_(),s=b("button"),s.textContent="Save  ▿",A(r,"class","image svelte-24r3ug"),r.src!==(i=e[0])&&A(r,"src",i),A(r,"alt",""),A(s,"class","download svelte-24r3ug"),A(s,"type","button"),A(n,"class","filmstrip svelte-24r3ug")},m(t,i,u){m(t,n,i),g(n,r),e[3](r),g(n,o),g(n,s),u&&a(),a=T(s,"click",e[2])},p(t,[e]){1&e&&r.src!==(i=t[0])&&A(r,"src",i)},i:t,o:t,d(t){t&&w(n),e[3](null),a()}}}function Fh(t,e,n){let r,{src:i}=e;return t.$set=t=>{"src"in t&&n(0,i=t.src)},[i,r,function(){console.log("handleDownloadClick()"),function(t){const e=document.createElement("canvas");e.width=200,e.height=150;const n=e.getContext("2d");new Promise(e=>{const r=new jh(200,150,{highWaterMark:128e3});r.writeHeader(),r.setDelay(100),r.setRepeat(0);for(let e=0;e<20;e++){n.drawImage(t,0,150*e,200,150,0,0,200,150);const i=n.getImageData(0,0,200,150);r.addFrame(i.data)}r.on("readable",(function(){const t=r.read(),e=new Blob([t],{type:"image/gif"}),n=window.URL.createObjectURL(e),i=document.createElement("a");i.href=n,i.download=Date.now()+".gif";const o=new MouseEvent("click");i.dispatchEvent(o),setTimeout(()=>window.URL.revokeObjectURL(n),100)})),r.finish(),e(r)})}(r)},function(t){B[t?"unshift":"push"](()=>{n(1,r=t)})}]}class Vh extends ft{constructor(t){super(),ht(this,t,Fh,Bh,a,{src:0})}}function qh(t){let e,n,r,i,o,s;const a=new Vh({props:{src:t[0]}});return{c(){e=b("div"),n=b("div"),st(a.$$.fragment),r=_(),i=b("div"),o=E(t[1]),A(n,"class","image svelte-1tl1wq7"),A(i,"class","text svelte-1tl1wq7"),A(e,"class","message svelte-1tl1wq7")},m(t,u){m(t,e,u),g(e,n),at(a,n,null),g(e,r),g(e,i),g(i,o),s=!0},p(t,[e]){const n={};1&e&&(n.src=t[0]),a.$set(n),(!s||2&e)&&function(t,e){e=""+e,t.data!==e&&(t.data=e)}(o,t[1])},i(t){s||(nt(a.$$.fragment,t),s=!0)},o(t){rt(a.$$.fragment,t),s=!1},d(t){t&&w(e),ut(a)}}}function zh(t,e,n){let{imageBlob:r}=e,{text:i}=e;return t.$set=t=>{"imageBlob"in t&&n(0,r=t.imageBlob),"text"in t&&n(1,i=t.text)},[r,i]}class Gh extends ft{constructor(t){super(),ht(this,t,zh,qh,a,{imageBlob:0,text:1})}}var $h=new class{grayscale(t){for(let e=0;e<t.data.length;e+=4){let n=.299*t.data[e]+.587*t.data[e+1]+.114*t.data[e+2];t.data.fill(n,e,e+3)}return t}threshold(t,e){for(let n=0;n<t.data.length;n+=4){let r=.299*t.data[n]+.587*t.data[n+1]+.114*t.data[n+2]<e?0:255;t.data.fill(r,n,n+3)}return t}bayer(t,e){let n=[[15,135,45,165],[195,75,225,105],[60,180,30,150],[240,120,210,90]];for(let r=0;r<t.data.length;r+=4){let i=.299*t.data[r]+.587*t.data[r+1]+.114*t.data[r+2],o=r/4%t.width,s=Math.floor(r/4/t.width),a=Math.floor((i+n[o%4][s%4])/2)<e?0:255;t.data.fill(a,r,r+3)}return t}floydsteinberg(t){let e=t.width,n=new Uint8ClampedArray(t.width*t.height);for(let e=0,r=0;r<t.data.length;e++,r+=4)n[e]=.299*t.data[r]+.587*t.data[r+1]+.114*t.data[r+2];for(let r=0,i=0;i<t.data.length;r++,i+=4){let o=n[r]<129?0:255,s=Math.floor((n[r]-o)/16);t.data.fill(o,i,i+3),n[r+1]+=7*s,n[r+e-1]+=3*s,n[r+e]+=5*s,n[r+e+1]+=1*s}return t}atkinson(t){let e=t.width,n=new Uint8ClampedArray(t.width*t.height);for(let e=0,r=0;r<t.data.length;e++,r+=4)n[e]=.299*t.data[r]+.587*t.data[r+1]+.114*t.data[r+2];for(let r=0,i=0;i<t.data.length;r++,i+=4){let o=n[r]<129?0:255,s=Math.floor((n[r]-o)/8);t.data.fill(o,i,i+3),n[r+1]+=s,n[r+2]+=s,n[r+e-1]+=s,n[r+e]+=s,n[r+e+1]+=s,n[r+2*e]+=s}return t}},Wh=function(t,e,n){var r=!1,i=!1;return function(){i=n&&!r;var o=this,s=arguments;if(r||(r=!0,setTimeout((function(){if(r=!1,!n)return t.apply(o,s)}),e)),i)return i=!1,t.apply(this,arguments)}};function Yh(e){let n,r,i,o;return{c(){n=b("div"),r=b("video"),i=_(),o=b("canvas"),A(r,"class","raw-webcam svelte-dytbdw"),A(r,"width","200"),A(r,"height","150"),A(o,"class","processed-webcam svelte-dytbdw"),A(o,"width","200"),A(o,"height","150"),A(n,"class","stylized-webcam-feed")},m(t,s){m(t,n,s),g(n,r),e[6](r),g(n,i),g(n,o),e[7](o)},p:t,i:t,o:t,d(t){t&&w(n),e[6](null),e[7](null)}}}function Hh(t,e,n){let r,{canvasElement:i}=e,{videoElement:o}=e;function s(){const t=i.getContext("2d");t.drawImage(o,0,0,o.width,o.height);const e=t.getImageData(0,0,i.width,i.height),n=$h.atkinson(e);t.putImageData(n,0,0)}const a=Wh(s,100,!0);function u(){a(),r=requestAnimationFrame(u)}return U(()=>(navigator.mediaDevices.getUserMedia({audio:!1,video:{aspectRatio:{ideal:4/3},frameRate:{ideal:10},width:{ideal:640},height:{ideal:480}}}).then(t=>{n(1,o.srcObject=t,o),o.play()}).catch(t=>{alert(t)}),r=requestAnimationFrame(u),function(){cancelAnimationFrame(r)})),t.$set=t=>{"canvasElement"in t&&n(0,i=t.canvasElement),"videoElement"in t&&n(1,o=t.videoElement)},[i,o,r,s,a,u,function(t){B[t?"unshift":"push"](()=>{n(1,o=t)})},function(t){B[t?"unshift":"push"](()=>{n(0,i=t)})}]}class Qh extends ft{constructor(t){super(),ht(this,t,Hh,Yh,a,{canvasElement:0,videoElement:1})}get canvasElement(){return this.$$.ctx[0]}set canvasElement(t){this.$set({canvasElement:t}),Y()}get videoElement(){return this.$$.ctx[1]}set videoElement(t){this.$set({videoElement:t}),Y()}}function Kh(t){let e;return{c(){e=b("span"),A(e,"class","recording-indicator svelte-81kraw")},m(t,n){m(t,e,n)},d(t){t&&w(e)}}}function Jh(t){let e,n,r,i,s,a,u,c,h,f,l,p,d,v,y;const I=new Qh({props:{}});t[6](I);let k=t[2]&&Kh();return{c(){e=b("div"),n=b("form"),r=b("div"),st(I.$$.fragment),i=_(),k&&k.c(),s=_(),a=b("div"),u=_(),c=b("div"),h=b("textarea"),f=_(),l=b("span"),p=b("button"),d=E("➪"),A(a,"class","recording-progress svelte-81kraw"),A(r,"class","recording-booth svelte-81kraw"),A(h,"class","input svelte-81kraw"),A(h,"type","text"),A(h,"placeholder","Type to GIF"),h.disabled=t[2],A(p,"class","submit svelte-81kraw"),A(p,"type","submit"),p.disabled=t[2],A(l,"class","fake-input__action svelte-81kraw"),A(c,"class","fake-input svelte-81kraw"),A(n,"class","form svelte-81kraw"),A(e,"class","new-message svelte-81kraw"),S(e,"recording",t[2])},m(w,b,E){var _;m(w,e,b),g(e,n),g(n,r),at(I,r,null),g(r,i),k&&k.m(r,null),g(r,s),g(r,a),g(n,u),g(n,c),g(c,h),N(h,t[1]),g(c,f),g(c,l),g(l,p),g(p,d),v=!0,E&&o(y),y=[T(h,"input",t[7]),T(h,"keydown",t[4]),T(n,"submit",(_=t[3],function(t){return t.preventDefault(),_.call(this,t)}))]},p(t,[n]){I.$set({}),t[2]?k||(k=Kh(),k.c(),k.m(r,s)):k&&(k.d(1),k=null),(!v||4&n)&&(h.disabled=t[2]),2&n&&N(h,t[1]),(!v||4&n)&&(p.disabled=t[2]),4&n&&S(e,"recording",t[2])},i(t){v||(nt(I.$$.fragment,t),v=!0)},o(t){rt(I.$$.fragment,t),v=!1},d(n){n&&w(e),t[6](null),ut(I),k&&k.d(),o(y)}}}function Xh(t,e,n){const r=function(){const t=M();return(e,n)=>{const r=t.$$.callbacks[e];if(r){const i=k(e,n);r.slice().forEach(e=>{e.call(t,i)})}}}();let i,o="",s=!1;async function a(){n(2,s=!0);const t=await function(t){const e=document.createElement("canvas");e.width=200,e.height=3e3;const n=e.getContext("2d");return new Promise(r=>{let i=0;setTimeout((function o(){const s=150*i;if(n.drawImage(t,0,s,200,150),i++,i<20)setTimeout(o,100);else{const t=e.toDataURL("image/png");r(t)}}),100)})}(i.canvasElement);n(2,s=!1),r("createMessage",{text:o,imageDataURL:t}),n(1,o="")}return[i,o,s,a,function(t){"Enter"!==t.key||t.shiftKey||a()},r,function(t){B[t?"unshift":"push"](()=>{n(0,i=t)})},function(){o=this.value,n(1,o)}]}class Zh extends ft{constructor(t){super(),ht(this,t,Xh,Jh,a,{})}}function tf(t,e,n){const r=t.slice();return r[5]=e[n].id,r[9]=e[n].text,r[10]=e[n].imageBlob,r[12]=n,r}function ef(t){let e,n,r;return{c(){e=b("p"),e.textContent="Nothing has been said.",n=_(),r=b("p"),r.textContent="Click ➪ to say something"},m(t,i){m(t,e,i),m(t,n,i),m(t,r,i)},d(t){t&&w(e),t&&w(n),t&&w(r)}}}function nf(n,r){let i,a,u,c,h,f,p=t;const d=new Gh({props:{text:r[9],imageBlob:r[10]}});return{key:n,first:null,c(){i=b("li"),st(d.$$.fragment),a=_(),this.first=i},m(t,e){m(t,i,e),at(d,i,null),g(i,a),f=!0},p(t,e){const n={};2&e&&(n.text=t[9]),2&e&&(n.imageBlob=t[10]),d.$set(n)},r(){h=i.getBoundingClientRect()},f(){!function(t){const e=getComputedStyle(t);if("absolute"!==e.position&&"fixed"!==e.position){const{width:n,height:r}=e,i=t.getBoundingClientRect();t.style.position="absolute",t.style.width=n,t.style.height=r,P(t,i)}}(i),p(),P(i,h)},a(){p(),p=function(n,r,i,o){if(!r)return t;const s=n.getBoundingClientRect();if(r.left===s.left&&r.right===s.right&&r.top===s.top&&r.bottom===s.bottom)return t;const{delay:a=0,duration:u=300,easing:c=e,start:h=l()+a,end:f=h+u,tick:p=t,css:d}=i(n,{from:r,to:s},o);let v,g=!0,m=!1;function w(){d&&C(n,v),g=!1}return y(t=>{if(!m&&t>=h&&(m=!0),m&&t>=f&&(p(1,0),w()),!g)return!1;if(m){const e=0+1*c((t-h)/u);p(e,1-e)}return!0}),d&&(v=x(n,0,1,u,a,c,d)),a||(m=!0),p(0,1),w}(i,h,zs,{duration:200})},i(n){f||(nt(d.$$.fragment,n),G(()=>{c&&c.end(1),u||(u=function(n,r,i){let o,a,u=r(n,i),c=!1,h=0;function f(){o&&C(n,o)}function p(){const{delay:r=0,duration:i=300,easing:s=e,tick:p=t,css:d}=u||it;d&&(o=x(n,0,1,i,r,s,d,h++)),p(0,1);const v=l()+r,g=v+i;a&&a.abort(),c=!0,G(()=>J(n,!0,"start")),a=y(t=>{if(c){if(t>=g)return p(1,0),J(n,!0,"end"),f(),c=!1;if(t>=v){const e=s((t-v)/i);p(e,1-e)}}return c})}let d=!1;return{start(){d||(C(n),s(u)?(u=u(),K().then(p)):p())},invalidate(){d=!1},end(){c&&(f(),c=!1)}}}(i,r[3],{key:r[5]})),u.start()}),f=!0)},o(n){rt(d.$$.fragment,n),u&&u.invalidate(),c=function(n,r,i){let a,u=r(n,i),c=!0;const h=Z;function f(){const{delay:r=0,duration:i=300,easing:s=e,tick:f=t,css:p}=u||it;p&&(a=x(n,1,0,i,r,s,p));const d=l()+r,v=d+i;G(()=>J(n,!1,"start")),y(t=>{if(c){if(t>=v)return f(0,1),J(n,!1,"end"),--h.r||o(h.c),!1;if(t>=d){const e=s((t-d)/i);f(1-e,e)}}return c})}return h.r+=1,s(u)?K().then(()=>{u=u(),f()}):f(),{end(t){t&&u.tick&&u.tick(1,0),c&&(a&&C(n,a),c=!1)}}}(i,r[2],{key:r[5]}),f=!1},d(t){t&&w(i),ut(d),t&&c&&c.end()}}}function rf(t){let e,n,r,i,o,s,a,u=[],c=new Map;document.title=e=t[0]?`[${t[0]}] Dither: ${t[5]}`:`Dither: ${t[5]}`;const h=new Zh({});h.$on("createMessage",t[4]);let f=0===t[1].length&&ef(),l=t[1];const p=t=>t[5];for(let e=0;e<l.length;e+=1){let n=tf(t,l,e),r=p(n);c.set(r,u[e]=nf(r,n))}return{c(){n=_(),r=b("div"),st(h.$$.fragment),i=_(),o=b("ul"),f&&f.c(),s=_();for(let t=0;t<u.length;t+=1)u[t].c();A(o,"class","messages svelte-11gzv5a"),A(r,"class","content svelte-11gzv5a")},m(t,e){m(t,n,e),m(t,r,e),at(h,r,null),g(r,i),g(r,o),f&&f.m(o,null),g(o,s);for(let t=0;t<u.length;t+=1)u[t].m(o,null);a=!0},p(t,[n]){if((!a||33&n)&&e!==(e=t[0]?`[${t[0]}] Dither: ${t[5]}`:`Dither: ${t[5]}`)&&(document.title=e),0===t[1].length?f||(f=ef(),f.c(),f.m(o,s)):f&&(f.d(1),f=null),2&n){const e=t[1];tt();for(let t=0;t<u.length;t+=1)u[t].r();u=function(t,e,n,r,i,o,s,a,u,c,h,f){let l=t.length,p=o.length,d=l;const v={};for(;d--;)v[t[d].key]=d;const y=[],g=new Map,m=new Map;for(d=p;d--;){const t=f(i,o,d),a=n(t);let u=s.get(a);u?r&&u.p(t,e):(u=c(a,t),u.c()),g.set(a,y[d]=u),a in v&&m.set(a,Math.abs(d-v[a]))}const w=new Set,b=new Set;function E(t){nt(t,1),t.m(a,h,s.has(t.key)),s.set(t.key,t),h=t.first,p--}for(;l&&p;){const e=y[p-1],n=t[l-1],r=e.key,i=n.key;e===n?(h=e.first,l--,p--):g.has(i)?!s.has(r)||w.has(r)?E(e):b.has(i)?l--:m.get(r)>m.get(i)?(b.add(r),E(e)):(w.add(i),l--):(u(n,s),l--)}for(;l--;){const e=t[l];g.has(e.key)||u(e,s)}for(;p;)E(y[p-1]);return y}(u,n,p,1,t,e,c,o,ot,nf,null,tf);for(let t=0;t<u.length;t+=1)u[t].a();et()}},i(t){if(!a){nt(h.$$.fragment,t);for(let t=0;t<l.length;t+=1)nt(u[t]);a=!0}},o(t){rt(h.$$.fragment,t);for(let t=0;t<u.length;t+=1)rt(u[t]);a=!1},d(t){t&&w(n),t&&w(r),ut(h),f&&f.d();for(let t=0;t<u.length;t+=1)u[t].d()}}}function of(t,e,n){let r;c(t,Gs,t=>n(7,r=t));let{currentRoute:i}=e;const{namedParams:o}=i,{id:s}=o;let a=0,u=[];const[h,f]=qs({duration:t=>Math.sqrt(100*t),fallback(t,e){const n=getComputedStyle(t),r="none"===n.transform?"":n.transform;return{duration:125,easing:Vs,css:t=>`\n\t\t\t\t\ttransform: ${r} scale(${t});\n\t\t\t\t\topacity: ${t}\n\t\t\t\t`}}});return U(async()=>{Us.collection(`rooms/${s}/messages`).limit(10).orderBy("createdAt","desc").onSnapshot((function(t){const e=t.docs.map(t=>({id:t.id,...t.data()}));n(1,u=e),r||n(0,a++,a)}))}),Gs.subscribe(()=>{n(0,a=0)}),t.$set=t=>{"currentRoute"in t&&n(6,i=t.currentRoute)},[a,u,h,f,async function(t){const{text:e,imageDataURL:n}=t.detail;await Us.collection(`rooms/${s}/messages`).add({createdAt:Ms.FieldValue.serverTimestamp(),imageBlob:n,text:e})},s,i]}function sf(e){let n;return{c(){n=b("nav"),n.innerHTML='<a href="/" class="app-name svelte-9cwu85">Dither <span class="alpha-tag svelte-9cwu85">alpha</span></a>',A(n,"class","nav svelte-9cwu85")},m(t,e){m(t,n,e)},p:t,i:t,o:t,d(t){t&&w(n)}}}class af extends ft{constructor(t){super(),ht(this,t,null,sf,a,{})}}function uf(t){let e,n,r;const i=new af({}),o=new Ce({props:{currentRoute:t[0]}});return{c(){st(i.$$.fragment),e=_(),n=b("main"),st(o.$$.fragment),A(n,"class","layout svelte-1x2r8vu")},m(t,s){at(i,t,s),m(t,e,s),m(t,n,s),at(o,n,null),r=!0},p(t,[e]){const n={};1&e&&(n.currentRoute=t[0]),o.$set(n)},i(t){r||(nt(i.$$.fragment,t),nt(o.$$.fragment,t),r=!0)},o(t){rt(i.$$.fragment,t),rt(o.$$.fragment,t),r=!1},d(t){ut(i,t),t&&w(e),t&&w(n),ut(o)}}}function cf(t,e,n){let{currentRoute:r}=e;return t.$set=t=>{"currentRoute"in t&&n(0,r=t.currentRoute)},[r]}class hf extends ft{constructor(t){super(),ht(this,t,cf,uf,a,{currentRoute:0})}}const ff=[{name:"/",component:class extends ft{constructor(t){super(),ht(this,t,null,js,a,{})}},layout:hf},{name:"/rooms/:id",component:class extends ft{constructor(t){super(),ht(this,t,of,rf,a,{currentRoute:6})}},layout:hf}];function lf(e){let n,r;const i=new Pe({props:{routes:ff}});return{c(){n=b("div"),st(i.$$.fragment),A(n,"class","app")},m(t,e){m(t,n,e),at(i,n,null),r=!0},p:t,i(t){r||(nt(i.$$.fragment,t),r=!0)},o(t){rt(i.$$.fragment,t),r=!1},d(t){t&&w(n),ut(i)}}}new class extends ft{constructor(t){super(),ht(this,t,null,lf,a,{})}}({target:document.body})}();
//# sourceMappingURL=client.js.map
